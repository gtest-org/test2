2013-10-28T00:00:25  *** markwash has quit IRC
2013-10-28T00:12:09  *** senk has quit IRC
2013-10-28T00:15:48  *** ericw has joined #openstack-infra
2013-10-28T00:16:28  *** che-arne has quit IRC
2013-10-28T00:19:21  *** matsuhashi has joined #openstack-infra
2013-10-28T00:27:22  <mordred> fungi: re: https://review.openstack.org/#/c/52367/ - do you feel strongly about trying to do the other format?
2013-10-28T00:28:56  *** rakhmerov has quit IRC
2013-10-28T00:30:32  <fungi> mordred: nah, what you have is more compact. my original goal was merely to shrink the resulting changelog size anyway
2013-10-28T00:31:43  *** matsuhashi has quit IRC
2013-10-28T00:32:13  <fungi> mordred: though per your and lifeless's comments in there, i think my algorithm got the tags while omitting the merges by making multiple passes
2013-10-28T00:32:18  *** matsuhashi has joined #openstack-infra
2013-10-28T00:32:30  <mordred> fungi: I agree
2013-10-28T00:32:31  <fungi> first a git tag pass, then a git log for each tag range
2013-10-28T00:33:30  * fungi looks back at his script
2013-10-28T00:36:50  *** dcramer_ has quit IRC
2013-10-28T00:37:14  *** matsuhashi has quit IRC
2013-10-28T00:37:37  <fungi> yeah, i did a loop over the git tag output, filtered for only release tag patterns, and then did a git log (well, shortlog in mine) --no-merges over each successive pair of tags to get the changes between them
2013-10-28T00:38:19  <fungi> seemed to work even if the tag was on a merge commit
2013-10-28T00:41:13  <mordred> fungi: yeah - I agree that will work. I'm not sure the extra author info is worth the double loop thing though. I think lifeless point was that it's sad we can't just do a single git invocation and get the log output in the format we want
2013-10-28T00:41:29  <lifeless> right
2013-10-28T00:41:31  *** michchap has quit IRC
2013-10-28T00:41:32  <lifeless> parsing is overhead
2013-10-28T00:41:38  <lifeless> manual recursive descent more so
2013-10-28T00:41:43  <fungi> ahh, right. yeah, parsing or loop are the two options
2013-10-28T00:41:44  <lifeless> if we can have git DTRT we avoid all that
2013-10-28T00:42:02  *** michchap has joined #openstack-infra
2013-10-28T00:42:03  <lifeless> if we can't, then I start suggesting parser generators (like pyparsing or parsley) to mordred
2013-10-28T00:43:00  <mordred> yah. except this is pbr, so I'm not going to add a dep on pyparsing or parsley
2013-10-28T00:43:14  <mordred> to get potentially more elegant code implementing the changelog writing :)
2013-10-28T00:44:30  <mordred> (in fact, I'm not going to add a depend on anything)
2013-10-28T00:44:39  <mordred> I do agree that getting git to do it directly would be baller
2013-10-28T00:45:13  <lifeless> pbr isn't allowed to depend on anything ?
2013-10-28T00:46:12  <fungi> i agree that, as a module targeting basic packaging functionality, its dependency list should be as tight as possible
2013-10-28T00:46:43  *** ericw has quit IRC
2013-10-28T00:47:10  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T00:47:39  <mordred> lifeless: at the moment, I believe that all depends to pbr need to be MASSIVELY scruitinzed
2013-10-28T00:47:56  <mordred> lifeless: because pbr comes in via setup_requires, which is operated by easy_install, which is a pile of bork
2013-10-28T00:48:21  <mordred> the more complex we make pbr installation, the more opportunities we introduce for corner cases and fundamental breaking
2013-10-28T00:49:00  *** SergeyLukjanov has quit IRC
2013-10-28T00:49:07  <mordred> so, I'm not going to say 'not allowed' - but I think the chances of finding a case where it's justified are slim
2013-10-28T00:49:11  <mordred> and this one is certainly not one
2013-10-28T00:49:18  *** matsuhashi has joined #openstack-infra
2013-10-28T00:49:36  <fungi> mordred: out of curiosity have you compared the size of nova's changelog before and after?
2013-10-28T00:49:48  <mordred> fungi: I have not - that's an excellent idea
2013-10-28T00:50:02  <fungi> i was seeing something like a fourfold reduction in size, so i'd expect similar
2013-10-28T00:50:47  <mordred> here it is with trunk pbr
2013-10-28T00:50:50  <mordred> -rw-r--r-- 1 mordred mordred 7162597 Oct 27 20:50 ChangeLog
2013-10-28T00:52:29  <lifeless> mordred: why is it pbr that does ChangeLog generation?
2013-10-28T00:52:33  <mordred> and condensed
2013-10-28T00:52:35  <mordred> -rw-r--r-- 1 mordred mordred 915127 Oct 27 20:52 ChangeLog
2013-10-28T00:52:47  <mordred> lifeless: because it handles setup.py interactions
2013-10-28T00:52:51  <mordred> of which sdist is one
2013-10-28T00:52:52  *** nosnos has joined #openstack-infra
2013-10-28T00:53:04  <mordred> pbr is a collection of repeated code that otherwise would go into setup.py
2013-10-28T00:53:21  <fungi> nice, so eightfold or so
2013-10-28T00:53:26  <mordred> yah
2013-10-28T00:53:30  <mordred> that should make zigo happier
2013-10-28T00:54:28  <fungi> of course the actual space savings will depend on the relative verbosity of commit messages in a given project
2013-10-28T00:54:54  <mordred> sure. I think the real win is that the result is MUCH more useful to read
2013-10-28T00:55:08  <fungi> very much so
2013-10-28T00:55:11  <mordred> and also underscores the point of having nicely readable commit summaries
2013-10-28T00:55:36  <mordred> oh. you know what? I should strip trailing periods in the output. OR I should add periods if they aren't there
2013-10-28T00:55:50  <mordred> so that the ChangeLog reads consistently
2013-10-28T00:55:58  <mordred> regardless of commit subject style choice
2013-10-28T00:56:17  <fungi> both, commit subhects with no period should get one added, and those with one should have it stripped. that way you can annoy everyone
2013-10-28T00:56:27  <mordred> fungi: ++
2013-10-28T00:58:28  *** markwash has joined #openstack-infra
2013-10-28T01:01:41  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Make ChangeLog more condensed  https://review.openstack.org/52367
2013-10-28T01:02:11  <mordred> fungi: also - I was thinking - perhaps if we included support for not including commit lines that contained something
2013-10-28T01:02:20  <mordred> like "NIT: Fix typo" or something
2013-10-28T01:03:37  <fungi> it's a savings which wouldn't be realized in established projects for a long time, but it's not a terrible idea
2013-10-28T01:04:08  <mordred> yah. was mainly thinking in terms of making the ChangeLog something that communicates things that were done
2013-10-28T01:04:21  <mordred> there are usually commits like that which do not communicate anything
2013-10-28T01:05:11  *** markwash has quit IRC
2013-10-28T01:05:45  <mordred> maybe NIT: and AUTO: so we can also mark things like requirements changes that are just mechanical system commits
2013-10-28T01:07:18  <fungi> probably needs a bit of an rfc to find out the variety of ways devs might be interested in filtering commits out of the changelog
2013-10-28T01:07:23  <mordred> yah
2013-10-28T01:07:29  <mordred> let's make that a follow on change
2013-10-28T01:08:07  <Shrews> mordred: go as expected last night?
2013-10-28T01:11:40  *** dims has quit IRC
2013-10-28T01:13:31  <openstackgerrit> A change was merged to openstack-dev/pbr: Move base test case logic out of __init__.py  https://review.openstack.org/48860
2013-10-28T01:16:26  <mordred> Shrews: yeah - it was really good
2013-10-28T01:21:23  *** dkranz has quit IRC
2013-10-28T01:24:52  *** yamahata has joined #openstack-infra
2013-10-28T01:25:36  *** rakhmerov has joined #openstack-infra
2013-10-28T01:26:26  *** sdake has quit IRC
2013-10-28T01:28:15  *** alexpilotti has quit IRC
2013-10-28T01:38:23  *** fallenpegasus has joined #openstack-infra
2013-10-28T01:39:41  *** guohliu has joined #openstack-infra
2013-10-28T01:46:01  *** senk has joined #openstack-infra
2013-10-28T01:46:15  *** markwash has joined #openstack-infra
2013-10-28T01:47:19  *** bingbu has joined #openstack-infra
2013-10-28T01:50:34  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Make ChangeLog more condensed  https://review.openstack.org/52367
2013-10-28T01:50:37  <mordred> fungi: ^^
2013-10-28T01:50:53  <mordred> that updates the logic around lines with multiple commits
2013-10-28T01:53:03  *** michchap has quit IRC
2013-10-28T01:53:50  *** ericw has joined #openstack-infra
2013-10-28T01:55:43  *** michchap has joined #openstack-infra
2013-10-28T01:57:10  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Ignore boring commit messages  https://review.openstack.org/54048
2013-10-28T01:59:08  *** rakhmerov has quit IRC
2013-10-28T02:00:26  *** sdake has joined #openstack-infra
2013-10-28T02:00:55  *** wenlock has joined #openstack-infra
2013-10-28T02:01:34  <mordred> fungi, clarkb: fyi - I have released a new pbr version so that the windows guys won't be screwed anymore
2013-10-28T02:01:39  *** dims has joined #openstack-infra
2013-10-28T02:01:43  <mordred> it SHOULD not break anything
2013-10-28T02:01:46  <mordred> but heads up anyway
2013-10-28T02:04:46  <fungi> mordred: when you say lines with multiple commits, are you talking about tags on merge commits? or something else?
2013-10-28T02:05:06  <mordred> fungi: what I meant is a single commit with more than one tag
2013-10-28T02:05:25  <fungi> aha! yes, okay now i see what you're solving
2013-10-28T02:05:26  <mordred> which is the case with 2013.2 and 2013.2.rc1
2013-10-28T02:05:54  <lifeless> mordred: speaking of mailmap
2013-10-28T02:05:59  <lifeless> did you see my RFC about it ?
2013-10-28T02:06:11  <mordred> speaking of - the merge-tags-back-to-master script didn't work because we were tryin to do something bad in the script which I beliveve we fixed
2013-10-28T02:06:16  <mordred> lifeless: I did not
2013-10-28T02:06:33  <lifeless> mordred: 'consolidating .mailmap?
2013-10-28T02:06:33  <lifeless> '
2013-10-28T02:06:36  <mordred> fungi: a) that landed, right? and b) should we retrigger that job now that the script sucks less?
2013-10-28T02:07:29  <mordred> lifeless: hrm. yah. it's definitley still needed. copying from centrally certainly seems like a decent idea
2013-10-28T02:07:41  <mordred> especially since we have user to email mappings elsewhere too
2013-10-28T02:07:43  <lifeless> consolidating .mailmap?
2013-10-28T02:07:48  <mordred> yah
2013-10-28T02:07:52  <lifeless> bah, mouse fail
2013-10-28T02:07:59  <fungi> mordred: i can't remember what was broken in the tag merge script now, but pretty sure the fix did merge
2013-10-28T02:08:02  <lifeless> anyhow yeah, having 40 separate mailmaps seens like a pain
2013-10-28T02:08:17  <fungi> mordred: oh, right, we weren't merging to the right branch or something
2013-10-28T02:08:43  <mordred> lifeless: ++
2013-10-28T02:08:50  <fungi> we were skipping milestone-proposed which was the only place it would have done anything
2013-10-28T02:08:53  <fungi> yeah
2013-10-28T02:09:04  <mordred> lifeless: similar to requirements update, we could write the sync script such that it only copies in relevant entries
2013-10-28T02:09:22  <lifeless> mordred: whats .mailmap used for ?
2013-10-28T02:09:25  <mordred> fungi: yup. because we were filtering on branch, but tag events don't have a branch
2013-10-28T02:09:40  <fungi> right-o
2013-10-28T02:09:43  <mordred> lifeless: most directly for AUTHORS file (removes duplicates)
2013-10-28T02:09:57  <lifeless> mordred: and AUTHORS is generated when /how ?
2013-10-28T02:09:59  <mordred> also, if people want their git log output to show
2013-10-28T02:10:01  <mordred> lifeless: sdist time
2013-10-28T02:10:06  <mordred> lifeless: by pbr
2013-10-28T02:10:17  <lifeless> mordred: ok, so if we copy mailmap in before sdist happens
2013-10-28T02:10:23  <lifeless> then we can do it lazily
2013-10-28T02:10:35  <lifeless> but I don't think we can otherwise, because race conditions
2013-10-28T02:10:43  <mordred> hrm. that would mean that a person running sdist locally would get a potentially surprising result
2013-10-28T02:10:45  <lifeless> you don't know who you need until they start contributing to that repo
2013-10-28T02:10:48  <mordred> I'm not sure how much I care
2013-10-28T02:10:53  *** ArxCruz has quit IRC
2013-10-28T02:11:00  <mordred> (about the local surprising result)
2013-10-28T02:11:18  *** harlowja_at_home has joined #openstack-infra
2013-10-28T02:11:34  <harlowja_at_home> fungi, u want to try my new zuul curses viewer?? :-P
2013-10-28T02:11:51  <harlowja_at_home> or others, https://github.com/harlowja/gerrit_view/#czuul :)
2013-10-28T02:12:26  <mordred> lifeless: if we did that, we might wind up shipping a large .mailmap file in all of our tarballs
2013-10-28T02:12:36  <mordred> lifeless: at least until we put it in as a global exclude
2013-10-28T02:12:44  <mordred> or - actually, it wouldn't e in git, so no we wouldn't
2013-10-28T02:12:46  <mordred> nevermind
2013-10-28T02:12:55  *** rcleere has joined #openstack-infra
2013-10-28T02:14:34  *** ljjjustin has joined #openstack-infra
2013-10-28T02:15:12  <fungi> mordred: out of curiosity, why does pbr manually remap from the mailmap file? git log already claims in its manpage to respect it
2013-10-28T02:15:23  *** guohliu has quit IRC
2013-10-28T02:15:31  <mordred> fungi: uhm. now that you ask that question, I do not know
2013-10-28T02:16:07  <fungi> man git-log briefly mentions it, but directs you to the git-shortlog manpage for details
2013-10-28T02:18:57  <fungi> harlowja_at_home: installing it into a venv now to take it for a spin
2013-10-28T02:19:19  <harlowja_at_home> :)
2013-10-28T02:19:21  <harlowja_at_home> cool
2013-10-28T02:20:11  <lifeless> mordred: we shouldn't ship .mailmap in tarballs anyway
2013-10-28T02:20:13  <lifeless> mordred: so meh
2013-10-28T02:20:48  *** lnxnut has quit IRC
2013-10-28T02:24:24  <harlowja_at_home> fungi, i could probably use screen space better, but pgup, pgdown, up/down arrow keys to move around (when u try it out)
2013-10-28T02:25:15  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Let git do mailmap mapping for us  https://review.openstack.org/54050
2013-10-28T02:25:16  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Ignore boring commit messages  https://review.openstack.org/54048
2013-10-28T02:25:32  <mordred> fungi: there you go. there's a patch to let git do the mailmap mapping for us
2013-10-28T02:28:59  <mordred> wow. merge conflict. that's so sexy
2013-10-28T02:30:55  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Make ChangeLog more condensed  https://review.openstack.org/52367
2013-10-28T02:30:55  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Ignore boring commit messages  https://review.openstack.org/54048
2013-10-28T02:30:56  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Let git do mailmap mapping for us  https://review.openstack.org/54050
2013-10-28T02:31:04  <mordred> and I had to rebase the stack. sigh
2013-10-28T02:31:49  <mordred> lifeless: if you want to review https://review.openstack.org/52367 and https://review.openstack.org/54048 I will not scream at you
2013-10-28T02:32:02  <mordred> I eam https://review.openstack.org/54050 not https://review.openstack.org/54048 - https://review.openstack.org/54048 is not ready yet
2013-10-28T02:32:15  *** guohliu has joined #openstack-infra
2013-10-28T02:32:25  *** UtahDave has quit IRC
2013-10-28T02:32:34  *** bingbu has quit IRC
2013-10-28T02:32:50  *** rakhmerov has joined #openstack-infra
2013-10-28T02:34:03  <mordred> fungi: also, there are several sexy git-review patches outstanding, :)
2013-10-28T02:34:41  <harlowja_at_home> sexy
2013-10-28T02:36:45  *** michchap has quit IRC
2013-10-28T02:37:23  *** ljjjustin has quit IRC
2013-10-28T02:37:44  *** ljjjustin has joined #openstack-infra
2013-10-28T02:39:20  <notmyname> mordred: still around? I see you're referencing me on twitter and proposing ideas on the mailing list. :-)
2013-10-28T02:39:34  *** xchu has joined #openstack-infra
2013-10-28T02:39:38  <mordred> notmyname: I constantly reference you on twitter
2013-10-28T02:40:00  <mordred> notmyname: although sadly it does not appear that that SAT solver is going to be immediately helpful in our current SAT solver interest
2013-10-28T02:40:07  <notmyname> ah. too bad
2013-10-28T02:40:21  <notmyname> cause auto requirements is pretty useless without it
2013-10-28T02:40:23  <mordred> yeah. the author has a rather weird hatred of python versioning
2013-10-28T02:40:38  <mordred> it's not useless. it just doesn't solve your use case
2013-10-28T02:40:57  <mordred> I do agree though that it can be improved to the point where it does
2013-10-28T02:41:19  <mordred> notmyname: in any case - yes! I'm still here
2013-10-28T02:41:44  *** vipul has quit IRC
2013-10-28T02:42:10  <notmyname> at best I'd call the current state "unwieldy", and boardering on useless. eg we may have some patches in eventlet that would be of interest, but that doesn't mean everyone needs to force upgrade to bleeding-edge eventlet (actual case, but substitute whatever package and get the same result)
2013-10-28T02:42:38  <notmyname> anyway, dependencies isn't what I wanted to focus on tonight. we've covered that plently before
2013-10-28T02:42:51  *** vipul has joined #openstack-infra
2013-10-28T02:43:04  <notmyname> and it seems the new thing you found doesn't meet our needs :-(
2013-10-28T02:43:14  <mordred> not yet. we'll get there
2013-10-28T02:43:15  *** dims has quit IRC
2013-10-28T02:43:24  <mordred> dstufft is still working on a SAT solver that will
2013-10-28T02:43:26  <notmyname> like you, I'm always hopeful
2013-10-28T02:44:38  <notmyname> first, the probably less contentious one: consolidated mailmap. wouldn't tarball makers care very much about the AUTHORS file?
2013-10-28T02:44:54  <notmyname> if for nothing else, it's necessary for making the same hash
2013-10-28T02:45:11  <notmyname> and it contains info that is otherwise not in the tarball (VCS info)
2013-10-28T02:45:30  <mordred> it's a good question
2013-10-28T02:45:58  <mordred> the question is - how important is the contents of AUTHORS to people making their own tarballs?
2013-10-28T02:46:24  <mordred> (I do not have a strong opinion on this one)
2013-10-28T02:46:33  <mordred> so it's an honest question
2013-10-28T02:46:38  <mordred> lifeless: ^^ (we're talking about you)
2013-10-28T02:46:42  <clarkb> mailmap is for deduping right?
2013-10-28T02:46:47  <clarkb> do we need to bother?
2013-10-28T02:46:48  <mordred> clarkb: yes.
2013-10-28T02:46:54  <clarkb> the list is correct without dedup
2013-10-28T02:47:16  <mordred> clarkb: sure. but it's a little ugly, and we do have the dedup machinery
2013-10-28T02:47:28  <mordred> I certainly don't think we should replace the mailmap files with nothing
2013-10-28T02:47:43  <clarkb> it seems to solve all the problems but uglyness :)
2013-10-28T02:47:54  <mordred> I think there are a few different options
2013-10-28T02:48:05  *** harlowja_at_home has quit IRC
2013-10-28T02:48:10  <notmyname> I'm a fan of keeping .mailmap local to a project, if for nothing else to keep the dependency trees shorter when building packages and running stuff
2013-10-28T02:48:20  <notmyname> (that's my opening position)
2013-10-28T02:48:20  <mordred> a) keep the individually managed mailmap files in the repos
2013-10-28T02:48:54  <mordred> b) have a central list from which mailmap entries can be synced by a computer as needed, with the results stored in the repo
2013-10-28T02:49:11  *** ericw has quit IRC
2013-10-28T02:49:31  <mordred> c) have a central list which is used at infra tarball creation time that does not have any relationship to the git repo
2013-10-28T02:49:53  *** bingbu has joined #openstack-infra
2013-10-28T02:50:02  <mordred> d) have a central list which is used at infra tarball creation time that does not have any relationship to the git repo but which is included in the tarball
2013-10-28T02:50:14  <mordred> any other combos? I'm missing?
2013-10-28T02:51:32  <mordred> a) is clearly the easiest, since it requires no changes, but is the most effort in terms of ongoing maint of the lists
2013-10-28T02:51:54  <notmyname> it doesnt' seem that git shortlog respects .mailmap being in .gitignore, FWIW
2013-10-28T02:52:11  <mordred> notmyname: what do you mean?
2013-10-28T02:52:19  <mordred> like, if you put it in gitignore, it doesn't see it?
2013-10-28T02:52:41  <notmyname> (b) seems to be the worst of both worlds: per project file + extra dependency and syncing problem
2013-10-28T02:52:53  <notmyname> mordred: as in even with it ignored, shortlog applies it
2013-10-28T02:53:09  *** matsuhashi has quit IRC
2013-10-28T02:53:26  <mordred> notmyname: can you explain what you mean by "extra dependency" ?
2013-10-28T02:53:46  *** matsuhashi has joined #openstack-infra
2013-10-28T02:54:28  <mordred> (I think th emore I think about it, btw, I agree that b is not a great choice - just want to make sure I'm capturing your thoughts)
2013-10-28T02:54:50  <notmyname> similar to pbr now being a build-time dependency (and I'm hopeful that one day it won't be). depends if this is separate from pbr or not. if part of pbr, then it's an extra "hook" that makes it harder to decouple later. if not, then it's a new dependency for builders/deployers
2013-10-28T02:56:07  <mordred> oh - I was TOTALLY thinking that this would be a jenkins related thing
2013-10-28T02:56:13  <mordred> that just copies a file in place before doing something
2013-10-28T02:56:22  <mordred> not that it would be something that setup.py knew anything about
2013-10-28T02:56:38  <notmyname> or pbr sdist hooks?
2013-10-28T02:56:51  <mordred> pbr already does the authors processing with the mailmap file
2013-10-28T02:57:01  <mordred> so all that is required is for the file to be present
2013-10-28T02:57:04  <mordred> if it's not, it's a no op
2013-10-28T02:57:12  <notmyname> FTFY: pbr already does what git shortlog does ;-)
2013-10-28T02:57:37  <mordred> notmyname: it actually is deferring to git to do the mailmap work in a commit above, fwiw
2013-10-28T02:57:48  <mordred> I think that running code in pbr to _fetch_ a global mailmap from somewhere else would be HORRIBLE
2013-10-28T02:57:58  <notmyname> good. we agree on that :-)
2013-10-28T02:58:12  *** matsuhashi has quit IRC
2013-10-28T02:58:41  <mordred> I believe the mechanism choices are "do we havea  mechanism to mupdate the currently existing mailmap file  automatically"
2013-10-28T02:58:47  <clarkb> notmyname: curious about the pbr not being a build time dependency. aiui that is pbr's reason for existence
2013-10-28T02:58:50  <mordred> or "do we inject a mailmap file on the build hosts"
2013-10-28T02:59:23  <mordred> if we do the second thing, it would mean that poeple other than us making sdist tarballs would have a different and possibly less featureful experience
2013-10-28T02:59:24  <notmyname> so we make an -infra jenkins-ish thingy to create a .mailmap file. how do people who want to know who did what get along? they have to pull from the centralized jenkins-ish thingy?
2013-10-28T02:59:41  <notmyname> clarkb: happy to talk about that, but I'm only smart enough for one fun conversation at a time ;-)
2013-10-28T02:59:54  <lifeless> mordred: you're talking about me?
2013-10-28T03:00:01  <mordred> notmyname: yah. that's ultimately the problem with not committing the changes to the repo
2013-10-28T03:00:01  <lifeless> mordred: I will review those things for you
2013-10-28T03:00:12  <mordred> lifeless: we're discussing your mailmap thoughts
2013-10-28T03:00:14  <notmyname> mordred: wouldn't git blame break too?
2013-10-28T03:00:27  <mordred> notmyname: does git blame use mailmap?
2013-10-28T03:00:33  <lifeless> mordred: I don't know that I have thoughts
2013-10-28T03:00:45  <lifeless> mordred: I just know that maintaining the same mapping in 40 repos is a waste of a good life
2013-10-28T03:00:48  <mordred> notmyname: so it does. that changes my opinion of the options
2013-10-28T03:00:49  <notmyname> not sure, but AFAIK all of git that looks at authors does
2013-10-28T03:01:15  <lifeless> mordred: if I was doing the work I'd be inclined to just copy the contents into every relevant repo, no editing
2013-10-28T03:01:21  <notmyname> mordred: so while a per-project .mailmap may have some duplicated info, keeping it the repo on a per-project basis may be the best
2013-10-28T03:01:22  <mordred> I think given that, it is important for the appropriate contents to be in the git repos
2013-10-28T03:02:06  <mordred> now - having a tool or script that could, if desired, grab a global openstack mailmap and copy it into your repo seems very simple
2013-10-28T03:02:10  <mordred> or, screw a tool
2013-10-28T03:02:46  <mordred> just having an accessible globla mailmap is all you'd need
2013-10-28T03:02:47  <mordred> the tool is wget :)
2013-10-28T03:02:47  <mordred> if you, as a project, wanted to copy it in and commit it - neat. if you don't? neat.
2013-10-28T03:03:23  <mordred> as this is not an operational set of information that is related to actual build things, I do not feel that we need to have a strong opinion on enforcing an automated sync
2013-10-28T03:03:44  <mordred> right?
2013-10-28T03:03:56  <lifeless> mordred: I don't follow
2013-10-28T03:04:03  <fungi> proposal job which submits a review to sync up your .mailmap file if entries in your git log contain authors in the central mailmap file?
2013-10-28T03:04:14  <notmyname> mordred: I support you having that opinion (while my own is stronger to keeping them per-project)
2013-10-28T03:04:35  <lifeless> mordred: there is a mapping which is needed to get correct behaviour from multiple tools (pbr, git).
2013-10-28T03:04:48  <mordred> that behavior is cosmetic at best
2013-10-28T03:04:51  <lifeless> mordred: the mapping should be the same for the same person in all git repos in OpenStack
2013-10-28T03:05:01  <mordred> lifeless: because notmyname and swift will actively become unhappy if jenkins started proposing mailmap changes
2013-10-28T03:05:10  <mordred> lifeless: I do not feel that it is worth a fight
2013-10-28T03:05:14  *** guohliu has quit IRC
2013-10-28T03:05:18  <lifeless> mordred: what would make them unhappy?
2013-10-28T03:05:19  <mordred> requirements is
2013-10-28T03:05:20  <notmyname> lifeless: "should be"? why?
2013-10-28T03:05:37  <mordred> it has crossproject functional effects on the testing of openstack
2013-10-28T03:05:40  *** guohliu has joined #openstack-infra
2013-10-28T03:05:47  <clarkb> notmyname: because gerrit
2013-10-28T03:05:48  <notmyname> mordred: well, I started this topic by saying it's less contentious
2013-10-28T03:05:52  <mordred> authors file contents is - less important
2013-10-28T03:05:55  <mordred> notmyname:  :)
2013-10-28T03:05:58  <clarkb> gerrit does enforce it to a degree
2013-10-28T03:06:28  <notmyname> clarkb: hmm...good point.
2013-10-28T03:06:57  <lifeless> notmyname: what aspect of having the same mailmap as nova (either same for the same people, or same verbatim) would make you/swift unhappy?
2013-10-28T03:07:08  <mordred> lifeless: it would be commits that potentially suggest changes to their local file that are not relevant to their repo
2013-10-28T03:07:14  <notmyname> while I'd be mildly annoyed at having hundreds/thousands of lines in a .mailmap file in swift for people who have never even looked at the code, syncling that isn't worth too much of a fight at this point IMO
2013-10-28T03:07:50  <notmyname> and "syncling" is a weird-sounding word
2013-10-28T03:07:54  <mordred> I like it!
2013-10-28T03:08:38  <mordred> similarly, I have other fish to fry, so I don't feel strongly enough about it to make notmyname mildly annoyed. if we could sync only authors who have commits in the target repo...
2013-10-28T03:08:47  <mordred> then I doubt we'd see significant pushbach
2013-10-28T03:08:52  <lifeless> that surely doable
2013-10-28T03:08:53  <mordred> or pushback
2013-10-28T03:09:00  <notmyname> I'm happy to hear that the decision at this point is to auto-proposed updates or not. I'm fine to leave it there (I don't really care too much). I'm strongly against having a central dependency requirement to pull a .mailmap from
2013-10-28T03:09:09  <lifeless> just minor race condition (and strictly speaking no worse than the current often-stale dataset we have today)
2013-10-28T03:09:13  *** dcramer_ has joined #openstack-infra
2013-10-28T03:09:14  *** matsuhashi has joined #openstack-infra
2013-10-28T03:09:18  <fungi> what if it only proposed updates to the mailmap if authors in that project's git log were present in the global mailmap file? in the way that requirements sync only proposes updates for entries in your project's requirements lists?
2013-10-28T03:09:21  <mordred> notmyname: I 100% agree. pulling a dep would be awful
2013-10-28T03:09:33  <mordred> fungi: yes
2013-10-28T03:10:11  <mordred> lifeless: well, and if someone did choose to add themselves to a mailmap file in their first commit from a different email than their previous commit, it would not break things
2013-10-28T03:10:13  <notmyname> lifeless: fungi: what caused this question to arise? what's the pain point?
2013-10-28T03:10:29  <fungi> dryness
2013-10-28T03:10:39  <notmyname> not sure I follow
2013-10-28T03:10:44  <lifeless> notmyname: DRY; hidden non-discoverable datasources suck, etc
2013-10-28T03:10:53  <notmyname> gotcha
2013-10-28T03:11:18  <notmyname> IOW you don't want to keep your .mailmap entry up to date across N projects
2013-10-28T03:11:26  <lifeless> right
2013-10-28T03:11:34  <lifeless> plus several separate metric systems
2013-10-28T03:11:38  <lifeless> plus the foundation web page
2013-10-28T03:11:43  <lifeless> STAB STAB STAB STAB
2013-10-28T03:12:11  * mordred fixes this problem by committing with the same email address everywhere
2013-10-28T03:12:11  <notmyname> ya, the metrics and the foundation seems that they could benefit, but isn't that info already in gerrit anyway? shouldn't they pull from there rather than git shortlog?
2013-10-28T03:12:29  <clarkb> the foundation webpage is what got me to thinking we could just stop carring (there are tons of dups on the havana release page)
2013-10-28T03:12:30  <mordred> notmyname: oh - the metrics systems should pull from somewhere else for sure
2013-10-28T03:12:33  <lifeless> notmyname: well, I'd like to have just one source of all this info
2013-10-28T03:12:41  <mordred> clarkb: well, god only knows where the foundation got that data
2013-10-28T03:12:49  <mordred> it certainly wasn't from ANY system managed by the project
2013-10-28T03:12:57  <lifeless> notmyname: and clear instructions on the new contributor signup page saying 'do X to set this up, and Y if you change affiliation || email in future'
2013-10-28T03:13:02  <notmyname> lifeless: agreed. IMO the foundation (and gerrit) is or should be tracking all that and have the authoritative source
2013-10-28T03:13:27  <notmyname> lifeless: sure, but docs for new contribs don't have to spell out every eventuality.
2013-10-28T03:13:28  <lifeless> notmyname: so basically I'm bringing up any redundant source I see and going 'hey, this is perpetuating the overall problem'
2013-10-28T03:13:33  <fungi> gerrit doesn't make a lot of that queryable without being a gerrit admin, so we'd have to expose data from it through some additional mechanism
2013-10-28T03:13:43  <lifeless> notmyname: they don't, but there are only two situations. New, and changed.
2013-10-28T03:13:54  <mordred> fungi: once the user db system stops being stupid
2013-10-28T03:13:58  <lifeless> notmyname: point it new contributors don't even *know* that it's a thing at the moment.
2013-10-28T03:14:02  <fungi> mordred: yep
2013-10-28T03:14:05  *** vipul is now known as vipul-away
2013-10-28T03:14:21  <lifeless> notmyname: so a) reduce the number of things that we all need to care about, and b) then it's sane to tell people.
2013-10-28T03:14:33  <notmyname> lifeless: they don't know that what's a thing at the moment? .mailmap?
2013-10-28T03:15:03  <lifeless> notmyname: the big set of data sources; AFAICT there is no list of all the things that store this mapping data
2013-10-28T03:15:16  <lifeless> notmyname: and there should need to be; it should be maintained in one place
2013-10-28T03:15:29  <notmyname> except the currently-hard-to-get-but-it's-there gerrit system
2013-10-28T03:15:35  <mordred> I'm going to push VERY hard for there to be a central, authoitative and accessilbe source for this this cycle
2013-10-28T03:15:43  <notmyname> which actually has the CLA info etc
2013-10-28T03:15:54  <mordred> because right now if we did something it would be ADDING another source to the list
2013-10-28T03:16:00  <mordred> rather than reducing the number
2013-10-28T03:16:15  *** gyee has joined #openstack-infra
2013-10-28T03:16:18  <lifeless> notmyname: gerrit is one such system
2013-10-28T03:16:22  <mordred> but if we get the membership system to stop sucking, then we can build thigns that can query it when we need, etc
2013-10-28T03:16:23  <notmyname> ok. /me is done talking about sync'ing .mailmap files until mordred fixes the world ;-)
2013-10-28T03:16:28  <lifeless> notmyname: but it's not authoritative; *that* is the problem.
2013-10-28T03:16:40  *** gyee has quit IRC
2013-10-28T03:17:01  <notmyname> mordred: next thing I want to talk about is changelog files
2013-10-28T03:17:19  <mordred> notmyname: awesome!
2013-10-28T03:17:42  <fungi> it's almost like he's reading through your list of pending pbr patches
2013-10-28T03:18:30  <notmyname> mordred: (I say this because we know each other and in this rare case I think it will translate in a text-based medium) filtering "boring" commit messages from an auto-generated changelog seems like such a waste of time. go solve a real problem
2013-10-28T03:18:45  <notmyname>  /rant
2013-10-28T03:19:00  <mordred> notmyname: only thought about it at all because I was right there in the code anyway
2013-10-28T03:19:12  * notmyname is a strong proponent of hand-curated CHANGELOG files
2013-10-28T03:19:35  <notmyname> I agree that changelogs that are simply the result of `git shortlog` are useless
2013-10-28T03:19:56  <mordred> well, we don't use git shortlog
2013-10-28T03:20:18  <notmyname> well, "the git changelog"
2013-10-28T03:20:24  <notmyname> from your email
2013-10-28T03:20:35  <mordred> gotcha.
2013-10-28T03:21:01  *** guohliu has quit IRC
2013-10-28T03:21:04  <mordred> in general, rant noted. I do not plan on spending much energy on the topic (it's good plane hacking fodder, tbh)
2013-10-28T03:21:35  * mordred WANTS to be hacking on wheel support, but that requires way less laggy network than he has now
2013-10-28T03:21:44  <notmyname> the audience for CHANGELOG is people who need to see what's the high-level status of a project, what's important, and what to watch out for. it's an executive summary for the deployer, packager, and admin
2013-10-28T03:21:58  <notmyname> auto-generated files can't do that
2013-10-28T03:22:21  <mordred> I kinda think of NEWS files or release notes as being that
2013-10-28T03:24:18  <mordred> but honestly, on the fast moving projects, manually curated changelog entries would be very difficult to manage
2013-10-28T03:24:38  <mordred> either you're adding entries as you go, in which case you're increasing merge conflict fodder
2013-10-28T03:25:04  <mordred> or you're adding them at release time, which means the file is out of date in the repo until then, and someone has to track things for longer
2013-10-28T03:25:24  <notmyname> IOW the changelog doesn't have info about a release until the release happens?
2013-10-28T03:25:31  <notmyname> for the 2nd point
2013-10-28T03:25:34  <mordred> right.
2013-10-28T03:25:42  <mordred> but for people running from trunk
2013-10-28T03:25:42  <notmyname> how is that a problem?
2013-10-28T03:26:16  <mordred> you grab it, and you look for the curated information, since git log is not good enough for deployers
2013-10-28T03:26:30  <mordred> but it's not filled in, because of merge problems
2013-10-28T03:26:44  <notmyname> if a deployer is running at trunk, they have the chops to see what's going on since the last release was cut
2013-10-28T03:27:36  <mordred> how can anyone run openstack and NOT have those chops?
2013-10-28T03:27:52  <mordred> in a real prod env
2013-10-28T03:28:04  <notmyname> they run someone's product/distro/bundling of it
2013-10-28T03:28:21  <notmyname> piston/nebula/red hat/mirantis/cloudscaling/etc
2013-10-28T03:28:38  <mordred> in which case, they are reading the product release notes
2013-10-28T03:28:41  <mordred> from the value add company
2013-10-28T03:28:47  <lifeless> mordred: release time doesn't exist
2013-10-28T03:28:49  <mordred> who is curating things for them
2013-10-28T03:28:56  <lifeless> mordred: its a fallacy.
2013-10-28T03:28:56  <mordred> lifeless: it does. we're not to your world yet
2013-10-28T03:29:06  <lifeless> mordred: enough folk are that from a planning perspective...
2013-10-28T03:29:08  <mordred> OpenSTack makes 6 month releasesuntil we decide other wise
2013-10-28T03:29:14  <lifeless> mordred: yes, it does.
2013-10-28T03:29:18  <notmyname> lifeless: true :-) when are we going to do away with this whole release cycle thing anyway? ;-)
2013-10-28T03:29:27  <lifeless> mordred: but 'fix stuff up at the end' is already not an option
2013-10-28T03:29:49  <mordred> lifeless: indeed. which is another reason that write the changelog at release time is a no-go
2013-10-28T03:29:49  <lifeless> notmyname: J timeframe I hope
2013-10-28T03:30:41  <mordred> essentially, it's an even more complex issue than finding the right time to land the commit that changes the version number - the real process just doesn't work that way
2013-10-28T03:30:55  <mordred> which means manual curation would be back to a thing needing to be done continaully
2013-10-28T03:31:03  <mordred> which has merge conflict issues big-time
2013-10-28T03:31:16  <mordred> due to the form of the thing
2013-10-28T03:31:22  <fungi> run-parts style changelog assembly ;)
2013-10-28T03:31:30  <mordred> fungi: boom! you win! :)
2013-10-28T03:31:39  <notmyname> mordred: our goal for swift now is that master is deployable at any point (we've missed this recently, sadly). every so often, we bundle together what's happened and cut a "release". at this point I curate the AUTHORS and CHANGELOG file from what's happened (BTW, this happens much more often than every 6 months)
2013-10-28T03:32:01  <mordred> notmyname: right. because YOU have a sooner than 6 month release cycle
2013-10-28T03:32:16  <mordred> curating that file for you is not nearly as much of a nightmare
2013-10-28T03:32:27  <mordred> imagine curating it for a nova release
2013-10-28T03:32:39  <notmyname> mordred: well, importantly for conflicts sake, I'm the one who does it
2013-10-28T03:32:46  <mordred> right
2013-10-28T03:33:05  <mordred> you also probably actually know everytihng that landed in swift in a cycle
2013-10-28T03:33:15  *** guohliu has joined #openstack-infra
2013-10-28T03:33:21  <notmyname> mordred: only if I keep on top of it nearly every day
2013-10-28T03:33:34  <notmyname> I get very far behind on all the trips ;-)
2013-10-28T03:33:41  <mordred> oy. tell me about it
2013-10-28T03:34:11  <mordred> notmyname: so you're saying you keep up a set of notes about what the changelog is going to be?
2013-10-28T03:34:49  <notmyname> perhaps. or even have the PTL work on in as it goes
2013-10-28T03:35:14  <notmyname> point being is that russellb does a great job knowing what's going on. I guarantee you that any PTL can tell you what's going on at the drop of a hat. personally, I have to look through the VCS logs at every release to know everything that's merged
2013-10-28T03:35:29  <mordred> nod
2013-10-28T03:35:42  <notmyname> I've done both: updating it at release time and keeping it updated during a release
2013-10-28T03:36:18  <mordred> well, I mean, ultimately skip_changelog is an option in setup.cfg for a reason
2013-10-28T03:36:28  <notmyname> either way, the PTL is the one updating it and making sure that there is a good high-level summary for stuff. this is especially important with features that cross many commits
2013-10-28T03:36:45  <notmyname> mordred: it's not there just because you like me so much? ;-)
2013-10-28T03:37:06  <mordred> nothing is preventing anyone from manually curating one - but if that is not a thing a person wants to do, making one that contains _something_ that might be informative is better than no information in the tarball
2013-10-28T03:37:12  <mordred> notmyname: well, there are two reasons :)
2013-10-28T03:37:16  <notmyname> lo
2013-10-28T03:37:17  <notmyname> lol
2013-10-28T03:37:32  <mordred> bcwaldon also preferred manaul curation back when he still hacked on openstack
2013-10-28T03:38:11  <notmyname> I've heard interest from jgriffith too
2013-10-28T03:38:30  <mordred> but if we can get best-effort from automation and it's good enough for a wide variety of things, then awesome, one less thing for folks
2013-10-28T03:38:45  <mordred> jgriffith: you are more than welcome to turn off ChangeLog generation in your repo should you like
2013-10-28T03:39:16  <mordred> altohugh, what bcwaldon wound up doing was this: http://docs.openstack.org/developer/python-glanceclient/#release-notes
2013-10-28T03:39:25  <mordred> maintaining the curated thing in the sphinx docs
2013-10-28T03:39:49  <mordred> and then having the ChangeLog file be the autogenerated thing
2013-10-28T03:40:07  *** nati_ueno has quit IRC
2013-10-28T03:40:08  <mordred> that way there is also, in addition ot the tarball, a published web version of the notes
2013-10-28T03:40:23  <mordred> that can be linked places
2013-10-28T03:40:26  <notmyname> do you worry that an autogenerated changelog may give too much weight to "raw" data? IOW, if it's not there and someone has to go digging in VCS for it, they kinda know that thye have to figure out what the big stuff is. that implicit understanding is gone with an easily available changelog file that is essentially git shortlog output
2013-10-28T03:40:38  *** lnxnut has joined #openstack-infra
2013-10-28T03:40:45  *** nati_ueno has joined #openstack-infra
2013-10-28T03:41:15  <mordred> I'm not sure I follow the concern
2013-10-28T03:41:42  <mordred> I also, btw, think that git is a pretty frequently used vehicle from which to get the source code
2013-10-28T03:41:59  <mordred> and honestly think that changelog files are a dinosaur from a time when that was not the case
2013-10-28T03:42:21  <mordred> and when the tarball was actually the only mechanism you had to get the code, and the VCS history was simply not available
2013-10-28T03:42:26  <notmyname> so you've got a big feature that spans a few commits or one that landed early in the cycle. take a look at the ChangeLog (that was generate from git shortlog), and you've got to wade through hundreds to thousands of messages before you get to the big stuff
2013-10-28T03:43:17  <mordred> sure. that's why I actually like http://docs.openstack.org/developer/python-glanceclient/#release-notes as a compromise for the folks who want to maintain it
2013-10-28T03:44:31  <notmyname> ya, I guess my point is that hand-curated is awesome and should be required. if that's in sphinx or the actual CHANGELOG file is someone less important (especially if considering greenfield projects)
2013-10-28T03:45:19  <notmyname> I don't make a hand-curated changelog for python-swiftclient. I should.
2013-10-28T03:45:47  <mordred> yeah. I can totally see that, and I would not be unhappy if everyone started doing a release notes style hand curated thing
2013-10-28T03:46:03  *** nati_ueno has quit IRC
2013-10-28T03:47:10  <notmyname> mordred: so where does that leave us? please don't work on filtering changelog mesages. at least until you figure out the really important stuff. like vim modelines in files
2013-10-28T03:47:18  <mordred> notmyname: :)
2013-10-28T03:47:30  <mordred> notmyname: I did not bring that one up
2013-10-28T03:47:36  <notmyname> I know :-)
2013-10-28T03:48:00  <mordred> but I've automated all of the things that were the source of my commits in the last cycle - I've got some up with _something_ to keep my commit count high! ;)
2013-10-28T03:48:26  <mordred> else people might think I've turned into a manager
2013-10-28T03:48:38  <notmyname> horror!
2013-10-28T03:48:45  <notmyname> clarkb: so pbr as not a build-time dependency...
2013-10-28T03:48:51  <mordred> speaking of - python-glanceclient does not seem to be using the openstack sphinx theme...
2013-10-28T03:49:03  * mordred sits back to watch this one
2013-10-28T03:49:25  <clarkb> ya, mostly just curious how that would work
2013-10-28T03:49:33  <clarkb> since pbr is python build reasonableness
2013-10-28T03:49:45  <notmyname> clarkb: in my ideal world, pbr would be a tool that is used to build stuff (specifically for pip, not packages), similar to debuild for debian. ie feed a repo in and get out a thing that can be installed
2013-10-28T03:50:56  <notmyname> I think it's most egregious in client libraries (where it becomes another dependency to install when especially for clients we should be _reducing_ these things)
2013-10-28T03:51:21  <mordred> notmyname: that's actually possible, but I thnk it would REALY piss off the packagers working from git and not from tarballs we generate
2013-10-28T03:51:37  <notmyname> mordred: how so?
2013-10-28T03:51:44  <clarkb> notmyname: I think we may have some philosophical differences about that :) (I think swiftclient should include its "optional" dependencies at least when installing from pip
2013-10-28T03:51:57  <mordred> notmyname: because it would be a tool you'd HAVE to use to interact with the source code repository
2013-10-28T03:52:15  <mordred> whereas right now you can interact with setup.py like other python projects do
2013-10-28T03:52:21  <notmyname> mordred: it wouldn't be `pbr /path/to/some/git/repo`?
2013-10-28T03:52:29  <mordred> yup. THAT would work
2013-10-28T03:52:53  <mordred> but you'd need pbr at build time still
2013-10-28T03:53:12  <notmyname> clarkb: python-*client should run anywhere. our APIs are HTTP! we should be runnable on py2.0 on every computer ever made
2013-10-28T03:53:23  <mordred> notmyname: we are
2013-10-28T03:53:27  <mordred> pbr does not prevent that
2013-10-28T03:53:28  <clarkb> notmyname: I agree, but that doesn't rule out dependencies
2013-10-28T03:53:39  <mordred> it ONLY prevents using pre-secure pip
2013-10-28T03:53:47  <mordred> and I do not feel the need to support that
2013-10-28T03:53:51  <mordred> as it's a horrible idea
2013-10-28T03:53:58  <mordred> and actively destructive
2013-10-28T03:54:29  <notmyname> mordred: why would you need pbr for build time?
2013-10-28T03:54:30  <mordred> in any case, with the tool approach
2013-10-28T03:54:46  <mordred> you could remove the need for pbr at pip install time
2013-10-28T03:54:47  <mordred> BUT
2013-10-28T03:54:50  <mordred> you'd increase the surface area of people who woul dhave to learn about pbr directly
2013-10-28T03:54:53  <notmyname> clarkb: sure, but as a general idea in client libs (for any project), less deps >> more deps
2013-10-28T03:54:56  <mordred> because every single person wanting to install from git
2013-10-28T03:55:00  <mordred> would have to learn about running pbr
2013-10-28T03:55:16  <clarkb> notmyname: but broken features isn't good either
2013-10-28T03:55:28  <notmyname> mordred: that's what I don't get yet. why? I don't need debuild to run from source on a debian machine?
2013-10-28T03:55:34  <clarkb> it is really ocnfusing when you just want swiftclient to push objects to $publiccloud and it can't in a default install
2013-10-28T03:55:47  <notmyname> clarkb: nobody is promoting broken features
2013-10-28T03:55:48  <mordred> you DO need it to build debian packages though
2013-10-28T03:56:10  <mordred> and the way pip and friends work right now
2013-10-28T03:56:17  <mordred> is via source-level installs
2013-10-28T03:56:34  <mordred> so it's not analogous to how debuild/dpkg work
2013-10-28T03:56:44  <mordred> once we start using wheels, btw
2013-10-28T03:56:54  <mordred> you will not need pbr on your machien to install things
2013-10-28T03:57:04  <mordred> so, actually, that ^^ is probably what you really want
2013-10-28T03:57:15  <notmyname> could you say that when we have wheels the install process will be on rails?
2013-10-28T03:57:23  <mordred> oy
2013-10-28T03:57:27  * notmyname doesn't actually know what "wheels" in this context means
2013-10-28T03:57:30  <mordred> at that point, you will not need "build" depends to install
2013-10-28T03:57:43  <mordred> notmyname: it's a new binary distribution mechanism for python
2013-10-28T03:58:26  <mordred> it allows us to build "built" distributions of software
2013-10-28T03:58:32  <mordred> that can be installed without running setup.py
2013-10-28T03:58:35  <notmyname> gems?
2013-10-28T03:58:37  *** harlowja has quit IRC
2013-10-28T03:58:55  <mordred> I believe gems still run ruby code at install time
2013-10-28T03:59:09  <mordred> this is something that can run _no_ python code at install time
2013-10-28T03:59:10  <notmyname> I don't actually know much about how the ruby word works..
2013-10-28T03:59:15  <mordred> me either
2013-10-28T03:59:23  <mordred> the upshot is, the only people who will need pbr
2013-10-28T03:59:26  <notmyname> interesting...so where is it supported?
2013-10-28T03:59:35  <mordred> pip >= 1.4
2013-10-28T03:59:48  <mordred> so, first step is
2013-10-28T04:00:04  <mordred> we're going to start to upload wheels (and only wheels) of pre-release versions of things to pypi
2013-10-28T04:00:27  *** bingbu has quit IRC
2013-10-28T04:00:37  <mordred> (this goes hand in hand with pip 1.4 not downloading pre-release software by default)
2013-10-28T04:00:56  <mordred> which means we'll have by-default non-downloaded pre-release things no matter what version of pip you happen to be running
2013-10-28T04:01:05  <mordred> since pip pre 1.4 will not see the wheels at all
2013-10-28T04:01:08  <notmyname> "pre-release versions" == every commit? or == milestones?
2013-10-28T04:01:26  <mordred> milestones. things like oslo.config==1.2b4
2013-10-28T04:01:38  *** fifieldt has joined #openstack-infra
2013-10-28T04:01:49  <notmyname> so "releases" that aren't part of the six-month cycle, essentially
2013-10-28T04:01:54  <notmyname> what about client libs?
2013-10-28T04:02:05  <mordred> client lib releases are releases
2013-10-28T04:02:11  <mordred> so for those, we'll upload both things
2013-10-28T04:02:15  *** changbl has joined #openstack-infra
2013-10-28T04:02:16  <notmyname> and what happens when pip >1.4 sees a wheel?
2013-10-28T04:02:24  <notmyname> oh, ok. go on
2013-10-28T04:02:52  <mordred> so, when pip >1.4 sees a wheel, if you have set PIP_USE_WHEEL or --use-wheel, it will prefer the wheel over the tarbal
2013-10-28T04:03:02  <mordred> (there are still flags around this because it's still a new feature)
2013-10-28T04:03:33  <mordred> and if there  is a wheel that matches the system on which you are running, it will download the wheel and just unpack it directly
2013-10-28T04:03:43  <mordred> rather than running the setup.py code that was in the source repo
2013-10-28T04:03:55  <notmyname> ok. and what about earlier versions of pip?
2013-10-28T04:03:57  <mordred> (setup.py gets run at wheel creation time, similar to debuild)
2013-10-28T04:04:07  <mordred> earlier versions of pip will default to grabbing the tarball as usual
2013-10-28T04:04:21  <notmyname> ok, so pbr would be needed for "wheel builders"?
2013-10-28T04:04:25  <mordred> yes
2013-10-28T04:04:32  <notmyname> or pip pre 1.4
2013-10-28T04:04:37  <mordred> yes
2013-10-28T04:04:56  <notmyname> when is pip 1.4 released?
2013-10-28T04:05:04  <mordred> a few months ago
2013-10-28T04:05:12  <mordred> it's the version of pip in latest ubuntu
2013-10-28T04:05:25  <mordred> and, if you are using pip, it's the version you should be using
2013-10-28T04:05:36  <mordred> there is no valid reason to use pip < 1.4
2013-10-28T04:05:46  <notmyname> "should" is often not what our users are doing
2013-10-28T04:05:48  <mordred> because, by definitoin, if you are using it, you are using it to install software via pip
2013-10-28T04:06:13  <mordred> so you, by definition, are ok with instaling softare via pip :)
2013-10-28T04:06:17  *** lnxnut has quit IRC
2013-10-28T04:06:36  <mordred> well, for regular users, installing one of our things right now on old pip will give you a dependency error saying to upgrade your pip
2013-10-28T04:06:38  <mordred> which is pretty clear
2013-10-28T04:06:44  <notmyname> yup
2013-10-28T04:06:52  *** lnxnut has joined #openstack-infra
2013-10-28T04:06:58  <notmyname> I'm quite aware of that one ;-)
2013-10-28T04:07:12  <mordred> I could investigate figuring out a way to print a more verbose warning
2013-10-28T04:07:25  <mordred> which explains "seriously, dude. upgrade pip. you are opening yourself to being rooted right now"
2013-10-28T04:07:40  <notmyname> even when building packages and there is an older version of pip installed (even if you aren't using it...)
2013-10-28T04:07:57  <mordred> that should not be the behavior
2013-10-28T04:08:06  <mordred> if you are building packages
2013-10-28T04:08:12  <mordred> and if it is, it's a bug
2013-10-28T04:08:13  <notmyname> right. packagers should use the pbr env flags
2013-10-28T04:08:19  <notmyname> is that what you mena?
2013-10-28T04:08:31  <mordred> actually, they should not be necessary
2013-10-28T04:08:35  <mordred> it turns out
2013-10-28T04:08:56  *** primeministerp has quit IRC
2013-10-28T04:09:05  <mordred> as dh_python already passes --single-versoin-externaly-managed and I _think_ that should triger the SKIP_PIP_INSTALL codepath as well
2013-10-28T04:09:22  <mordred> it's on my todo list to tighten that up and get more tests to ensure that it is the case
2013-10-28T04:09:33  <mordred> but _certainly_ the packagers can be explicit and use the var
2013-10-28T04:10:16  <notmyname> mordred: on lucid, not using pip (but distro version installed), `python ./setup.py develop` doesn't work because pip isn't new enough
2013-10-28T04:10:23  <mordred> that is correct
2013-10-28T04:10:38  <mordred> because pip is a requirement of pbr
2013-10-28T04:10:44  *** dcramer_ has quit IRC
2013-10-28T04:11:10  <mordred> SKIP_PIP_INSTALL=1 python setup.py develop should work on lucid though
2013-10-28T04:11:15  *** lnxnut has quit IRC
2013-10-28T04:11:34  <mordred> I do not understand who the theoretical lucid user we're targetting here is though
2013-10-28T04:11:47  <mordred> so it's hard to design a solution for them
2013-10-28T04:12:14  <notmyname> in this case, it's me since my precise VM is hosed after my OS X update
2013-10-28T04:12:27  <notmyname> and I have a lucid VM in the cloud already
2013-10-28T04:12:30  <mordred> heh. good. well, I assume you're smarter than average
2013-10-28T04:12:34  <mordred> so that's helpful
2013-10-28T04:13:15  *** bingbu has joined #openstack-infra
2013-10-28T04:13:16  *** dripton_ has quit IRC
2013-10-28T04:13:41  <notmyname> nope. the env var doesn't help
2013-10-28T04:14:11  * mordred looking for his lucid image
2013-10-28T04:14:25  <mordred> notmyname: that not working i s a bug
2013-10-28T04:14:27  <notmyname> hmm..pbr isn't installed at all on this box
2013-10-28T04:14:40  <notmyname> maybe a bootstrapping thing?
2013-10-28T04:15:01  <mordred> do you have a pbr egg in that directory?
2013-10-28T04:15:24  <notmyname> I love the tracebacks with this line: "raise VersionConflict(dist,req) # XXX put more info here"
2013-10-28T04:15:43  <mordred> yah
2013-10-28T04:15:43  <notmyname> mordred: no. no traces of pbr that I can find
2013-10-28T04:15:55  *** oubiwann has quit IRC
2013-10-28T04:16:11  <mordred> it's very odd that any code is executing then, as setup.py has no functionality at all without pbr
2013-10-28T04:16:15  *** wenlock has quit IRC
2013-10-28T04:16:21  *** yamahata has quit IRC
2013-10-28T04:16:26  <mordred> as in, will fail to operate with an argument error
2013-10-28T04:16:43  <mordred> I dont' seem to have my lucid node any more - lemme spin one up
2013-10-28T04:17:07  <notmyname> setuptools is there and will execute. that's the call that setup.py is making
2013-10-28T04:17:30  *** matsuhashi has quit IRC
2013-10-28T04:17:32  *** yamahata has joined #openstack-infra
2013-10-28T04:18:06  *** rcleere has quit IRC
2013-10-28T04:18:19  <notmyname> to the cloud!
2013-10-28T04:18:21  *** sdake has quit IRC
2013-10-28T04:18:36  <mordred> but setuptools can't do anything without pbr
2013-10-28T04:18:52  *** ryanpetrello has joined #openstack-infra
2013-10-28T04:18:53  <mordred> the first thing it should try to do is download it because of setup_requires
2013-10-28T04:19:19  <mordred> notmyname: which repo are you doing, btw
2013-10-28T04:19:24  <notmyname> swift
2013-10-28T04:19:29  <mordred> k
2013-10-28T04:19:45  <mordred> and you've installed all of swift's depends by packages?
2013-10-28T04:20:05  <mordred> is ther e a place I can copy pate  a command to do that (want to duplicate env)
2013-10-28T04:20:13  <notmyname> It's been a long time since I've logged into this box. I'm honestly not sure
2013-10-28T04:20:36  *** matsuhashi has joined #openstack-infra
2013-10-28T04:20:48  <notmyname> I copied the code over to the lucid box, cd'd to the dir, and `sudo python ./setup.py develop`
2013-10-28T04:22:19  <mordred> wow. SO OLD SO OLD
2013-10-28T04:22:25  <mordred> ubuntu@lucidtest:~$ sudo apt-get install git-core
2013-10-28T04:22:26  <mordred> :)
2013-10-28T04:23:15  <notmyname> yup
2013-10-28T04:23:24  *** matsuhashi has quit IRC
2013-10-28T04:23:38  <jgriffith> mordred: notmyname only catching part of the context in scroll back...
2013-10-28T04:23:45  <jgriffith> mordred: notmyname changelog generation?
2013-10-28T04:23:58  <notmyname> jgriffith: once upon a time you mentioned that a curated might be nice
2013-10-28T04:24:23  <jgriffith> notmyname: ahh... yes, likely while I was updating release notes for python-cinderclient
2013-10-28T04:24:26  <notmyname> jgriffith: mordred was mentioning that you can easily turn off the auto-generation for cinder ifyou want
2013-10-28T04:24:31  <jgriffith> notmyname: or release notes for cinder G
2013-10-28T04:24:43  <mordred> jgriffith: there are two optoins for that - you can either turn off auto generatoin - or you can do them in sphinx docs like glanceclient: http://docs.openstack.org/developer/python-glanceclient/#release-notes
2013-10-28T04:25:00  <mordred> notmyname: ok. I see the bug. I will fix it
2013-10-28T04:25:14  <notmyname> mordred: ah really? I was sure I was doing something wrong
2013-10-28T04:25:22  <jgriffith> mordred: so I kinda decided I liked having them in sphinx and published on pypi
2013-10-28T04:25:24  <mordred> notmyname: nope. it's a bug. I apologize
2013-10-28T04:25:26  <jgriffith> for the client at least
2013-10-28T04:25:31  <mordred> jgriffith: awesome
2013-10-28T04:25:56  <jgriffith> mordred: notmyname auto-magically generating is the topic I think we talked about
2013-10-28T04:26:03  <jgriffith> mordred: notmyname that would still be quite nice
2013-10-28T04:26:22  <mordred> jgriffith: wait - what do you want?
2013-10-28T04:26:33  <jgriffith> mordred: haha... depends on when you ask
2013-10-28T04:26:38  <mordred> hahahaahahahaha
2013-10-28T04:26:57  <jgriffith> mordred: so... I *think* IIRC the conversation with notmyname was around trying to post process the release notes
2013-10-28T04:27:26  <jgriffith> and we had talked about a way to aut-generate off of say like BP or Bug tags in the commit
2013-10-28T04:27:55  <jgriffith> as it stands now... for cinder-client I go through commit history and manually try and fill in what's happened since the last release
2013-10-28T04:28:01  <jgriffith> in docs/index.rst
2013-10-28T04:28:23  <jgriffith> which I like because it shows up in pypi when you browse to the package
2013-10-28T04:28:42  *** matsuhashi has joined #openstack-infra
2013-10-28T04:28:58  <jgriffith> err...hmmm
2013-10-28T04:29:22  * jgriffith lies
2013-10-28T04:29:37  <jgriffith> it does not
2013-10-28T04:31:12  <jgriffith> I would have to modify the README for that
2013-10-28T04:31:24  <jgriffith> anyway... not sure if that's the context notmyname was recalling or not?
2013-10-28T04:31:44  <jgriffith> bahhh!!
2013-10-28T04:31:56  <jgriffith> mordred: continuous upgrade session conflicts :(
2013-10-28T04:32:48  <notmyname> jgriffith: I remember something much more general about just how changelogs are done in swift. but I need to start handling the swiftlclient changelog, and I'm leaning towards the sphinx docs like you use
2013-10-28T04:33:10  *** primeministerp has joined #openstack-infra
2013-10-28T04:33:37  <jgriffith> notmyname: cool... I think I was complaining to you late one night when I was trying to pull everything together :)
2013-10-28T04:34:15  <notmyname> jgriffith: I think we all do that every time any of us sees someone else in person ;-)
2013-10-28T04:34:34  <jgriffith> notmyname: LOL... indeed!
2013-10-28T04:37:28  <mordred> notmyname: you havea found a fascinating edge case
2013-10-28T04:37:50  <notmyname> mordred: oh goody
2013-10-28T04:40:27  *** yamahata has quit IRC
2013-10-28T04:41:44  <mordred> notmyname: it might be unfixable
2013-10-28T04:42:18  <notmyname> mordred: what's the issue? need pbr to resolve but pbr isn't installed?
2013-10-28T04:42:52  <mordred> nope. it's that setuptools itself is reading the requires list out of the pbr egg it downloads from EGG-INFO/requires.txt
2013-10-28T04:43:14  <mordred> which means that pbr's suppression of things hasn't been gotten to yet
2013-10-28T04:43:45  * mordred trying a few evil things real quick
2013-10-28T04:44:15  <notmyname> mordred: kk. which would also be an issue for package building since that would require setup.py to be run
2013-10-28T04:44:43  <mordred> actually, not really
2013-10-28T04:44:56  <mordred> package building gets build deps via packages
2013-10-28T04:45:07  <notmyname> ah, right
2013-10-28T04:45:08  <mordred> which means that the easy_install codepath in setuptools is not triggered
2013-10-28T04:45:20  <mordred> it's setuptools easy_install that is the culprit in everything
2013-10-28T04:47:23  <notmyname> hmm...but even then, packaging (or at least the lucid packaging I know) still uses setup.py for sphinx docs generation. so that would trigger it, at least
2013-10-28T04:47:34  <mordred> yes. but that's fine
2013-10-28T04:47:37  <notmyname> not sure of other setup.py references
2013-10-28T04:47:53  <mordred> becuase in _that_ context you're driving the setup.py in the conetxt of the SKIP_PIP_INSTALL
2013-10-28T04:48:17  <mordred> (there is a patch I need to make still - but different problem)
2013-10-28T04:48:37  <mordred> at least, I think I need to make it - I have a patch which will fix a thing I _thought_ was your problem :)
2013-10-28T04:48:46  <mordred> but that's not your problem
2013-10-28T04:49:11  *** reed has quit IRC
2013-10-28T04:53:02  <notmyname> mordred: thanks for looking
2013-10-28T04:53:25  <mordred> notmyname: I'm going to keep beating my head against it, because the sequence doesn't make me happy
2013-10-28T04:53:37  *** ljjjustin has quit IRC
2013-10-28T04:53:59  <lifeless> mordred: so, why does pbr need to be the place ChangeLog generation happens in?
2013-10-28T04:54:05  <mordred> but the best thing I can come up with is to remove the version specification from pip in requirements.txt
2013-10-28T04:54:16  <lifeless> mordred: like, why couldn't be in (say) pbr_utils which pbr arranges for install of ?
2013-10-28T04:54:16  <mordred> lifeless: hang on - lemme finish this thought
2013-10-28T04:54:48  *** vipul-away is now known as vipul
2013-10-28T04:55:50  *** ljjjustin has joined #openstack-infra
2013-10-28T04:55:56  <mordred> notmyname: I worry about doing that because while it will allow you to skip past your current thing, it widens the possibility that people will operate software with a known insecure version of things
2013-10-28T04:56:10  <mordred> notmyname: I'm landing - let me noodle on it further and see what the options might be
2013-10-28T04:56:33  <notmyname> mordred: kk. thanks again. (I'm out for the night too)
2013-10-28T05:06:00  *** senk has quit IRC
2013-10-28T05:15:21  *** nati_ueno has joined #openstack-infra
2013-10-28T05:16:53  *** nicedice__ has quit IRC
2013-10-28T05:22:27  *** yamahata has joined #openstack-infra
2013-10-28T05:37:55  *** nosnos_ has joined #openstack-infra
2013-10-28T05:37:58  *** nosnos has quit IRC
2013-10-28T05:44:35  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T05:54:17  <mordred> notmyname: my pleasure! let me know when you're back on, I have further thoughts
2013-10-28T05:54:20  <mordred> lifeless: morning!
2013-10-28T05:56:52  *** matsuhashi has quit IRC
2013-10-28T05:57:04  *** matsuhashi has joined #openstack-infra
2013-10-28T06:00:25  *** katyafervent has joined #openstack-infra
2013-10-28T06:01:04  <mordred> lifeless: I now have the bandwidth to discuss pbr and changelog generation
2013-10-28T06:01:18  *** denis_makogon has joined #openstack-infra
2013-10-28T06:02:50  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Skip the install of pip  https://review.openstack.org/54061
2013-10-28T06:02:56  *** mattymo has joined #openstack-infra
2013-10-28T06:05:09  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Make ChangeLog more condensed  https://review.openstack.org/52367
2013-10-28T06:05:09  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Let git do mailmap mapping for us  https://review.openstack.org/54050
2013-10-28T06:11:50  <openstackgerrit> A change was merged to openstack-infra/config: Add havana branch to gerritbot for #openstack-doc  https://review.openstack.org/53192
2013-10-28T06:12:54  <openstackgerrit> A change was merged to openstack-infra/config: add stable/grizzly for openstack-chef cookbooks  https://review.openstack.org/52416
2013-10-28T06:16:51  *** davidhadas_ has quit IRC
2013-10-28T06:18:32  *** tian has joined #openstack-infra
2013-10-28T06:46:39  <lifeless> mordred: cool
2013-10-28T06:57:23  *** vipul is now known as vipul-away
2013-10-28T07:01:50  *** davidhadas has joined #openstack-infra
2013-10-28T07:02:21  *** matsuhashi has quit IRC
2013-10-28T07:02:53  *** matsuhashi has joined #openstack-infra
2013-10-28T07:03:38  *** amotoki has joined #openstack-infra
2013-10-28T07:05:11  *** nosnos_ has quit IRC
2013-10-28T07:05:22  *** ryanpetrello has quit IRC
2013-10-28T07:05:36  *** nosnos has joined #openstack-infra
2013-10-28T07:07:05  *** matsuhashi has quit IRC
2013-10-28T07:07:56  *** matsuhashi has joined #openstack-infra
2013-10-28T07:09:10  <rakhmerov> mordred: could you please have a look at https://review.openstack.org/#/c/51205? Most likely you'll disapprove it for a couple of things, but I want to make sure before sending another patchset :)
2013-10-28T07:10:51  *** ljjjustin has quit IRC
2013-10-28T07:16:25  *** ben_duyujie has joined #openstack-infra
2013-10-28T07:21:39  *** ljjjustin has joined #openstack-infra
2013-10-28T07:28:21  *** ljjjustin has quit IRC
2013-10-28T07:32:11  *** davidhadas_ has joined #openstack-infra
2013-10-28T07:32:48  *** davidhadas_ has quit IRC
2013-10-28T07:33:53  *** davidhadas has quit IRC
2013-10-28T07:34:09  *** davidhadas has joined #openstack-infra
2013-10-28T07:44:39  *** DinaBelova has joined #openstack-infra
2013-10-28T07:49:17  *** dkliban has joined #openstack-infra
2013-10-28T08:01:49  *** flaper87|afk is now known as flaper87
2013-10-28T08:02:28  *** dkliban has quit IRC
2013-10-28T08:02:30  *** ben_duyujie has quit IRC
2013-10-28T08:02:34  *** davidhadas_ has joined #openstack-infra
2013-10-28T08:02:53  *** davidhadas has quit IRC
2013-10-28T08:09:00  *** nati_ueno has quit IRC
2013-10-28T08:09:34  *** matsuhashi has quit IRC
2013-10-28T08:09:37  *** nati_ueno has joined #openstack-infra
2013-10-28T08:10:08  *** matsuhashi has joined #openstack-infra
2013-10-28T08:12:33  *** matsuhas_ has joined #openstack-infra
2013-10-28T08:12:50  *** tkammer_ has joined #openstack-infra
2013-10-28T08:13:06  *** matsuhashi has quit IRC
2013-10-28T08:13:47  *** nati_ueno has quit IRC
2013-10-28T08:19:02  *** yamahata has quit IRC
2013-10-28T08:22:12  *** marun has joined #openstack-infra
2013-10-28T08:24:04  *** che-arne has joined #openstack-infra
2013-10-28T08:26:02  <ogelbukh> yay, now we have the change request: https://review.openstack.org/#/c/53858/
2013-10-28T08:28:29  *** boris-42 has quit IRC
2013-10-28T08:32:37  *** che-arne has quit IRC
2013-10-28T08:43:11  *** dizquierdo has joined #openstack-infra
2013-10-28T08:43:27  *** alexpilotti has joined #openstack-infra
2013-10-28T08:45:14  *** Bada has joined #openstack-infra
2013-10-28T08:47:27  *** marun has quit IRC
2013-10-28T08:49:23  *** denis_makogon has quit IRC
2013-10-28T08:52:54  <openstackgerrit> Andreas Jaeger proposed a change to openstack-infra/config: Split Install Guide into Debian and Ubuntu guides  https://review.openstack.org/54076
2013-10-28T08:54:44  *** hashar has joined #openstack-infra
2013-10-28T09:02:59  *** DinaBelova has quit IRC
2013-10-28T09:06:25  *** marun has joined #openstack-infra
2013-10-28T09:12:24  *** yassine has joined #openstack-infra
2013-10-28T09:19:21  <openstackgerrit> Dzmitry Horbach proposed a change to openstack-infra/jenkins-job-builder: Added default value of -1 for all logrotate attributes  https://review.openstack.org/54079
2013-10-28T09:19:26  *** ljjjustin has joined #openstack-infra
2013-10-28T09:22:17  *** fallenpegasus has quit IRC
2013-10-28T09:23:15  *** fbo_away is now known as fbo
2013-10-28T09:27:12  *** fallenpegasus has joined #openstack-infra
2013-10-28T09:28:19  <katyafervent> mordred, Hi) I have tiny question) Do we need someone else approval or it may happened that somebody forget to check approved?) Please take a look here https://review.openstack.org/#/c/52092/
2013-10-28T09:30:38  <ekarlso-> Anyone care to sign off on this ? https://review.openstack.org/#/c/51066/
2013-10-28T09:30:53  <ekarlso-> it's been there for 2 weeks and is pretty small :)
2013-10-28T09:32:04  *** ljjjustin has quit IRC
2013-10-28T09:32:35  *** bingbu has quit IRC
2013-10-28T09:34:22  *** dkliban has joined #openstack-infra
2013-10-28T09:36:29  *** boris-42 has joined #openstack-infra
2013-10-28T09:36:33  *** dizquierdo has quit IRC
2013-10-28T09:36:56  *** saschpe has quit IRC
2013-10-28T09:40:36  *** saschpe has joined #openstack-infra
2013-10-28T09:40:43  *** che-arne has joined #openstack-infra
2013-10-28T09:47:29  *** xchu has quit IRC
2013-10-28T09:50:26  *** SergeyLukjanov has quit IRC
2013-10-28T09:51:03  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T09:51:03  *** SergeyLukjanov has quit IRC
2013-10-28T09:54:21  *** DinaBelova has joined #openstack-infra
2013-10-28T09:58:45  *** matsuhas_ has quit IRC
2013-10-28T09:59:18  *** matsuhashi has joined #openstack-infra
2013-10-28T10:03:28  *** matsuhashi has quit IRC
2013-10-28T10:06:28  <openstackgerrit> Peter Liljenberg proposed a change to openstack-infra/jenkins-job-builder: Added support for Jenkins plugin Blame upstream committers  https://review.openstack.org/54085
2013-10-28T10:10:23  *** pcm_ has joined #openstack-infra
2013-10-28T10:12:23  *** davidhadas_ has quit IRC
2013-10-28T10:12:23  *** pcm_ has quit IRC
2013-10-28T10:12:58  *** pcm_ has joined #openstack-infra
2013-10-28T10:18:56  <Steap> Hey, I'm not familiar with StackForge and have just read this comment: https://review.openstack.org/#/c/53306/6/modules/openstack_project/files/gerrit/acls/stackforge/sphinxcontrib-docbookrestapi.config . Grepping through the sources, I'm under the impression that not many projects use a "-ptl" group, am I right ?
2013-10-28T10:19:34  <Steap> Since I don't think my project will be extremely huge, is it fine to keep a "-core" group for the "pushTag" action, and move to "-ptl" if, for some reason, it becomes quite big ?
2013-10-28T10:37:34  *** amotoki has quit IRC
2013-10-28T10:48:01  *** davidhadas has joined #openstack-infra
2013-10-28T10:50:27  *** shardy has joined #openstack-infra
2013-10-28T10:52:50  <mattymo> ttx, ping
2013-10-28T10:53:51  *** nosnos has quit IRC
2013-10-28T10:53:54  <ttx> mattymo: pong
2013-10-28T10:54:24  *** nosnos has joined #openstack-infra
2013-10-28T10:56:07  <mattymo> ttx, I saw your reply about #openstack-fuel
2013-10-28T10:56:41  <mattymo> ttx, think it's worth waiting for others to voice their opinion on this or just agree that your view is what the majority will hold?
2013-10-28T10:57:13  <ttx> mattymo: probably worth waiting
2013-10-28T10:57:32  <ttx> mattymo: have no idea what the others think about that
2013-10-28T10:58:36  *** ArxCruz has joined #openstack-infra
2013-10-28T10:58:50  *** nosnos has quit IRC
2013-10-28T10:59:36  <mattymo> ttx, I was hoping the fact that Mirantis is a foundation member and that we're in stackforge that it would influence the group
2013-10-28T10:59:47  <mattymo> but of course a line must be drawn somewhere
2013-10-28T11:10:33  *** guohliu has quit IRC
2013-10-28T11:10:44  <ekarlso-> anyone here familiar with the config file generation stuff ?
2013-10-28T11:15:20  <ekarlso-> https://review.openstack.org/54101 < I do "./tools/config/generate_sample.sh -b ./ -p libra -o etc" and I get "RuntimeError: Unable to find group for option daemon, maybe it's defined twice in the same group?"
2013-10-28T11:15:26  *** flaper87 is now known as flaper87|afk
2013-10-28T11:20:11  *** DinaBelova has quit IRC
2013-10-28T11:22:52  *** dizquierdo has joined #openstack-infra
2013-10-28T11:30:35  *** davidhadas has quit IRC
2013-10-28T11:31:26  *** davidhadas has joined #openstack-infra
2013-10-28T11:34:29  *** dims has joined #openstack-infra
2013-10-28T11:40:58  *** Bada has quit IRC
2013-10-28T11:41:11  *** Bada has joined #openstack-infra
2013-10-28T11:46:17  *** adalbas has joined #openstack-infra
2013-10-28T11:49:29  *** fallenpegasus has quit IRC
2013-10-28T11:49:38  <jog0> grenade is trying to upgrade from grizzly
2013-10-28T11:49:42  *** davidhadas has quit IRC
2013-10-28T11:49:55  <jog0> sdague: ^
2013-10-28T11:50:03  *** davidhadas has joined #openstack-infra
2013-10-28T11:50:29  <sdague> jog0: yes, it is
2013-10-28T11:50:47  <sdague> there is a whole bunch of stuff in process to try to fix that
2013-10-28T11:50:48  <jog0> sdague: is that why grenade is failing ATM?
2013-10-28T11:50:56  <sdague> jog0: I don't know
2013-10-28T11:50:57  <jog0> or at least making the issue worse
2013-10-28T11:51:18  <jog0> sdague: http://logs.openstack.org/59/53859/5/check/check-grenade-devstack-vm/2bea2b1/
2013-10-28T11:52:00  <sdague> that's a failure to validate old
2013-10-28T11:52:05  <sdague> it's not even tried to upgrade
2013-10-28T11:52:21  <sdague> someone broke agregates in grizzly?
2013-10-28T11:52:24  <jog0> sdague: right, but its a grizzly failure
2013-10-28T11:52:35  * jog0 pulls up griz git logs
2013-10-28T11:53:18  <jog0> this may explain how the issue got in.  do we run grenade on stable branches?
2013-10-28T11:53:33  <sdague> no, again, spent many days working on this last week :)
2013-10-28T11:53:46  <sdague> to try to get us there, bug apparently someone managed to break it first
2013-10-28T11:53:52  <jog0> sdague: btw I saw your email blogs this weekend, do you ever take time off?
2013-10-28T11:54:08  *** luisg has quit IRC
2013-10-28T11:54:17  <sdague> sometimes :) honestly my brain really wanted to work through some of these issues this weekend
2013-10-28T11:54:36  *** luisg has joined #openstack-infra
2013-10-28T11:54:40  <jog0> we need more people like you
2013-10-28T11:54:53  <sdague> I find that I just let my interest take me where it wants, otherwise I just end up doing one thing but thinking about something else
2013-10-28T11:55:04  *** fallenpegasus has joined #openstack-infra
2013-10-28T11:55:55  <jog0> https://review.openstack.org/#/q/status:merged+project:openstack/nova+branch:stable/grizzly,n,z
2013-10-28T11:56:08  <jog0> nothing looks obvious in that list, or even timewise
2013-10-28T11:56:19  *** simonmcc has quit IRC
2013-10-28T11:56:26  *** simonmcc has joined #openstack-infra
2013-10-28T11:56:49  <jog0> sdague: where is grenade configured to set old=grizzly
2013-10-28T11:56:50  *** fallenpegasus has quit IRC
2013-10-28T11:57:52  *** dkranz has joined #openstack-infra
2013-10-28T11:58:05  <sdague> devstack-gate
2013-10-28T11:58:25  <sdague> this is the change we need to get sorted - https://review.openstack.org/#/c/53940/
2013-10-28T11:58:40  <sdague> but that's having issues at the moment, and not sure why
2013-10-28T11:59:17  <sdague> also there are related grenade changes, look for the changes by mauro
2013-10-28T12:00:58  <jog0> sdague: so grenade isn't version agnostic?
2013-10-28T12:01:24  <sdague> no, it includes the specific fixups needed to get between two versions
2013-10-28T12:01:34  * jog0 cries a little
2013-10-28T12:01:36  <sdague> because, you can't upgrade openstack without that
2013-10-28T12:01:48  <jog0> sigh
2013-10-28T12:01:53  *** fallenpegasus has joined #openstack-infra
2013-10-28T12:02:03  <sdague> hey, more hands making all services roll forward with no changes required to configs, appreciated :)
2013-10-28T12:02:26  <jog0> sdague: hope to work on that for TripleO in the next few months
2013-10-28T12:02:29  <jog0> but in the CD story
2013-10-28T12:02:31  <sdague> the point of grenade was at least we'd have them all documented
2013-10-28T12:02:43  <sdague> yeh, I still don't see how you get around some of it
2013-10-28T12:02:50  <jog0> sdague: yeah I am not disagreeing just sad
2013-10-28T12:02:50  <sdague> like turning on v3 api
2013-10-28T12:03:14  <jog0> sdague: anyway back to the critical issue unbarring gate
2013-10-28T12:03:18  <jog0> unbreaking*
2013-10-28T12:03:27  <sdague> so the aggregates call fails
2013-10-28T12:03:40  <jog0> sdague: but why
2013-10-28T12:04:04  <sdague> http://logs.openstack.org/59/53859/5/check/check-grenade-devstack-vm/2bea2b1/console.html#_2013-10-28_10_41_58_612 is the problem, I think
2013-10-28T12:04:35  <jog0> we know this broke about 6 hours ago
2013-10-28T12:07:35  <jog0> grenade uses trunk clients right?
2013-10-28T12:08:06  <sdague> the exercises, yeh
2013-10-28T12:08:41  <sdague> oh, look at that
2013-10-28T12:08:42  <sdague> commit a1391b2ead18c617bc5ce373a621f8a74c9cd952
2013-10-28T12:08:42  <sdague> Merge: fbb01be 6374ee0
2013-10-28T12:08:42  <sdague> Author: Jenkins <jenkins@review.openstack.org>
2013-10-28T12:08:42  <sdague> Date:   Mon Oct 28 06:57:07 2013 +0000
2013-10-28T12:08:43  <sdague>     Merge "Nova aggregate-details should be more human friendly"
2013-10-28T12:08:50  <sdague> last commit in python-novaclient
2013-10-28T12:08:56  <jog0> sdague: I tried taht
2013-10-28T12:09:06  <jog0> I tried reverting
2013-10-28T12:09:08  <jog0> didn't fix
2013-10-28T12:09:10  <sdague> and?
2013-10-28T12:09:23  <jog0> https://review.openstack.org/#/c/54105/
2013-10-28T12:09:34  <jog0> I checked jenkins for the results so they didn't get pasted back
2013-10-28T12:11:47  <jog0> that 409 is expected
2013-10-28T12:11:51  <jog0> here is a passing grenade http://logs.openstack.org/35/51135/5/check/check-grenade-devstack-vm/fa4fcb1/console.html
2013-10-28T12:12:03  <jog0> http://logs.openstack.org/35/51135/5/check/check-grenade-devstack-vm/fa4fcb1/console.html#_2013-10-28_03_31_36_670
2013-10-28T12:12:43  <jog0> this may be a dep issue
2013-10-28T12:13:18  <jog0> sdague: pypi was updated around the time things started dying (6AM) http://pypi.openstack.org/openstack/?C=M;O=D
2013-10-28T12:13:26  <sdague> actually, I'm pretty sure it's that nova client change
2013-10-28T12:13:56  <sdague> I'm going to push the revert again
2013-10-28T12:14:00  <jog0> sdague: can't hurt
2013-10-28T12:14:05  <sdague> and let everything run through to see
2013-10-28T12:14:15  <jog0> sdague: hold on
2013-10-28T12:14:22  <jog0> I'll unabandon and recheck
2013-10-28T12:15:27  <sdague> nova aggregate-details $AGGREGATE_ID | egrep "{u'availability_zone': u'$AGGREGATE_A_ZONE'}|{}"
2013-10-28T12:15:36  <sdague> jog0: I did another push already of the revert
2013-10-28T12:15:44  <jog0> sdague: just noticed
2013-10-28T12:16:06  <sdague> but that's the line where we die, so the fact a display change was pushed would definitely trigger that
2013-10-28T12:17:17  <jog0> https://jenkins02.openstack.org/job/check-grenade-devstack-vm/3467/consoleFull
2013-10-28T12:17:42  <jog0> that was the output from my patch
2013-10-28T12:18:00  *** dprince has joined #openstack-infra
2013-10-28T12:18:01  <jog0> plus that change should have been self-gating
2013-10-28T12:18:24  <jog0> scratch tat
2013-10-28T12:18:55  <jog0> no it should have: https://review.openstack.org/#/c/50438/
2013-10-28T12:22:03  <sdague> so assuming this passes - https://review.openstack.org/#/c/54111/1 - I'll push that in
2013-10-28T12:22:08  <sdague> it will at least give us more info
2013-10-28T12:22:49  *** weshay has joined #openstack-infra
2013-10-28T12:23:25  <jog0> sdague: cool
2013-10-28T12:26:38  <jog0> sdague: yours failed too http://status.openstack.org/zuul/
2013-10-28T12:26:50  <jog0> any chance we are seeing an async issue?
2013-10-28T12:27:31  <jog0> http://logs.openstack.org/59/53859/5/check/check-grenade-devstack-vm/2bea2b1/logs/pip-freeze.txt.gz
2013-10-28T12:28:05  <jog0> and aren't actually using proposed change to novaclient?
2013-10-28T12:28:15  <sdague> yeh, that's what I'm thinking
2013-10-28T12:28:28  <jog0> sdague: GAH
2013-10-28T12:28:38  <jog0> http://logs.openstack.org/59/53859/5/check/check-grenade-devstack-vm/2bea2b1/console.html#_2013-10-28_10_39_07_145
2013-10-28T12:28:43  <sdague> that's going to need more experienced folks than I
2013-10-28T12:30:09  <katyafervent> fungi, Thanks a lot!)
2013-10-28T12:30:13  <openstackgerrit> A change was merged to openstack-infra/config: Add murano-metadataclient to stackforge  https://review.openstack.org/52092
2013-10-28T12:30:51  <fungi> Steap: it's fine if your core group is just going to be a couple of people who will participate in tagging releases on it. and my other concern on that change (pypi registration) seems addressed now
2013-10-28T12:31:40  <sdague> jog0: yeh, so we knew that this assymetric with stable was going to eventually be a problem
2013-10-28T12:31:50  <sdague> so I guess we know that it is today
2013-10-28T12:32:00  <sdague> is this a jeblair vacation week?
2013-10-28T12:32:18  <jog0> also its using github?
2013-10-28T12:32:25  <jog0> sdague: yup
2013-10-28T12:32:33  <jog0> in the Scottish Highlands
2013-10-28T12:32:34  <sdague> jog0: no, I don't think so
2013-10-28T12:32:54  <jog0> http://logs.openstack.org/59/53859/5/check/check-grenade-devstack-vm/2bea2b1/console.html#_2013-10-28_10_41_55_285
2013-10-28T12:33:33  <sdague> jog0: yeh, but the trees are preppred in the wrap script
2013-10-28T12:34:13  <jog0> ?
2013-10-28T12:36:14  <Steap> fungi: yes :)
2013-10-28T12:36:33  *** thomasem has joined #openstack-infra
2013-10-28T12:36:53  <Steap> fungi: honestly, I'm currently the  only member of the project; I'll probably be joined by some Ceiloemter devs, but I doubt we'll ever be "a lot of people"
2013-10-28T12:37:42  <sdague> jog0: we're never actually cloning in grenade
2013-10-28T12:37:51  <sdague> in the gate, all the trees are created for us
2013-10-28T12:37:55  *** alaski has joined #openstack-infra
2013-10-28T12:38:34  <fungi> katyafervent: no problem. i expect he didn't approve on +2 simply because he was on an airplane at the time
2013-10-28T12:38:53  <fungi> Steap: sounds good, and i see the pypi registration looks correct. thanks!
2013-10-28T12:39:05  <Steap> fungi: np :)
2013-10-28T12:39:56  <Steap> fungi: thx for the review
2013-10-28T12:39:57  <jog0> sdague: but you clone the other repos still right?
2013-10-28T12:40:26  <sdague> not in the gate
2013-10-28T12:40:50  <sdague> the entire environment is set up in advanced by the devstack-gate wrapper scripts
2013-10-28T12:41:06  <jog0> ohh the git_clone script doesn't clone git haha
2013-10-28T12:41:10  <sdague> yeh
2013-10-28T12:41:20  <sdague> it's a function for a reason, and it has a lot of ways to bail early
2013-10-28T12:41:29  <sdague> which we take advantage of
2013-10-28T12:41:37  <sdague> so yeh, it's the novaclient change
2013-10-28T12:41:44  <sdague> it changed formatting
2013-10-28T12:41:56  <sdague> fungi: can you ninja merge something for us?
2013-10-28T12:42:05  <fungi> sdague: i can
2013-10-28T12:42:13  <sdague> https://review.openstack.org/#/c/54108/
2013-10-28T12:42:13  <jog0> sdague: can we fix gate to pull that in instead?
2013-10-28T12:42:17  <fungi> the novaclient revert?
2013-10-28T12:42:21  <sdague> fungi: yeh
2013-10-28T12:42:28  <jog0> to use novaclient proposed change in grenade?
2013-10-28T12:42:41  <sdague> jog0: it will probably take days to get that sorted correctly, especially with jeblair not around
2013-10-28T12:43:06  <jog0> sdague: but don't we do that for other projects already
2013-10-28T12:43:25  <sdague> jog0: we've never sorted out the stable side of the grenade equation
2013-10-28T12:43:38  <jog0> sdague: this isn't stable this is clients
2013-10-28T12:43:40  <sdague> this was actually the thing I was working on for two days last week :)
2013-10-28T12:43:42  <fungi> yeah, if the grenade job is currently using released novaclient when testing novaclient, i agree the gate breakage isn't going to be immediately fixable without an override.
2013-10-28T12:44:15  <sdague> jog0: except.... I don't think the old tree is actually getting latest changes
2013-10-28T12:44:33  <sdague> there are two issues of stable side, stable jobs, and the stable /...../old/... tree
2013-10-28T12:45:09  <sdague> honestly, this is matrix hell in some ways to get all the moving parts sorted :)
2013-10-28T12:46:40  <sdague> fungi: so lets see if the novaclient revert gets us sorted, then we can deal with the rest of it when we aren't on fire
2013-10-28T12:46:48  <fungi> it's merged now
2013-10-28T12:47:06  <jog0> sdague: sounds good to me
2013-10-28T12:47:10  <jog0> didn't realize how bad it was
2013-10-28T12:47:10  <sdague> fungi: cool, thanks
2013-10-28T12:47:35  <jog0> sdague: want to send the ML response out saying life is good again
2013-10-28T12:47:38  <sdague> yeh, it's going to be a rough week with jeblair gone and mordred on a plan again to somewhere
2013-10-28T12:47:42  *** flaper87|afk is now known as flaper87
2013-10-28T12:47:44  <sdague> jog0: only once we know that it is
2013-10-28T12:47:49  <sdague> https://review.openstack.org/#/c/54111/ - recheck, should be a good test
2013-10-28T12:48:26  <jog0> sdague: heh I had no idea how delicate this stuff was
2013-10-28T12:49:21  <jog0> btw why doesn't neutron have grenade?
2013-10-28T12:49:39  <jog0> do we not have a neutron version?
2013-10-28T12:51:33  <sdague> because grenade only really checks 5 services - nova, cinder, swift, keystone, glance
2013-10-28T12:51:38  <sdague> and runs in nova-network mode
2013-10-28T12:52:03  <jog0> more matrix hell :)
2013-10-28T12:52:48  <sdague> yeh, and honestly, until neutron can run under tenant isolation, parallel, and a full tempest run, thinking it might upgrade test well... is *optimistic*
2013-10-28T12:53:04  <jog0> sdague: fair enough
2013-10-28T12:55:11  *** yamahata has joined #openstack-infra
2013-10-28T12:55:20  *** anteaya has joined #openstack-infra
2013-10-28T12:55:36  <sdague> and, basically there are very few people that help with grenade, so coverage is what it is
2013-10-28T12:57:16  *** lnxnut has joined #openstack-infra
2013-10-28T12:58:40  <jog0> sdague: which 'project' ownes it?
2013-10-28T12:58:41  <jog0> ci devstack qa?
2013-10-28T12:58:49  <sdague> qa
2013-10-28T12:59:16  <sdague> the reality is it's me and dtroyer, and whoever else I can con into helping :)
2013-10-28T12:59:17  <ArxCruz> clarkb: fungi can you guys help me with a zuul/jenkins issue ?
2013-10-28T13:00:07  <sdague> that set of ci stats for openstack really made the rounds yesterday
2013-10-28T13:00:22  <jog0> sdague: I may have conned myself into helping -- I want to get the RPC / rolling upgrade test up
2013-10-28T13:00:50  <jog0> but using grenade will be a bit of a burdon at least at first
2013-10-28T13:01:43  <sdague> honestly, with the complexity of getting the gate setup correctly for 2 trees, I think the only sane path is to work it into grenade scope
2013-10-28T13:02:16  *** zul has quit IRC
2013-10-28T13:02:42  <sdague> I really think any other approach just ends up building a grenade like fork of a thing, which is then 2 upgrade test frameworks with not enough reviewers to handle the crazy matrix
2013-10-28T13:03:26  <sdague> i.e. this is a harder problem than you realize, to make it gate friendly
2013-10-28T13:03:34  *** ericw has joined #openstack-infra
2013-10-28T13:04:27  *** lnxnut has quit IRC
2013-10-28T13:04:27  *** dripton has joined #openstack-infra
2013-10-28T13:04:28  *** julim has joined #openstack-infra
2013-10-28T13:04:37  <jog0> sdague: its not an upgrad test at first
2013-10-28T13:04:42  <jog0> its a RPC compat test
2013-10-28T13:04:47  <sdague> jog0: I get that
2013-10-28T13:04:58  *** lnxnut has joined #openstack-infra
2013-10-28T13:05:01  <sdague> but it is a test that needs 2 different versions of openstack checked out
2013-10-28T13:05:04  <jog0> sdague: but yeah I tend to agree, in the long term for sure
2013-10-28T13:05:08  <jog0> in the short term not sure
2013-10-28T13:05:22  <sdague> as you can see... getting that right in the gate is hard
2013-10-28T13:05:27  *** zul has joined #openstack-infra
2013-10-28T13:05:38  <sdague> starting over from scratch on that is just silly
2013-10-28T13:05:49  *** lnxnut has quit IRC
2013-10-28T13:06:05  *** lnxnut has joined #openstack-infra
2013-10-28T13:06:30  <sdague> because you'll just end up having learn, the hard way, all the things you need to do to make that work right in the gate
2013-10-28T13:06:39  <sdague> and build another crazy set of ifdefs in devstack-gate
2013-10-28T13:06:46  *** ruhe has joined #openstack-infra
2013-10-28T13:06:57  *** fallenpegasus has quit IRC
2013-10-28T13:07:47  <jog0> sdague: I did POC that ran after devstack finished
2013-10-28T13:07:50  <jog0> not during ... eww
2013-10-28T13:08:19  <jog0> anyway we don't have to sort this out now
2013-10-28T13:08:25  <jog0> won't happen before summit anyway
2013-10-28T13:10:06  *** lnxnut has quit IRC
2013-10-28T13:10:41  *** lnxnut has joined #openstack-infra
2013-10-28T13:11:06  <fungi> ArxCruz: what's the issue?
2013-10-28T13:11:58  *** fallenpegasus has joined #openstack-infra
2013-10-28T13:15:05  *** lnxnut has quit IRC
2013-10-28T13:15:58  <anteaya> sdague: that blog post was great
2013-10-28T13:16:19  <anteaya> for those who haven't seen it yet: http://dague.net/2013/10/27/openstack-ci-by-the-numbers/
2013-10-28T13:18:23  *** annegentle has joined #openstack-infra
2013-10-28T13:20:18  *** b3nt_pin has joined #openstack-infra
2013-10-28T13:20:38  *** b3nt_pin is now known as beagles
2013-10-28T13:20:41  *** guohliu has joined #openstack-infra
2013-10-28T13:21:43  <sdague> jog0: the thing is, if your setup ever relies on "then we git clone" ... -2, because zuul has to do all the cloning in the gate
2013-10-28T13:21:58  <sdague> or git anything, honestly
2013-10-28T13:22:10  <jog0> sdague: :(
2013-10-28T13:22:24  <fungi> sdague: well, you can clone and then fetch the zuul ref passed in as an envvar
2013-10-28T13:22:26  <sdague> zuul has to set up all the refs
2013-10-28T13:22:32  *** mriedem has joined #openstack-infra
2013-10-28T13:22:46  <jog0> the basic worflow I tested was: given a devstack
2013-10-28T13:22:48  <sdague> fungi: yeh, but the reality is zuul needs to do all the tree setup
2013-10-28T13:23:21  <jog0> checkout grizzly, kick nova-compute, run tempest
2013-10-28T13:23:38  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T13:23:40  <sdague> jog0: so how do you know to checkout grizzly?
2013-10-28T13:23:53  <jog0> sdague: on my own env 'git checkout ...'
2013-10-28T13:23:54  <sdague> and what if it's actually supposed to be a gerrit tree
2013-10-28T13:24:00  <sdague> because it's a grizzly change
2013-10-28T13:24:14  <jog0> sdague: yeah ... I agree
2013-10-28T13:24:28  <sdague> and what if there is code in the nova tree which hasn't dynamically loaded yet
2013-10-28T13:24:36  <jog0> anyway lets punt this to a HK chat
2013-10-28T13:24:41  <sdague> sure :)
2013-10-28T13:24:54  <sdague> but I'm a big -2 on another framework here :)
2013-10-28T13:25:17  <sdague> and you are going to need a lot of evidence that grenade *can't* be made to cover this issue to get me to change my mind
2013-10-28T13:25:20  <fungi> thinking through the latest excitement and how it specifically could have been prevented, i think once there are proper backward-compat jobs running for clients (so that the novaclient change in question would have failed to merge because it broke stable/grizzly, right?) this specific bit of the pain could be avoided?
2013-10-28T13:25:36  <sdague> so, I actually know why the current situation failed
2013-10-28T13:25:49  <sdague> because I was in this code friday, I just didn't understand this until then
2013-10-28T13:25:58  <sdague> but we currently *never* set zuul refs on old
2013-10-28T13:26:02  * fungi goes to find and review the client backward-compat testing change again
2013-10-28T13:26:07  *** jgriffith has quit IRC
2013-10-28T13:26:14  <sdague> which is basically the issue
2013-10-28T13:26:29  <sdague> and I think it might be subtle about how we do that
2013-10-28T13:26:45  <sdague> as the gate has never been set up to do tat
2013-10-28T13:27:03  *** jgriffith has joined #openstack-infra
2013-10-28T13:27:09  <fungi> sdague: what if there was already a separate job which ensured that what was set up for old was functional? (e.g. backward-compat devstack tempest-full)
2013-10-28T13:27:36  <sdague> so old actually was functional
2013-10-28T13:28:18  <jog0> mordred: is working on that AFAIK
2013-10-28T13:28:21  *** SergeyLukjanov has quit IRC
2013-10-28T13:28:23  <sdague> fungi: maybe that's a beer conversation?
2013-10-28T13:28:47  <sdague> so here's the thing
2013-10-28T13:28:52  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T13:29:06  <sdague> even in the best of cases, we are probably only testing 20% of surface
2013-10-28T13:29:10  <fungi> oh, was it only grenade tripping over the change in novaclient behavior and devstack-tempest on the starting stable branch would have been fine? if so, yeah that's a different kettle of fish
2013-10-28T13:29:29  <fungi> jog0: yes, he is, i was merely recalling that i need to review it again
2013-10-28T13:29:43  <zul> no new pbr yet?
2013-10-28T13:29:45  <jog0> greande is working again https://review.openstack.org/#/c/54092/
2013-10-28T13:30:02  <fungi> zul: i thought he tagged it yesterday
2013-10-28T13:30:04  <sdague> so I remain skeptical that we could keep the kind of throughput that we have today if we pulled the base case validation further away from the tests
2013-10-28T13:30:17  <zul> fungi: still not pypi
2013-10-28T13:30:21  <sdague> because it's not like we have 100% behavior definition
2013-10-28T13:30:29  <jog0> sdague: want to respond to the ML thread or should I
2013-10-28T13:30:48  <fungi> zul: i see it as 0.5.22 (uploaded today, utc)... https://pypi.python.org/pypi/pbr
2013-10-28T13:30:51  <sdague> jog0: I need to head to the office, so go for it (back on in 30)
2013-10-28T13:30:58  <jog0> kk
2013-10-28T13:31:24  <zul> fungi:  oh duh i totally need more caffine
2013-10-28T13:31:30  <fungi> zul: me too, me too
2013-10-28T13:40:16  *** rpodolyaka has left #openstack-infra
2013-10-28T13:42:19  <fungi> bodepd_: on https://review.openstack.org/51079 you're importing a git repository which has what look like a bunch of topic branches in it. those will be imported automatically with it unless you a) delete them there first or b) point your review.projects.yaml.erb entry at a fork with only the branch(es) you want imported
2013-10-28T13:45:14  *** jaypipes has joined #openstack-infra
2013-10-28T13:47:22  *** SergeyLukjanov has quit IRC
2013-10-28T13:49:14  <fungi> bodepd_: i'll follow up in the review since you're probably not in the office yet
2013-10-28T13:51:32  <mattymo> fungi, fyi bodepd_ was online until 3am your time. he might not show up for a few hrs
2013-10-28T13:52:00  <fungi> mattymo: yeah, that was only midnight his time
2013-10-28T13:52:15  <fungi> i had merely forgotten for a moment which tz he's in
2013-10-28T13:52:25  <mattymo> it happens
2013-10-28T13:52:40  <mattymo> fungi, regarding my channel request, it looks like I have resistance on both sides
2013-10-28T13:53:19  <mattymo> #fuel was registered by someone 7 years ago so I get to wait for freenode staff to review and convert it
2013-10-28T13:53:26  <fungi> mattymo: i feel bad--i'm so far behind on ml threads i haven't actually read it yet. taking a review break to look at it now
2013-10-28T13:54:17  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T13:54:22  *** nati_ueno has joined #openstack-infra
2013-10-28T13:56:10  <fungi> off-topic rant... shell server vm on a host which is rebuilding its software raid-1 after a failure. i/o starvation city: population me
2013-10-28T13:56:33  <mattymo> as we say in Russia, it's normal
2013-10-28T13:57:55  *** DinaBelova has joined #openstack-infra
2013-10-28T13:59:28  <zul> fungi: heh
2013-10-28T14:00:04  *** beekneemech is now known as bnemec
2013-10-28T14:00:22  <fungi> zul: i would call the sysadmin and yell at him, but yelling at myself isn't going to solve anything i'm afraid
2013-10-28T14:00:44  <rakhmerov> :)
2013-10-28T14:00:45  *** nati_ueno has quit IRC
2013-10-28T14:01:20  *** nati_ueno has joined #openstack-infra
2013-10-28T14:01:37  <zul> fungi:  you could look at yourself in the mirror and then start to yell
2013-10-28T14:02:39  *** boris-42 has quit IRC
2013-10-28T14:02:41  *** b3nt_pin has joined #openstack-infra
2013-10-28T14:02:41  <sdague> fungi: you got some time today to help on diving through the d-g scripts to see if we can come up with a "once and for all" approach that would have preventing the novaclient break?
2013-10-28T14:03:06  *** dcramer_ has joined #openstack-infra
2013-10-28T14:03:29  <rakhmerov> fungi: thanks for reviewing Mistral stuff at https://review.openstack.org/#/c/51205. I have a question on that. You left some comments some time ago and after that it's been there for a while and nobody else reviewed it. Do you think it makes sense to wait a little longer or it's better to fix those non-critical (if I understood your overall feedback) asap? Just not sure what to do next :(
2013-10-28T14:05:52  *** yamahata has quit IRC
2013-10-28T14:05:54  *** nati_ueno has quit IRC
2013-10-28T14:06:10  *** oubiwann has joined #openstack-infra
2013-10-28T14:06:30  <fungi> sdague: if i understand the problem you're trying to solve, i don't think it can be done with one job
2013-10-28T14:06:37  *** yamahata has joined #openstack-infra
2013-10-28T14:06:37  <fungi> at least not trivially
2013-10-28T14:07:18  *** fallenpegasus has quit IRC
2013-10-28T14:07:45  <fungi> consider, for a client/library change you want grenade to test two things... that the change isn't breaking the base scenario, and that the change works when applied to the upgraded version
2013-10-28T14:08:11  <fungi> well, actually i guess with libraries, you're not actually testing an upgrade of the library right?
2013-10-28T14:08:19  <sdague> correct
2013-10-28T14:08:27  <sdague> what I'm trying to do is prevent this wedge
2013-10-28T14:08:28  <fungi> only upgrades of servers
2013-10-28T14:09:39  <sdague> and what I'm trying to figure out is if setting 0 => 1 there is going to ruin the world - https://github.com/openstack-infra/devstack-gate/blob/master/devstack-vm-gate-wrap.sh#L490
2013-10-28T14:09:43  *** alcabrera has joined #openstack-infra
2013-10-28T14:09:46  <fungi> so we need to use the proposed change, if it's a library, in both the base scenario and the upgraded one. but if it's a server we only want the change in one or the other (in the base scenario for a stable branch test and in the upgraded scenario for a master branch change)
2013-10-28T14:10:07  <sdague> right, well the issue right now is on "old" we never update with zuul refs
2013-10-28T14:10:11  <sdague> ever
2013-10-28T14:10:17  <sdague> which is how we got the wedge
2013-10-28T14:10:48  <sdague> as novaclient was able to run through old verification with an old version, and new verification is different tests
2013-10-28T14:12:01  <fungi> okay, and doing so is going to require that the base scenario setup considers the zuul branch (to decide whether this is a test on stable or master so we know which direction we're testing in) and the zuul project (so we can decide whether it's one which gets the zuul ref in only one scenario or both)
2013-10-28T14:12:48  *** fallenpegasus has joined #openstack-infra
2013-10-28T14:14:07  *** ruhe has quit IRC
2013-10-28T14:15:07  *** oubiwann_ has joined #openstack-infra
2013-10-28T14:15:56  <fungi> note i'm mainly thinking in terms of "upgrade from change on stable" just to make sure we don't paint ourselves into a hole which makes that harder to implement later. i know it's not actually being done yet
2013-10-28T14:16:23  <sdague> yeh, though I actually think it's all related
2013-10-28T14:16:25  <fungi> dig ourselves into a corner, whatever ;)
2013-10-28T14:16:30  <sdague> the point being, we have 2 trees
2013-10-28T14:16:37  <sdague> and we get a zuul change in
2013-10-28T14:16:56  <sdague> actually, let's etherpad this
2013-10-28T14:17:01  <fungi> definitely
2013-10-28T14:17:24  <sdague> https://etherpad.openstack.org/p/dg-for-grenade
2013-10-28T14:17:46  <mordred> morning all
2013-10-28T14:17:54  <anteaya> morning
2013-10-28T14:17:55  *** oubiwann has quit IRC
2013-10-28T14:19:48  *** dkliban has quit IRC
2013-10-28T14:20:16  <sdague> mordred: so, it finally hit us, the stable upgrade grenade wedge
2013-10-28T14:20:28  *** b3nt_pin has quit IRC
2013-10-28T14:20:29  <mordred> sdague, fungi: I am not fully awake enough to be super helpful yet
2013-10-28T14:20:36  <sdague> fungi: honestly that third thing is the thing I'm scared about understanding
2013-10-28T14:20:37  <mordred> but, I think we have to consider zuul refs for both old and new
2013-10-28T14:20:42  <sdague> when we have a deep zuul queue
2013-10-28T14:20:46  <fungi> mordred: sdague yep
2013-10-28T14:21:12  *** beagles has quit IRC
2013-10-28T14:21:13  <mordred> I don't think the 3rd thing is too terrible
2013-10-28T14:21:21  <sdague> fungi: so if we blindly just say "apply to old" are we smart enough to only do that with the right branches?
2013-10-28T14:21:32  <fungi> sdague: there is logic in devstack which does that
2013-10-28T14:21:35  *** b3nt_pin has joined #openstack-infra
2013-10-28T14:21:38  <fungi> or rather in devstack-gate i think
2013-10-28T14:21:46  *** b3nt_pin is now known as beagles
2013-10-28T14:21:51  <fungi> first tries to find the zuul ref on the target branch then falls back
2013-10-28T14:21:54  <mordred> oh - you know what - jeblair and I already kinda stepped through the logic on this a little bit for the stable-client code
2013-10-28T14:22:07  *** oubiwann_ is now known as oubiwann
2013-10-28T14:22:43  <sdague> mordred: ok, cool
2013-10-28T14:22:52  <mordred> I think. I'm still caffinated
2013-10-28T14:22:55  <mordred> uncaffinated
2013-10-28T14:23:13  <sdague> fungi: yeh I guess it's unclear to me if the fallback branch is doing the right things, or only covers the client case
2013-10-28T14:23:35  <fungi> sdague: well, i think the fallback branch selection gets more complex in grenade
2013-10-28T14:23:48  *** ruhe has joined #openstack-infra
2013-10-28T14:24:01  *** markmcclain has joined #openstack-infra
2013-10-28T14:24:16  <fungi> but point was we can use similar logic around the zuul ref existing, we just need to have a bit more work surrounding fallback branch selection
2013-10-28T14:24:20  *** SergeyLukjanov is now known as _SergeyLukjanov
2013-10-28T14:24:49  *** _SergeyLukjanov has quit IRC
2013-10-28T14:24:57  *** fifieldt has quit IRC
2013-10-28T14:25:17  *** senk has joined #openstack-infra
2013-10-28T14:25:31  *** johnthetubaguy1 has joined #openstack-infra
2013-10-28T14:26:36  *** ryanpetrello has joined #openstack-infra
2013-10-28T14:26:52  *** rcleere has joined #openstack-infra
2013-10-28T14:27:05  *** dkliban has joined #openstack-infra
2013-10-28T14:27:16  *** johnthetubaguy1 is now known as johnthetubaguy
2013-10-28T14:27:36  <sdague> yeh, man, I want to really refactor the wrap script to make it make more sense to me. I'm so used to our heavy function style in devstack
2013-10-28T14:27:48  *** datsun180b has joined #openstack-infra
2013-10-28T14:28:15  <fungi> well, it *is* self-gating, now backward on on stable release branches of tempest jobs too
2013-10-28T14:28:27  *** che-arne has quit IRC
2013-10-28T14:29:50  <fungi> so if we want to refactor it some, we can have a fair amount of confidence we're not breaking the gate (though less confidence that it's still testing the things we think it's testing)
2013-10-28T14:30:21  *** senk has quit IRC
2013-10-28T14:30:58  <anteaya> rakhmerov: I would suggest that you address fungi's comments with a new patchset
2013-10-28T14:31:35  <anteaya> basically his comments amount to, "This patch won't achieve your goal the way it is written."
2013-10-28T14:33:03  <rakhmerov> anteaya: ok, will do
2013-10-28T14:33:13  <rakhmerov> thanks
2013-10-28T14:33:15  <anteaya> np
2013-10-28T14:33:32  <anteaya> thought I would jump in since he is in the middle of another conversation
2013-10-28T14:33:56  <fungi> yeah, i'm reading back over what i wrote now. it may work as written, but i don't know
2013-10-28T14:36:03  *** senk has joined #openstack-infra
2013-10-28T14:36:30  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T14:36:42  *** prad_ has joined #openstack-infra
2013-10-28T14:37:07  *** davidhadas_ has joined #openstack-infra
2013-10-28T14:39:12  *** davidhadas has quit IRC
2013-10-28T14:40:11  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: extract git_checkout into common function  https://review.openstack.org/54132
2013-10-28T14:40:33  *** che-arne has joined #openstack-infra
2013-10-28T14:41:37  *** davidhadas_ has quit IRC
2013-10-28T14:43:15  *** wenlock has joined #openstack-infra
2013-10-28T14:44:40  *** beagles has quit IRC
2013-10-28T14:45:22  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: move single host setup activities to setup_host  https://review.openstack.org/54133
2013-10-28T14:46:50  <ArxCruz> ALL: I'm listening review.openstack.org in my intern infrastructure, and my zuul is returning ZUUL_REF with a Z in front which make my jobs fail since it can't find the ref. I'm using layout.yaml from dev just to listen instead of send reviews back to review.openstack.org. Does anyone know what's could be wrong?
2013-10-28T14:47:15  *** yamahata has quit IRC
2013-10-28T14:48:27  <mordred> ArxCruz: zuul keeps its own copies of the repos where it constructs the refs to be changed
2013-10-28T14:48:28  *** fallenpegasus has quit IRC
2013-10-28T14:48:34  <fungi> ArxCruz: zuul refs have a Z at the start of their name so we can tell them apart from other refs (branches, tags, shas...)
2013-10-28T14:48:38  <mordred> ArxCruz: you need to make sure that you clone/fetch from your zuul
2013-10-28T14:48:48  *** vipul-away is now known as vipul
2013-10-28T14:49:01  <ArxCruz> mordred: and how I do that? where do i configure it ?
2013-10-28T14:49:21  <mordred> ArxCruz: in whatever job zuul is triggering, you need to fetch the ZUUL_REF right?
2013-10-28T14:49:32  <mordred> (you are already trying to do that, because you said it's failing)
2013-10-28T14:49:37  <fungi> ArxCruz: if you follow the puppetry for our zuul.openstack.org configuration, you'll see we have apache serving git repositories for it
2013-10-28T14:49:53  <mordred> when you do that, point it at your zuul
2013-10-28T14:50:37  <ArxCruz> mordred: fungi i'm cloning to my zuul, when zuul start he's cloning to /var/lib/zuul/git in my server
2013-10-28T14:50:50  <mordred> ArxCruz: yes. that's right
2013-10-28T14:50:51  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: Let us gate grenade forward  https://review.openstack.org/53940
2013-10-28T14:51:09  <mordred> ArxCruz: your jobs need to fetch the Z refs from the repos in /var/lib/zuul/git
2013-10-28T14:51:22  <ArxCruz> mordred: okay, i will check here
2013-10-28T14:51:33  <ArxCruz> by the way, there's a z repository here that's failing, is that okay ?
2013-10-28T14:51:49  <mordred> I don't know what you mean be failing?
2013-10-28T14:52:02  <fungi> i don't know what you mean by a z repository
2013-10-28T14:52:14  <mordred> sdague: Co-Authored-With: ... our AUTHORS script checks for Co-Authored-By: ... should it check for both?
2013-10-28T14:52:29  <sdague> mordred: doh
2013-10-28T14:52:33  <sdague> let me fix
2013-10-28T14:52:36  <ArxCruz> ERROR zuul.Repo: Unable to initialize repo for ssh://arxcruz@review.openstack.org:29418/z/tempest
2013-10-28T14:52:56  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: Let us gate grenade forward  https://review.openstack.org/53940
2013-10-28T14:52:57  <ArxCruz> fungi: mordred ^
2013-10-28T14:53:15  *** mrodden has joined #openstack-infra
2013-10-28T14:53:46  *** b3nt_pin has joined #openstack-infra
2013-10-28T14:53:54  *** fallenpegasus has joined #openstack-infra
2013-10-28T14:56:03  <mordred> ArxCruz: what's z/tempest ?
2013-10-28T14:56:30  <ArxCruz> mordred: nevermind, it's just a project in layout.yaml in zuul-dev
2013-10-28T14:56:31  <ArxCruz> :)
2013-10-28T14:56:37  <mordred> :)
2013-10-28T14:56:44  <fungi> ArxCruz: i'd need to read back through the zuul source, but first guess is that there's a config option to specify the path to where you want zuul to build its working repositories and you've specified ssh://arxcruz@review.openstack.org:29418/z as the path?
2013-10-28T14:57:11  <ArxCruz> fungi: i didn't specify nothing :) just puppet it
2013-10-28T14:57:13  <fungi> ph, that
2013-10-28T14:57:17  *** b3nt_pin is now known as beagles
2013-10-28T14:57:18  <fungi> oh, that
2013-10-28T14:57:25  <ArxCruz> in layout.yaml have a project z/tempest
2013-10-28T14:57:38  <fungi> z/tempest is a fake project to force shared queues for the jobs in it
2013-10-28T14:58:06  *** senk has quit IRC
2013-10-28T14:58:10  <fungi> i bet we have the same error in our zuul logs at startup
2013-10-28T14:58:17  *** senk has joined #openstack-infra
2013-10-28T14:58:47  *** senk has quit IRC
2013-10-28T14:59:02  *** senk has joined #openstack-infra
2013-10-28T15:00:01  *** dcramer_ has quit IRC
2013-10-28T15:00:37  <openstackgerrit> Matthew Mosesohn proposed a change to openstack-infra/config: add fuel-dev channel to gerritbot  https://review.openstack.org/53656
2013-10-28T15:00:59  *** Ryan_Lane has quit IRC
2013-10-28T15:01:33  *** xeyed4good has joined #openstack-infra
2013-10-28T15:01:37  *** xeyed4good has left #openstack-infra
2013-10-28T15:02:26  <ArxCruz> fungi: mordred it seems the problem is in devstack-vm-gate-wrap.sh
2013-10-28T15:02:34  <ArxCruz> export ZUUL_URL=${ZUUL_URL:-http://zuul.openstack.org/p}
2013-10-28T15:02:59  <mordred> yes. you'll want to set ZUUL_URL to point to your zuul instead of our zuul
2013-10-28T15:03:19  <ArxCruz> mordred: okay, the problem is that my vm is being created on demand through nodepool
2013-10-28T15:03:27  <ArxCruz> there's no way to set that automatically
2013-10-28T15:03:30  <ArxCruz> correct ?
2013-10-28T15:03:38  <mordred> sure there is
2013-10-28T15:03:39  *** nati_ueno has joined #openstack-infra
2013-10-28T15:03:44  <mordred> what's calling devstack-vm-gate-wrap.sh ?
2013-10-28T15:03:51  <ArxCruz> the jenkins job
2013-10-28T15:03:58  <mordred> yup. so set it in the jenkins job
2013-10-28T15:04:31  <ArxCruz> mordred: aha! but, if I do that, next time puppet service begin, it will fix that ;D
2013-10-28T15:04:35  <ArxCruz> got it ?
2013-10-28T15:04:46  <mordred> ArxCruz: set it in the jenkins-job-builder description of the job
2013-10-28T15:04:51  <mordred> so that puppet sets it
2013-10-28T15:05:24  <ArxCruz> mordred: i didn't get it :/
2013-10-28T15:05:48  <mordred> ArxCruz: you have a set of yaml files in your local env that contain the descriptions of the jenkins jobs, right?
2013-10-28T15:05:54  <mordred> ArxCruz: such as one called devstack-gate.yaml ?
2013-10-28T15:06:00  <ArxCruz> mordred: yes
2013-10-28T15:06:32  <mordred> ArxCruz: so edit them, and before it calls devstack-vm-gate-wrap.sh, do "export ZUUL_URL=http://my.local.zuul.server/p"
2013-10-28T15:06:52  *** changbl has quit IRC
2013-10-28T15:07:02  <mordred> ArxCruz: then puppet will see the change, apply it to your jenkins, and when jenkins tries to run the script, it will set the ZUUL_URL for you
2013-10-28T15:07:22  <ArxCruz> mordred: I got it, thanks
2013-10-28T15:07:31  <mordred> fungi: ^^ we may want to think about a way to parameterize that interaction slightly better
2013-10-28T15:07:33  *** dcramer_ has joined #openstack-infra
2013-10-28T15:07:41  <ArxCruz> mordred: yes! need it :)
2013-10-28T15:07:44  <mordred> fungi: in terms of people like ArxCruz setting up local testing
2013-10-28T15:08:13  <mordred> fungi: especially for the ones who do the thing we tell them they shoudl do - which is just use a copy of our stuff :)
2013-10-28T15:09:13  *** UtahDave has joined #openstack-infra
2013-10-28T15:09:17  <ArxCruz> mordred: and it's pretty easy to set
2013-10-28T15:09:23  <fungi> mordred: it is absolutely the case that we have lots of silent defaults to our own settings in various places, which makes them less discoverable since we don't need to set them in our configs
2013-10-28T15:09:45  <mordred> yup
2013-10-28T15:09:51  * mordred bets wenlock has found many of those :)
2013-10-28T15:09:57  <ArxCruz> I can change the yaml to export ZUUL_URL=<? some_config >
2013-10-28T15:10:05  <ArxCruz> if there's no some_config
2013-10-28T15:10:16  <mordred> wenlock: speaking of - when you get to zuul, you may hit this ^^
2013-10-28T15:10:17  *** reed has joined #openstack-infra
2013-10-28T15:10:23  <ArxCruz> the export ZUUL_URL=${ZUUL_URL:-http://zuul.openstack.org/p} line in devstack-vm-gate-wrap.sh will change it to the default one
2013-10-28T15:10:27  <mattymo> fungi, I already managed to get #fuel registered. It seemed much harder to just go around you guys than to go through
2013-10-28T15:10:30  <mordred> ArxCruz: you could - except I don't think we're doing any of our jenkins_job_builder things as templates, only as raw files
2013-10-28T15:10:39  <mattymo> err much easier just to go around*
2013-10-28T15:10:41  <wenlock> reading back...
2013-10-28T15:10:52  <wenlock> indeed we have hit this!
2013-10-28T15:10:59  *** SergeyLukjanov has quit IRC
2013-10-28T15:11:02  <wenlock> we were going to ask for help this week on that
2013-10-28T15:11:09  <ArxCruz> i found this issue with zuul before, and what I did was a workaround let me show you
2013-10-28T15:11:11  <mordred> heh. great timing
2013-10-28T15:11:41  <openstackgerrit> sebastian marcet proposed a change to openstack-infra/config: Review and create Puppet configuration for dev server blueprint sso-openid-provider  https://review.openstack.org/53644
2013-10-28T15:12:02  <ArxCruz> mordred: i did it: http://paste.openstack.org/show/50058/
2013-10-28T15:12:07  <fungi> mattymo: yeah, it's become a bit of a pain point now that we have 80 stackforge projects and counting
2013-10-28T15:12:36  <mordred> mattymo: there are a few things we haven't designed for with stackforge popularity - irc channels are clearly one of them :)
2013-10-28T15:12:40  <ArxCruz> so, I ran a sed after jenkins job is installed switching the zuul.openstack.org to my own
2013-10-28T15:12:56  <mordred> ArxCruz: hah. nice hack
2013-10-28T15:13:46  <krtaylor> ArxCruz, maybe a blueprint for this work, we can come up with a plan to parameterize as we get all this running in our environment
2013-10-28T15:14:37  <krtaylor> mordred, fungi ^^^
2013-10-28T15:14:45  <ArxCruz> krtaylor: to parameterize we need to move the yaml files from files to templates in puppet
2013-10-28T15:15:06  <fungi> krtaylor: in many cases (such as this one) it is parameterized already, but not necessarily discoverable without reading through the source
2013-10-28T15:15:22  <mordred> fungi: it's not though
2013-10-28T15:15:46  <mordred> fungi: because chaning the param would involve forking the puppet, which would make it exceedingly hard to track upstream changes
2013-10-28T15:15:48  <fungi> it's at least parameterized in the devstack-gate scripts in this particular case, and defaulting to our preferred config
2013-10-28T15:16:11  <fungi> but yes, not parameterized in jjb configuration nor in puppetry
2013-10-28T15:16:21  <krtaylor> ArxCruz and I were brainstorming how we could do this, maybe with heira
2013-10-28T15:16:23  <mordred> the question is - how can one put all localized parameters into site.pp - which has NO expecetations of reusability
2013-10-28T15:16:44  <mordred> I don't think you need to go heira
2013-10-28T15:17:10  <mordred> if you can just get it to be something that you put in manifests/site.pp and passed in to the modules, it should be ok
2013-10-28T15:18:33  <ArxCruz> mordred: like that sed ? I think that's a very ugly workaround :)
2013-10-28T15:19:05  <mordred> ArxCruz: it is an ugly workaround - I think we can figure out something better
2013-10-28T15:21:00  *** mgagne has joined #openstack-infra
2013-10-28T15:23:38  <ArxCruz> mordred: it seems this problem is only on devstack-gate, would be possible, move devstack-gate.yaml to templates, adding a new property on puppet like zuul_server_url, with the default to zuul.openstack.org and put this as an parameter in devstack-gate.yaml, then change in devstack-vm-gate-wrap.sh check if the parameter is set or not and change if necessary ?
2013-10-28T15:23:44  *** markmcclain has quit IRC
2013-10-28T15:23:54  *** ryanpetrello has quit IRC
2013-10-28T15:24:00  *** changbl has joined #openstack-infra
2013-10-28T15:27:00  <krtaylor> Just curious, how many 3rd party CI test environments exist? It would be useful to know so we could discuss the snags and how they were solved
2013-10-28T15:27:39  <fungi> krtaylor: https://review.openstack.org/#/admin/groups/91,members
2013-10-28T15:27:42  <krtaylor> maybe that is more of an email thread, or summit bof
2013-10-28T15:27:48  <mordred> krtaylor: summit bof!
2013-10-28T15:28:12  <mordred> krtaylor: I think figuring out the best way to discuss issues with third-party copies of infra without killing the infra team is a great idea
2013-10-28T15:28:28  *** sarob has quit IRC
2013-10-28T15:28:33  <krtaylor> prob too late for next week  :)
2013-10-28T15:28:39  <mordred> ArxCruz: I think that wold work - but I tihnk it might make the repo weird. I think that's close though
2013-10-28T15:28:57  *** sarob has joined #openstack-infra
2013-10-28T15:29:22  <krtaylor> mordred, agreed, we can help each other, bring forward plan to generalize things
2013-10-28T15:29:45  <fungi> i agree that there's a great long-tail benefit to be realized from helping other groups get copies of our different tools/systems up and running (since that means more people who can understand and improve on it eventually), but in the short term it's definitely very time-consuming to help those people get started
2013-10-28T15:29:58  <ArxCruz> i can't see this group 91,members :(
2013-10-28T15:30:20  <krtaylor> nor I
2013-10-28T15:30:29  <fungi> oh, right, it's not visible. fixing
2013-10-28T15:30:44  <ArxCruz> mordred: or we can move everything to templates already, even if it's note necessary for all the yaml's file
2013-10-28T15:31:03  <fungi> try again. there's really no reason we shouldn't make the list of bot accounts in our gerrit public
2013-10-28T15:31:05  <ArxCruz> will became more easy if in the future need to change something
2013-10-28T15:31:07  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T15:31:46  <mordred> fungi, clarkb: ^^ thoughts on moving jjb things from files to templates?
2013-10-28T15:31:52  *** davidhadas has joined #openstack-infra
2013-10-28T15:32:02  <mordred> does directory inclusion work on templates? or do we have to list each one individually?
2013-10-28T15:32:48  <fungi> mordred: i don't think it does. at least that was the reason i assumed we were using flat directories for templates in our modules
2013-10-28T15:33:31  *** yamahata has joined #openstack-infra
2013-10-28T15:33:31  *** sarob has quit IRC
2013-10-28T15:33:42  <fungi> perhaps if jjb could read from multiple directories, we's be able to put the templates in one and manage the other with just a file tree
2013-10-28T15:33:48  <fungi> er, we'd
2013-10-28T15:34:29  <fungi> though it may be that you can put a template in a puppet-managed directory and the resulting file counts as being a puppet-managed file for that directory
2013-10-28T15:35:11  <fungi> if the docs say that works, i'm not looking in the right place
2013-10-28T15:36:16  <fungi> on a separate note, fyi github's api endpoint is all fsck'd up again. manage-projects isn't running successfully today because of random github api errors
2013-10-28T15:36:20  *** yassine has quit IRC
2013-10-28T15:36:26  <ArxCruz> fungi: that would be the same as move only the devstack-gate.yaml to a template huh?
2013-10-28T15:36:37  <fungi> ArxCruz: right
2013-10-28T15:37:24  <fungi> ArxCruz: because i think it would still be nice for people to be able to add jjc files in the config repo without having to make accompanying edits to a manifest for each
2013-10-28T15:37:33  <fungi> er, jjb
2013-10-28T15:38:50  <ArxCruz> fungi: Is it possible use a directory as a template ?
2013-10-28T15:39:31  <fungi> ArxCruz: not sure. i've not tried that before, but there is documentation for puppet
2013-10-28T15:40:24  <openstackgerrit> A change was merged to openstack-infra/elastic-recheck: refactor templates into query_builder  https://review.openstack.org/52818
2013-10-28T15:40:28  *** ruhe has quit IRC
2013-10-28T15:41:35  <fungi> again, i don't see anything which says that's a feature, but i could be looking in the wrong part of the puppet docs
2013-10-28T15:41:36  *** chuck_ has joined #openstack-infra
2013-10-28T15:41:41  <ArxCruz> fungi: http://projects.puppetlabs.com/issues/6649
2013-10-28T15:41:51  <ArxCruz> it seems there's a module to do that
2013-10-28T15:41:56  <ArxCruz> but it's not a feature in puppet
2013-10-28T15:41:56  *** miqui has joined #openstack-infra
2013-10-28T15:43:00  <fungi> right, wontfix'd in puppet core anyway
2013-10-28T15:43:58  <ArxCruz> fungi: I believe it would be possible just move the devstack-vm.yaml to template
2013-10-28T15:44:11  <ArxCruz> creating a new puppet config only for jjb who needs parameters
2013-10-28T15:44:23  <ArxCruz> and another to read the jenkins_jobs_builder/config
2013-10-28T15:44:42  <ArxCruz> so, if you just want to add a new file without any changes, put in /config
2013-10-28T15:45:02  <ArxCruz> if you know it will need paramerter to be configured, change the puppet script
2013-10-28T15:45:27  <ArxCruz> it will split the jjb but it's the best solution I can see so far :/
2013-10-28T15:45:37  <fungi> right, just hoping puppet management of that directory won't step on puppet managing a specific file within the directory. would need testing
2013-10-28T15:45:47  *** krotscheck has joined #openstack-infra
2013-10-28T15:46:11  <ArxCruz> fungi: say no more, I will test in my infra
2013-10-28T15:46:12  <ArxCruz> :)
2013-10-28T15:46:20  <ArxCruz> if works, I will submit a patch :)
2013-10-28T15:46:40  <krtaylor> ArxCruz, +1, consider it added to our weekly spring backlog :)
2013-10-28T15:46:43  <fungi> it's far easier to discuss these things when there's concrete code behind them. thanks ArxCruz!
2013-10-28T15:46:58  <ArxCruz> fungi: :)
2013-10-28T15:47:19  *** krotscheck has quit IRC
2013-10-28T15:47:29  <ArxCruz> krtaylor: working on that right now, this will improve our work in like 90% for this week :)
2013-10-28T15:50:24  *** sdake has joined #openstack-infra
2013-10-28T15:51:36  *** fallenpegasus has quit IRC
2013-10-28T15:51:36  *** hogepodge has joined #openstack-infra
2013-10-28T15:52:09  *** yassine has joined #openstack-infra
2013-10-28T15:53:21  *** ruhe has joined #openstack-infra
2013-10-28T15:56:14  *** boris-42 has joined #openstack-infra
2013-10-28T15:56:28  *** fallenpegasus has joined #openstack-infra
2013-10-28T15:57:46  *** senk has quit IRC
2013-10-28T16:01:17  *** ruhe has quit IRC
2013-10-28T16:06:10  *** mrodden1 has joined #openstack-infra
2013-10-28T16:06:58  *** ^d has joined #openstack-infra
2013-10-28T16:07:11  *** ^d has quit IRC
2013-10-28T16:07:11  *** ^d has joined #openstack-infra
2013-10-28T16:07:27  *** mrodden has quit IRC
2013-10-28T16:08:09  *** senk has joined #openstack-infra
2013-10-28T16:09:54  *** gyee has joined #openstack-infra
2013-10-28T16:10:12  <anteaya> so reading up on how a puppet module is supposed to be created, should this be in modules/seafile/files rather than in modules/seafile/templates: https://review.openstack.org/#/c/54030/12/modules/seafile/templates/ccnet/seafile.ini
2013-10-28T16:10:15  *** senk1 has joined #openstack-infra
2013-10-28T16:10:17  <anteaya> since it isn't a template
2013-10-28T16:10:29  <mattymo> anteaya, are you staff?
2013-10-28T16:10:48  <anteaya> ha ha ha
2013-10-28T16:10:50  *** marun has quit IRC
2013-10-28T16:10:54  <anteaya> I can answer questions
2013-10-28T16:11:04  <mattymo> but not approve change requests :)
2013-10-28T16:11:05  <anteaya> I am not core infra so I can't kick a server
2013-10-28T16:11:10  <mattymo> fungi, maybe you can https://review.openstack.org/#/c/53656/
2013-10-28T16:12:50  <anteaya> no, I am not infra-core so I can not approve patches for merging
2013-10-28T16:12:58  *** senk has quit IRC
2013-10-28T16:12:59  *** nati_ueno has quit IRC
2013-10-28T16:13:35  *** nati_ueno has joined #openstack-infra
2013-10-28T16:17:33  <fungi> mattymo: did you /msg chanserv access #fuel add jeblair +AFRfiorstv (i can't check since chanserv tells me i'm not authorized to pull an access list for that channel)
2013-10-28T16:17:54  *** nati_ueno has quit IRC
2013-10-28T16:18:18  *** jcoufal has joined #openstack-infra
2013-10-28T16:18:53  *** chuck_ has quit IRC
2013-10-28T16:20:01  *** DinaBelova has quit IRC
2013-10-28T16:20:21  <mattymo> fungi, done
2013-10-28T16:20:30  *** esheffield_ has joined #openstack-infra
2013-10-28T16:23:56  <anteaya> mattymo just to give you a sense, fungi clarkb mordred and jeblair (who is on holidays this week) are all infra-core
2013-10-28T16:24:26  <anteaya> myself pleia2 and zaro are also infra team members though not infra-core, but pleia2 and zaro are core on other projects
2013-10-28T16:24:35  <anteaya> and we are all paid to be here
2013-10-28T16:26:30  *** ben_duyujie has joined #openstack-infra
2013-10-28T16:26:31  *** dstanek has joined #openstack-infra
2013-10-28T16:26:55  *** larsbutler has joined #openstack-infra
2013-10-28T16:28:39  *** tsufiev has joined #openstack-infra
2013-10-28T16:28:45  *** esheffield_ has quit IRC
2013-10-28T16:29:00  <larsbutler> hi there, I noticed that the *-coverage jobs on openstack CI have not been run in while: https://jenkins.openstack.org/search/?q=coverage&max=200
2013-10-28T16:29:20  <tsufiev> hi there! is this channel a suitable places for asking questions about pbr?
2013-10-28T16:29:39  <larsbutler> Many of them, including swift-coverage, keystone-coverage, and nova-coverage, have not been run since around August 5th/6th
2013-10-28T16:29:43  <larsbutler> Is this a bug?
2013-10-28T16:30:23  *** ryanpetrello has joined #openstack-infra
2013-10-28T16:30:25  <larsbutler> I ask because I stumbled upon this bug just a while ago, which probably would have been caught if the coverage job for keystone had been running: https://bugs.launchpad.net/keystone/+bug/1245539
2013-10-28T16:30:27  <uvirtbot> Launchpad bug 1245539 in keystone "Error running test coverage: "no such option: --coverage"" [Medium,In progress]
2013-10-28T16:30:46  <SpamapS> hm, PBR people.. any idea what this problem is: https://bugs.launchpad.net/bugs/1245372 ?
2013-10-28T16:30:48  <uvirtbot> Launchpad bug 1245372 in trove "kick-start mysql is not working" [Undecided,Confirmed]
2013-10-28T16:31:03  <anteaya> tsufiev: it is, though one person knows the most about pbr, the author mordred, so ask away - be prepared for pauses
2013-10-28T16:31:40  <anteaya> mordred: you have a pbr audience
2013-10-28T16:31:49  <tsufiev> anteaya: thank you, will ask him
2013-10-28T16:32:18  <anteaya> tsufiev: post your question in channel and he will read it when he gets to the backscroll
2013-10-28T16:32:31  <anteaya> who knows, maybe someone else can answer too
2013-10-28T16:33:21  <tsufiev> anteaya: yeah, I need a few minutes to type my issue in :)
2013-10-28T16:33:40  <anteaya> type away, or consider a paste.openstack.org
2013-10-28T16:33:45  <anteaya> for code samples and such
2013-10-28T16:33:51  <fungi> larsbutler: the coverage jobs run on either jenkins01 or jenkins02 now that we have multiple masters, and jenkins.o.o is only for security-sensitive jobs at this point
2013-10-28T16:34:26  *** markmcclain has joined #openstack-infra
2013-10-28T16:34:40  *** moted has joined #openstack-infra
2013-10-28T16:35:08  <larsbutler> fungi: ah, I see
2013-10-28T16:35:26  *** jpeeler has quit IRC
2013-10-28T16:35:26  *** senk1 has quit IRC
2013-10-28T16:35:29  *** julim has quit IRC
2013-10-28T16:35:39  <larsbutler> fungi: I found the keystone build failure associated with my issue: https://jenkins01.openstack.org/job/keystone-coverage/127/console
2013-10-28T16:35:51  *** jpeeler has joined #openstack-infra
2013-10-28T16:36:24  <larsbutler> so, is coverage just not a critical part of the build?
2013-10-28T16:36:46  *** guohliu has quit IRC
2013-10-28T16:37:13  *** thedodd has quit IRC
2013-10-28T16:37:17  <fungi> larsbutler: i think the discussion has come up before, as far as making coverage jobs latch or ratchet style enforcement, but we currently don't gate on it no
2013-10-28T16:37:36  <ArxCruz> fungi: mordred it works for me changing the devstack-vm.yaml to templates and adding a File(...) on puppet
2013-10-28T16:37:37  <ArxCruz> http://paste.openstack.org/show/50064/
2013-10-28T16:38:11  <fungi> ArxCruz: puppet doesn't complain or blow away the templated file then, eh? sounds like a potential solution
2013-10-28T16:38:42  <ArxCruz> fungi: I remove the devstack-vm.yaml from files/jenkins_job_builder/config directory
2013-10-28T16:39:12  <ArxCruz> and add it on templates/jenkins_job_builder/config
2013-10-28T16:39:40  *** adalbas has quit IRC
2013-10-28T16:40:00  <tsufiev> mordred: have you ever seen the following pbr-ed setup.py strange behaviour? I have an 'ordereddict' requirement line in project's requirements.txt, but when i run python setup.py egg_info (python --version -> 2.7.3), ordereddict line is silently ignored and doesn't get to the <project_name>.egg-info/requires.txt.
2013-10-28T16:40:05  <larsbutler> fungi: okay, understood. Do you think it would be worthwhile better integrate coverage runs into the builds? Or is there a good reason to not do this?
2013-10-28T16:40:28  <tsufiev> mordred: but if i change requirement line to the 'ordereddict==1.1', it gets there
2013-10-28T16:40:53  <ArxCruz> fungi: mordred and in my job I have this now: http://paste.openstack.org/show/50065/
2013-10-28T16:41:01  <fungi> larsbutler: one problem is that jenkins only has two ways to finish a job. success state or failure state. so we'd need two jobs--one which runs coverage and reports its results, a second which tries to run coverage and gates on whether or not you've broken the job
2013-10-28T16:43:09  <mattymo> fungi, what do we need to do for jeblair on #fuel-dev
2013-10-28T16:43:27  <fungi> larsbutler: that basically means always running coverage twice, and it's slow/expensive on larger code bases. also worth noting, we have the same situation on a lot of other non-voting jobs
2013-10-28T16:43:46  <mattymo> ?
2013-10-28T16:44:46  <fungi> mattymo: oh, i just realized that was #fuel-dev and not #fuel
2013-10-28T16:45:38  <fungi> mattymo: /msg chanserv access #fuel-dev add jeblair +AFRfiorstv
2013-10-28T16:46:54  <mattymo> fungi, it's done
2013-10-28T16:46:58  <fungi> chanserv will actually give me an access listing for that channel, so i should be able to confirm it for him
2013-10-28T16:47:17  <larsbutler> fungi: I don't quite understand. Why does there have to be one to run coverage & report, plus one more to run coverage & vote? (I'm totally new to the project, so I'm just trying to wrap my head around things)
2013-10-28T16:47:25  <fungi> mattymo: yep! i see him in there now. thanks!
2013-10-28T16:47:59  <mattymo> fungi, why do we need this? #puppet-openstack doesn't have any core members
2013-10-28T16:48:02  <mattymo> and it has gerritbot
2013-10-28T16:48:21  *** guohliu has joined #openstack-infra
2013-10-28T16:48:52  <ryanpetrello> https://review.openstack.org/#/c/42393/ anybody want to finally push this one through :)?
2013-10-28T16:50:31  <clarkb> morning
2013-10-28T16:50:40  <fungi> mattymo: i think it was recently realized that if that's not done pretty much as soon as the channel is registered, it becomes much, much harder for us to get access later. apparently jeblair has a backlog of channels he's trying to get founder status on so we can help troubleshoot issues with the bots we're managing on them
2013-10-28T16:51:18  *** lnxnut has joined #openstack-infra
2013-10-28T16:51:24  <mattymo> fungi, ok
2013-10-28T16:51:39  <fungi> in a lot of cases the channel gets registered by a lone founder who later disappears and then nobody has control over it any longer
2013-10-28T16:51:55  <mattymo> fungi, so can it be finished today and pushed through? are we waiting on him?
2013-10-28T16:52:10  <mattymo> fungi, and I trust you folks to be the benevolent dictators)
2013-10-28T16:53:05  *** vipul has quit IRC
2013-10-28T16:53:26  <fungi> mattymo: since i was able to confirm it in jeblair's absence (he's vacationing at the moment), if clarkb wants to get a double-check in on it we can probably put it through
2013-10-28T16:53:35  *** vipul has joined #openstack-infra
2013-10-28T16:53:41  *** dcramer_ has quit IRC
2013-10-28T16:54:51  *** ArxCruz has quit IRC
2013-10-28T16:55:08  <mattymo> clarkb, are you feeling generous today?
2013-10-28T16:55:23  <fungi> https://review.openstack.org/53656 being the change we're talking about
2013-10-28T16:55:35  *** ArxCruz has joined #openstack-infra
2013-10-28T16:55:35  *** dcramer_ has joined #openstack-infra
2013-10-28T16:55:52  *** lnxnut has quit IRC
2013-10-28T16:56:02  <fungi> i suppose https://review.openstack.org/52085 is in the same boat now too
2013-10-28T16:56:29  *** lnxnut has joined #openstack-infra
2013-10-28T16:57:37  *** markmcclain has quit IRC
2013-10-28T16:57:57  *** harlowja has joined #openstack-infra
2013-10-28T16:58:28  *** ryanpetrello has quit IRC
2013-10-28T16:58:54  <openstackgerrit> A change was merged to openstack-infra/config: Add IRC bot to #openstack-climate for all Gerrit changes  https://review.openstack.org/52085
2013-10-28T16:59:06  <fungi> not sure why #openstack-climate didn't need our intervention to register though. i wonder whether freenode staff are selectively enforcing namespace registrations?
2013-10-28T17:00:20  *** ArxCruz has quit IRC
2013-10-28T17:00:28  <clarkb> mattymo: fungi: looking
2013-10-28T17:00:40  <clarkb> fungi: may have been registered before the restrictions
2013-10-28T17:00:49  <fungi> good point
2013-10-28T17:01:01  <mordred> tsufiev: well, that's definitley a bug - but not the bug you think it is :)
2013-10-28T17:01:08  *** dcramer_ has quit IRC
2013-10-28T17:01:24  <mordred> tsufiev: I thought ordereddict was not needed on 2.7 ?
2013-10-28T17:02:22  <reed> which reminds me that #openstack-community is not registered with you guys
2013-10-28T17:03:08  *** dizquierdo has quit IRC
2013-10-28T17:04:18  <fungi> mordred: also, in case you missed SpamapS's comment earlier (and/or bug e-mails), today's pbr release is apparently causing problems for (at least) heat and trove... https://launchpad.net/bugs/1245372
2013-10-28T17:04:19  <uvirtbot> Launchpad bug 1245372 in trove "kick-start mysql is not working" [Undecided,Confirmed]
2013-10-28T17:04:29  <mordred> fungi: awesome
2013-10-28T17:05:06  <fungi> [pbr] Processing SOURCES.txt ... error: No such file or directory
2013-10-28T17:05:21  *** julim has joined #openstack-infra
2013-10-28T17:05:32  <fungi> probably their setup mentions a nonexistent file--i haven't checked yet
2013-10-28T17:05:50  *** markwash has quit IRC
2013-10-28T17:06:10  *** ArxCruz has joined #openstack-infra
2013-10-28T17:06:22  <SpamapS> heat-cfntools specifically
2013-10-28T17:06:27  <tsufiev> mordred: yeah, it is not needed in 2.7, but we have one requirements.txt both for ubuntu (python2.7) and CentOS (python2.6). I can bypass this, nevertheless it's still a bug :)
2013-10-28T17:06:42  <mordred> tsufiev: it's actually a feature :)
2013-10-28T17:07:04  <mordred> tsufiev: it explicitly doesn't install it on 2.7 so that people can have one requirements.txt and not have it pull in unneeded thing
2013-10-28T17:07:13  <mordred> tsufiev: (this was a request from ... I forget, someone)
2013-10-28T17:07:25  *** Ryan_Lane has joined #openstack-infra
2013-10-28T17:08:11  *** guohliu has quit IRC
2013-10-28T17:08:30  <tsufiev> mordred: I understand it could be nice in some circumstances, but it is confusing that pbr does that thing quietly
2013-10-28T17:08:37  *** Ryan_Lane has quit IRC
2013-10-28T17:09:04  <mordred> tsufiev: would you like it to print a message about that it's skipping it on purpose?
2013-10-28T17:09:10  <mordred> would that be helpful?
2013-10-28T17:09:28  <tsufiev> mordred:  yes, it would be great
2013-10-28T17:12:02  *** markmcclain has joined #openstack-infra
2013-10-28T17:12:31  <fungi> mordred: SpamapS: mmm, so i think maybe the "warning: LocalManifestMaker: standard file '-c' not found [...] error: No such file or directory" could be related after all. trying to see where it's picking up a -c
2013-10-28T17:12:32  *** yassine has quit IRC
2013-10-28T17:14:09  <SpamapS> fungi: thanks for investigating.
2013-10-28T17:14:09  <clarkb> mattymo: fungi: approved
2013-10-28T17:15:03  *** esheffield_ has joined #openstack-infra
2013-10-28T17:15:08  *** dkliban has quit IRC
2013-10-28T17:15:09  *** Ryan_Lane has joined #openstack-infra
2013-10-28T17:15:21  <openstackgerrit> A change was merged to openstack-infra/config: add fuel-dev channel to gerritbot  https://review.openstack.org/53656
2013-10-28T17:15:45  <mordred> SpamapS, fungi: I cannot reproduce that
2013-10-28T17:15:54  <mordred> virtualenv foo
2013-10-28T17:16:00  <mordred> foo/bin/pip install heat-cfntools
2013-10-28T17:16:02  <mordred> works for me
2013-10-28T17:16:03  *** DinaBelova has joined #openstack-infra
2013-10-28T17:16:54  *** vipul is now known as vipul-away
2013-10-28T17:17:21  *** ruhe has joined #openstack-infra
2013-10-28T17:17:22  *** hashar has quit IRC
2013-10-28T17:17:26  *** ruhe has quit IRC
2013-10-28T17:17:32  <fungi> mordred: yeah, i wonder whether something on the reddwarf end is contributing to this
2013-10-28T17:17:48  *** olaph has quit IRC
2013-10-28T17:17:58  <fungi> s/reddwarf/trove/
2013-10-28T17:18:27  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: Let us gate grenade forward  https://review.openstack.org/53940
2013-10-28T17:19:08  <tsufiev> mordred: there was a short network failure in our office, didn't i misssed your replies?
2013-10-28T17:19:47  <fungi> tsufiev: http://eavesdrop.openstack.org/irclogs/%23openstack-infra/%23openstack-infra.2013-10-28.log
2013-10-28T17:20:34  <tsufiev> ok, nothing was missed :)
2013-10-28T17:23:01  <sdague> so before I spend too much time on some of the d-g refactoring, it would be good to know if - https://review.openstack.org/#/c/54132/ and https://review.openstack.org/#/c/54133/ are the kinds of cleanups that people want to see (I'm currently sitting my grenade upgrade stuff behind them)
2013-10-28T17:23:45  *** flaper87 is now known as flaper87|afk
2013-10-28T17:24:07  *** krotscheck has joined #openstack-infra
2013-10-28T17:24:18  <ArxCruz> ALL: Have you guys seen this problem: http://paste.openstack.org/show/50070/
2013-10-28T17:24:38  <ArxCruz> I have the ip command in /usr/sbin/ip and I can execute as jenkins, stack, and root users
2013-10-28T17:24:48  <ArxCruz> but when it's running through jenkins it's failing
2013-10-28T17:25:45  *** vipul-away is now known as vipul
2013-10-28T17:27:14  <openstackgerrit> Monty Taylor proposed a change to openstack-dev/pbr: Make sure that we ioudly skip versioned 2.6 libs  https://review.openstack.org/54152
2013-10-28T17:27:20  <mordred> tsufiev: ^^
2013-10-28T17:27:24  <sdague> ArxCruz: /usr/sbin might not be in the path by default on fedora
2013-10-28T17:27:42  <ArxCruz> sdague: i think it's in jenkins default path
2013-10-28T17:27:50  *** markmcclain has quit IRC
2013-10-28T17:27:51  <sdague> but this is under the stack user
2013-10-28T17:27:57  *** yassine has joined #openstack-infra
2013-10-28T17:28:00  <sdague> so the path would be reset
2013-10-28T17:30:40  *** yassine has quit IRC
2013-10-28T17:31:30  *** olaph has joined #openstack-infra
2013-10-28T17:32:15  *** markmcclain has joined #openstack-infra
2013-10-28T17:35:08  *** Ryan_Lane has quit IRC
2013-10-28T17:37:09  *** mgagne has quit IRC
2013-10-28T17:37:29  *** mgagne has joined #openstack-infra
2013-10-28T17:37:29  *** mgagne has joined #openstack-infra
2013-10-28T17:38:15  <tsufiev> mordred: that was fast :)
2013-10-28T17:39:39  *** fbo is now known as fbo_away
2013-10-28T17:41:16  <ogelbukh> fungi: mordred: clarkb: gentlemen, could you please tell me what's needed to move a project to stackforge from public github repo?
2013-10-28T17:41:41  *** reed has quit IRC
2013-10-28T17:41:46  <ogelbukh> i filed a change request already to the config repo: https://review.openstack.org/#/c/53858/
2013-10-28T17:42:03  <pleia2> ogelbukh: have you seen http://ci.openstack.org/stackforge.html
2013-10-28T17:42:39  <ogelbukh> sure
2013-10-28T17:42:45  <pleia2> ok, cool :)
2013-10-28T17:42:54  <ogelbukh> i think i'll need to provide some additional information
2013-10-28T17:43:28  *** tkammer_ has quit IRC
2013-10-28T17:43:54  <pleia2> yeah, you'll need to request a group set up with initial core reviewers
2013-10-28T17:44:04  <fungi> ogelbukh: mostly time. we're a bit backlogged with releases, upcoming summit preparations, conferences and travel. also, stackforge-related work is generally a lower priority for us than work on openstack itself
2013-10-28T17:44:16  <ogelbukh> pleia2: thanks!
2013-10-28T17:44:34  *** markwash has joined #openstack-infra
2013-10-28T17:44:34  <fungi> but we do try to get through and review all submitted changes
2013-10-28T17:44:35  <pleia2> ogelbukh: but that's after your change has merged, so as fungi says - time :)
2013-10-28T17:45:13  <ogelbukh> fungi: fair, thamnk you!
2013-10-28T17:45:19  <ogelbukh> -m
2013-10-28T17:48:23  <clarkb> fungi: ogelbukh: ya this week is going to be hard to get "real" work done
2013-10-28T17:48:34  *** reed has joined #openstack-infra
2013-10-28T17:49:17  <fungi> interesting statistic... 189 projects in review.openstack.org. 42% stackforge, 35% openstack, 18% openstack-infra, 5% openstack-dev
2013-10-28T17:49:42  <pleia2> stackforge sure has grown
2013-10-28T17:51:13  *** sarob has joined #openstack-infra
2013-10-28T17:51:33  <ogelbukh> stackforge is representing ecosystem, so it's natural, i guess
2013-10-28T17:53:08  <reed> does seafile support storing files in swift?
2013-10-28T17:53:33  <pleia2> fungi: worth some informal chatting about at summit re: allocation of resources?
2013-10-28T17:55:25  <fungi> pleia2: probably at least twice... maybe one of those without beer
2013-10-28T17:55:42  <pleia2> ++
2013-10-28T18:02:09  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: Let us gate grenade forward  https://review.openstack.org/53940
2013-10-28T18:02:14  <sdague> so close....
2013-10-28T18:02:46  <sdague> fungi: so I think https://review.openstack.org/53940 is functionally right, we just need to do this lockstep thing with the grenade upgrade
2013-10-28T18:03:10  <sdague> so I need to make it run grizzly as stable on master until we get working havana => master grenade
2013-10-28T18:03:58  <fungi> can that be phased, or will both changes have to be force-merged in tandem?
2013-10-28T18:04:57  <clarkb> sdague: I am reviewing 53490
2013-10-28T18:06:04  * fungi is as well
2013-10-28T18:07:26  <klrmn> lifeless: testresources does not work out-of-the-box with nose, i had to write a nose plugin to force it to use the OptimisingTestSuite. i'll let you know when i publish the pluginfirst it has to survive the fire that will be refactoring all my tests to use it
2013-10-28T18:07:57  <lifeless> klrmn: cool
2013-10-28T18:09:13  <clarkb> sdague: reviewed
2013-10-28T18:09:49  <bodepd_> fungi: thanks fungi. I didn't even realize those branches were there. Looking into it now
2013-10-28T18:11:24  <sdague> clarkb: thanks, good catches
2013-10-28T18:11:37  <sdague> I'm going to let this run to completion to see if the grenade job actually worked this time
2013-10-28T18:11:49  <clarkb> wfm
2013-10-28T18:12:09  <sdague> fungi: yes, so the attempt as phasing it is doing the wrong thing in this change and setting old=grizzly for master
2013-10-28T18:12:15  <sdague> then fixing grenade
2013-10-28T18:12:24  <sdague> then fixing this to old=havana for master
2013-10-28T18:13:27  <sdague> clarkb: my comments on your comments there. On missed variable, and one bad merge :)
2013-10-28T18:15:09  <fungi> completely unrelated, but i confirmed you can get git tab completion to do some nasty local code execution tricks by backticking a command in a tag name, as long as you respect git's limitations on what characters are valid for a tag
2013-10-28T18:15:28  <fungi> it's actually pretty funny
2013-10-28T18:15:32  *** dcramer_ has joined #openstack-infra
2013-10-28T18:16:38  *** ruhe has joined #openstack-infra
2013-10-28T18:17:14  <clarkb> fungi: your idea of funny is disturbing :)
2013-10-28T18:17:18  <fungi> for example, create a backdoor.sh (doing something like "touch pwnd") script in your repo and make it executable, then tag a commit as `./backdoor.sh` and try tab-completing git branch -D
2013-10-28T18:17:38  *** adalbas has joined #openstack-infra
2013-10-28T18:19:00  <fungi> this cropped up from some earlier work i did on trying to inject arbitrary code in tags we reference in our release jobs, which turned out not to be viable but the side effect was that i started getting file-not-found errors when tab-completing refnames in that checkout. only just noticed it
2013-10-28T18:19:04  <reed> I love CLAs corner cases
2013-10-28T18:19:05  *** yaguang has joined #openstack-infra
2013-10-28T18:19:56  *** SergeyLukjanov is now known as _SergeyLukjanov
2013-10-28T18:20:26  *** _SergeyLukjanov has quit IRC
2013-10-28T18:21:00  *** DinaBelova has quit IRC
2013-10-28T18:22:33  *** DinaBelova has joined #openstack-infra
2013-10-28T18:23:19  <clarkb> fungi: that is pretty funny. are '$'s allowed in tag names?
2013-10-28T18:23:59  <clarkb> something like `echo "Hello, $USER this is git. Nice to meet you."` would be an excellent tag name
2013-10-28T18:24:12  <fungi> clarkb: well, the biggest trick is that spaces aren't allowed
2013-10-28T18:24:23  <clarkb> well we use underscores then!
2013-10-28T18:24:36  <clarkb> and not echo
2013-10-28T18:24:45  <fungi> but you could stuff that echo into a script in the repo and have the tag exec it
2013-10-28T18:25:37  *** ruhe has quit IRC
2013-10-28T18:26:28  *** katyafervent has quit IRC
2013-10-28T18:26:35  <fungi> oh, also it seems stdout gets swallowed, but things like file interaction still work
2013-10-28T18:26:40  *** mattymo has quit IRC
2013-10-28T18:26:40  *** tsufiev has quit IRC
2013-10-28T18:27:38  <lifeless> jgriffith: hey
2013-10-28T18:27:46  <lifeless> jgriffith: you should totally hang out in #tripleo
2013-10-28T18:28:07  <lifeless> fungi: hard space!
2013-10-28T18:28:20  *** Bada has quit IRC
2013-10-28T18:28:20  <fungi> heh
2013-10-28T18:28:40  <fungi> i think tag names may be ascii only, so utf-8 hard space wouldn't be an option
2013-10-28T18:29:05  <fungi> a very strict printable ascii subset, if memory serves (i looked it up in the manpage a while back)
2013-10-28T18:30:09  *** dkliban has joined #openstack-infra
2013-10-28T18:30:50  *** fallenpegasus has quit IRC
2013-10-28T18:31:27  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T18:35:32  *** esker has joined #openstack-infra
2013-10-28T18:36:01  *** fallenpegasus has joined #openstack-infra
2013-10-28T18:37:51  *** changbl has quit IRC
2013-10-28T18:43:08  *** ben_duyujie has quit IRC
2013-10-28T18:45:53  <openstackgerrit> Arx Cruz proposed a change to openstack-infra/config: Adding support to a generic zuul server in JJB for devstack-gate  https://review.openstack.org/54160
2013-10-28T18:46:00  <ArxCruz> fungi: mordred ^
2013-10-28T18:46:29  *** dkliban has quit IRC
2013-10-28T18:47:23  *** thedodd has joined #openstack-infra
2013-10-28T18:47:25  *** fallenpegasus has quit IRC
2013-10-28T18:50:59  *** changbl has joined #openstack-infra
2013-10-28T18:51:12  *** ArxCruz has quit IRC
2013-10-28T18:51:34  *** ArxCruz has joined #openstack-infra
2013-10-28T18:54:12  *** yaguang has quit IRC
2013-10-28T18:54:51  *** larsbutler has quit IRC
2013-10-28T18:56:25  *** jergerber has joined #openstack-infra
2013-10-28T18:59:36  *** hogepodge has quit IRC
2013-10-28T19:00:33  <openstackgerrit> Arx Cruz proposed a change to openstack-infra/config: Adding support to a generic zuul server in JJB for devstack-gate  https://review.openstack.org/54160
2013-10-28T19:02:53  *** markmcclain has quit IRC
2013-10-28T19:07:30  *** dims has quit IRC
2013-10-28T19:07:56  <openstackgerrit> Anita Kuno proposed a change to openstack-infra/config: Create a seafile instance.  https://review.openstack.org/54030
2013-10-28T19:10:02  *** dims has joined #openstack-infra
2013-10-28T19:11:30  <openstackgerrit> Arx Cruz proposed a change to openstack-infra/config: Adding support to a generic zuul server in JJB for devstack-gate  https://review.openstack.org/54160
2013-10-28T19:13:45  *** rainya has quit IRC
2013-10-28T19:14:28  *** melwitt has joined #openstack-infra
2013-10-28T19:15:06  *** DinaBelova has quit IRC
2013-10-28T19:16:03  <openstackgerrit> Arx Cruz proposed a change to openstack-infra/config: Adding support to a generic zuul server in JJB for devstack-gate  https://review.openstack.org/54160
2013-10-28T19:17:17  <ArxCruz> fungi: mordred do I need, in my openstack installation, open the 35357 door in order to jobs run?
2013-10-28T19:19:00  *** DinaBelova has joined #openstack-infra
2013-10-28T19:22:49  *** DinaBelova has quit IRC
2013-10-28T19:24:18  *** jcoufal has quit IRC
2013-10-28T19:24:42  *** johnthetubaguy has quit IRC
2013-10-28T19:24:50  *** jcoufal has joined #openstack-infra
2013-10-28T19:26:08  <openstackgerrit> Arx Cruz proposed a change to openstack-infra/config: Adding support to a generic zuul server in JJB for devstack-gate  https://review.openstack.org/54160
2013-10-28T19:27:33  *** danger_fo_away has quit IRC
2013-10-28T19:28:37  *** nicedice__ has joined #openstack-infra
2013-10-28T19:29:13  <sdague> fungi: did you have any other comments on this - https://review.openstack.org/#/c/53940/ ?
2013-10-28T19:29:30  <sdague> before I respin with the fixes clarkb suggested
2013-10-28T19:29:39  <sdague> as I managed to get it to pass grenade... yay!
2013-10-28T19:29:58  *** dstufft has quit IRC
2013-10-28T19:30:28  *** dstufft has joined #openstack-infra
2013-10-28T19:30:48  *** LinuxJedi_ has joined #openstack-infra
2013-10-28T19:31:13  *** danger_fo_away has joined #openstack-infra
2013-10-28T19:31:36  *** nati_ueno has joined #openstack-infra
2013-10-28T19:31:37  <openstackgerrit> Arx Cruz proposed a change to openstack-infra/config: Adding support to a generic zuul server in JJB for devstack-gate  https://review.openstack.org/54160
2013-10-28T19:31:54  *** yamahata has quit IRC
2013-10-28T19:31:54  *** jeblair has quit IRC
2013-10-28T19:31:54  *** LinuxJedi has quit IRC
2013-10-28T19:32:07  *** uvirtbot has quit IRC
2013-10-28T19:32:26  *** yamahata has joined #openstack-infra
2013-10-28T19:33:32  *** jeblair has joined #openstack-infra
2013-10-28T19:34:20  *** davidhadas has quit IRC
2013-10-28T19:34:26  *** markwash_ has joined #openstack-infra
2013-10-28T19:34:38  <fungi> sdague: no, seems safe enough, those couple items aside
2013-10-28T19:35:04  *** mtreinish has quit IRC
2013-10-28T19:35:44  <openstackgerrit> Joe Gordon proposed a change to openstack-dev/hacking: Continue reserving H6xx namespace for calling methods  https://review.openstack.org/54165
2013-10-28T19:36:10  <fungi> side note, we have rather many branch variables in devstack-gate scripts. wish there were better ways to distinguish them'
2013-10-28T19:36:18  <jog0> clarkb, sdague:  ^^ last patch before ready to cut hacking 0.8.0
2013-10-28T19:36:19  *** markwash has quit IRC
2013-10-28T19:36:20  *** markwash_ is now known as markwash
2013-10-28T19:40:13  *** mtreinish has joined #openstack-infra
2013-10-28T19:48:40  <fungi> clarkb: good news on the git tag tab completion command injection front... can't seem to reproduce running debian's 1.8.4~rc3-1 package
2013-10-28T19:48:59  <sdague> fungi: yes, for sure, something maybe to think about in the grenade session
2013-10-28T19:49:03  <fungi> hopefully the old bash tab completion file was screwy
2013-10-28T19:53:42  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: Let us gate grenade forward  https://review.openstack.org/53940
2013-10-28T19:55:25  <fungi> yeah, i can reproduce it on precise :(
2013-10-28T19:59:45  <sdague> ok, so that should be good to go. fungi / clarkb you guys ok with the refactor patches under it?
2013-10-28T19:59:54  <sdague> or should I rebase that on master?
2013-10-28T20:01:01  <openstackgerrit> Anita Kuno proposed a change to openstack-infra/config: Create a seafile instance.  https://review.openstack.org/54030
2013-10-28T20:01:10  *** mrodden1 has quit IRC
2013-10-28T20:01:25  *** mrodden has joined #openstack-infra
2013-10-28T20:02:32  *** emagana has joined #openstack-infra
2013-10-28T20:03:23  <wenlock> quick config question for gerrit group settings.  is there a reason why Release Managers group is visible to all but Stable Maintainers gorup is not?
2013-10-28T20:03:29  *** LinuxJedi_ is now known as LinuxJedi
2013-10-28T20:03:49  *** sarob has quit IRC
2013-10-28T20:05:16  <wenlock> same question for External Testing Tools group... why is that visible and not Continuous Integration Tools group?
2013-10-28T20:05:52  *** sarob has joined #openstack-infra
2013-10-28T20:07:31  <fungi> wenlock: probably just oversight on our part. about the only things i feel we should keep non-visible are the cla-related groups, but it's probably something we ought to discuss with the other infra team members
2013-10-28T20:08:16  <wenlock> fungi, thanks... i was just trying to understand it... i get some groups are more sensative than others
2013-10-28T20:08:29  <wenlock> i was thinking the logic might have been reversed though
2013-10-28T20:09:11  <fungi> in particular we started making the .*-core groups visible so people with reviews knew who to reach out to if necessary
2013-10-28T20:09:15  <wenlock> ie; protect the managers more than the maintainers.... or same for the ci accounts, protect the names since they arn't real people
2013-10-28T20:09:31  <fungi> but ultimately i think there's very little sensitive about the vast majority of our groups
2013-10-28T20:09:35  <wenlock> yeah, *-core groups being visible makes perfect sense
2013-10-28T20:10:24  <wenlock> great, thanks
2013-10-28T20:10:45  <fungi> it's mostly that gerrit defaults to making group details and membership invisible unless you're a member of that group, but we override that for all of our automatically-generated groups these days
2013-10-28T20:11:32  *** hashar has joined #openstack-infra
2013-10-28T20:12:02  <wenlock> yeah... it was bugging me because when you add a group via ssh, if you try automating the make visible flag, there is no way to do it via api that i can see.  if you insert the entry into mysql, then gerrit will want a restart to make it visible.
2013-10-28T20:12:52  *** markmcclain has joined #openstack-infra
2013-10-28T20:13:11  <openstackgerrit> Anita Kuno proposed a change to openstack-infra/config: Create a seafile instance.  https://review.openstack.org/54030
2013-10-28T20:15:25  *** dprince has quit IRC
2013-10-28T20:15:29  *** julim has quit IRC
2013-10-28T20:21:15  *** changbl has quit IRC
2013-10-28T20:21:34  <fungi> wenlock: you want 'gerrit create-group --visible-to-all mynewgroup'
2013-10-28T20:21:57  <wenlock> fungi, awesome!
2013-10-28T20:22:04  *** jcoufal has quit IRC
2013-10-28T20:22:10  <wenlock> didn't even see that as an option...
2013-10-28T20:22:28  <fungi> wenlock: http://git.openstack.org/cgit/openstack-infra/gerritlib/tree/gerritlib/gerrit.py#n116
2013-10-28T20:22:57  <fungi> that's what we're calling from the manage-projects script in jeepyb
2013-10-28T20:23:01  <wenlock> perfect
2013-10-28T20:24:41  <sdague> jog0: +2 on your previous review request
2013-10-28T20:25:56  *** mrodden has quit IRC
2013-10-28T20:26:47  *** vipul has quit IRC
2013-10-28T20:27:40  *** vipul has joined #openstack-infra
2013-10-28T20:28:35  <wenlock> fungi, just tried it.  that works
2013-10-28T20:28:46  <wenlock> no server restart needed :D
2013-10-28T20:30:10  <fungi> crap, so the puppet refactoring for mysql in gerrit which i approved over the weekend seems to be having a puppet problem on review.o.o which did not manifest on review-dev
2013-10-28T20:31:20  <fungi> fix on the way
2013-10-28T20:32:00  <wenlock> hmm, i had looked at that over the weekend as well... it looked like an ok change.
2013-10-28T20:33:33  <fungi> for those playing along at home, the error is... "Could not retrieve catalog from remote server: Error 400 on SERVER: Invalid parameter mysql_password at /opt/config/production/modules/openstack_project/manifests/review.pp:171 on node review.openstack.org"
2013-10-28T20:33:43  *** dcramer_ has quit IRC
2013-10-28T20:33:49  *** sarob has quit IRC
2013-10-28T20:34:18  *** sarob has joined #openstack-infra
2013-10-28T20:34:40  <wenlock> ahh yes, we had forked that file, forgot to post on the forum that it broke us :P
2013-10-28T20:34:50  <wenlock> i mean irc
2013-10-28T20:36:54  *** changbl has joined #openstack-infra
2013-10-28T20:37:13  <clarkb> gerrit defaults to non visible groups. I think we just negelected to make them visible
2013-10-28T20:37:44  *** ericloo has joined #openstack-infra
2013-10-28T20:38:04  <wenlock> clarkb, so they should all be visible?  I mean the groups we create by hand per this site: http://ci.openstack.org/gerrit.html  (groups section)
2013-10-28T20:38:54  <clarkb> wenlock: I think so, there might be a small argument that Project Bootstrappers shouldn't be
2013-10-28T20:39:01  *** sarob has quit IRC
2013-10-28T20:39:07  *** denis_makogon has joined #openstack-infra
2013-10-28T20:39:45  <wenlock> clarkb: ok, cool.  i was improving my changes for gerrit server setup to bootstrap gerrit without doing all the manual setup
2013-10-28T20:40:56  *** changbl has quit IRC
2013-10-28T20:41:42  *** openstackgerrit has quit IRC
2013-10-28T20:41:58  *** openstackgerrit has joined #openstack-infra
2013-10-28T20:42:36  *** sarob has joined #openstack-infra
2013-10-28T20:44:10  <clarkb> sdague: I think we may need to sort out when to setup the workspace
2013-10-28T20:44:36  <clarkb> sdague: I think it needs to happen before the reexec in order to make sure the new d-g is abailable to reexec
2013-10-28T20:45:26  <clarkb> sdague: what if you put the branch selection and setup of new workspace before reexec?
2013-10-28T20:45:43  <clarkb> I think that gives us maximum coverage of the reexec testing
2013-10-28T20:45:58  *** davidhadas has joined #openstack-infra
2013-10-28T20:46:50  <openstackgerrit> Jeremy Stanley proposed a change to openstack-infra/config: Don't pass mysql passwords to project gerrit class  https://review.openstack.org/54177
2013-10-28T20:46:55  <fungi> clarkb: that could stand some ninja ^
2013-10-28T20:47:04  <clarkb> fungi: looking
2013-10-28T20:47:26  <fungi> it was correct in review_dev.pp but not in review.pp, so testing on review-dev didn't expose it
2013-10-28T20:47:43  <clarkb> fungi: how does review.o.o know its mysql info?
2013-10-28T20:48:06  <fungi> clarkb: up in the gerrit::mysql block
2013-10-28T20:48:45  <clarkb> fungi: gotcha
2013-10-28T20:48:57  <fungi> it's a brown bag fix from something which got missed in 6a2e31d
2013-10-28T20:49:04  <clarkb> fungi: lgtm, feel free to push through
2013-10-28T20:52:25  <openstackgerrit> A change was merged to openstack-infra/config: Don't pass mysql passwords to project gerrit class  https://review.openstack.org/54177
2013-10-28T20:52:34  <fungi> fwiw, that ^ got "tested" in production (applying it un-broke puppet on review.o.o)
2013-10-28T20:52:39  <clarkb> k
2013-10-28T20:52:42  <sdague> clarkb: ok, I thought you wanted me to move it up. I can move it back down to after the workspaces
2013-10-28T20:52:42  <clarkb> I figured you had done that
2013-10-28T20:52:51  <clarkb> sdague: I think we need something in the middle
2013-10-28T20:53:18  <clarkb> sdague: we want the section that reexecs to happen as early as possible, but it must happen after the new workspace is configured
2013-10-28T20:54:12  <fungi> basically anything which runs before the reexec is not self-tested
2013-10-28T20:54:43  <sdague> ok
2013-10-28T20:55:24  *** luhrs1 has joined #openstack-infra
2013-10-28T20:55:27  <clarkb> there may be some way to just deal with d-g repo first then check reexec then setup workspaces proper
2013-10-28T20:55:33  <clarkb> do something like gerrit git prep just for d-g
2013-10-28T20:56:07  *** moted_ has joined #openstack-infra
2013-10-28T20:56:14  *** hashar_ has joined #openstack-infra
2013-10-28T20:56:23  <ArxCruz> fungi: https://review.openstack.org/#/c/54160/ i believe the failure in gate-config-layout it's because I move the devstack-gate jobs is it possible to you verify ? I remove all the blank and tabs spaces :)
2013-10-28T20:57:02  <fungi> ArxCruz: in a bit. i have to cook dinner but i'll try to look while i do so
2013-10-28T20:57:07  *** ^d has quit IRC
2013-10-28T20:57:20  *** hashar has quit IRC
2013-10-28T20:57:21  *** moted has quit IRC
2013-10-28T20:57:21  *** hashar_ is now known as hashar
2013-10-28T20:57:23  *** moted_ is now known as moted
2013-10-28T20:57:34  *** che-arne has quit IRC
2013-10-28T20:58:26  <ArxCruz> fungi: take your time :)
2013-10-28T20:59:56  *** aspiers has joined #openstack-infra
2013-10-28T21:00:27  <sdague> clarkb: so, in patchset 9 - https://review.openstack.org/#/c/53940/9/devstack-vm-gate-wrap.sh I had this down after the workspace setup
2013-10-28T21:00:35  <sdague> just go back to that?
2013-10-28T21:01:38  *** ^d has joined #openstack-infra
2013-10-28T21:02:16  *** changbl has joined #openstack-infra
2013-10-28T21:02:23  <clarkb> ArxCruz: fungi: why do shell scripts in jenkins jobs need to know where ZUUL is located? I think it might be better to supply that info from zuul itself
2013-10-28T21:02:29  <clarkb> sdague: we can go back to that, it would nice if there is something in between that we can do
2013-10-28T21:03:03  *** Ajaeger1 has joined #openstack-infra
2013-10-28T21:03:06  <sdague> ok, let's start there, and we can make it better later
2013-10-28T21:03:06  <clarkb> sdague: do the bare minimum to sort out branches, then setup workspace/new, check reexec then setup workspace old
2013-10-28T21:03:11  <ArxCruz> clarkb: oh...
2013-10-28T21:03:30  <sdague> clarkb: so what's the concern on setting up workspace old before it?
2013-10-28T21:03:41  <clarkb> ArxCruz: it might need a patch to zuul to do that, but I think since zuul is driving the whole thing it can just inject that into the build parameter list
2013-10-28T21:03:43  <ArxCruz> clarkb: thanks for make a lot of ctrl+c ctrl+v useless
2013-10-28T21:03:48  <sdague> just that it's slow?
2013-10-28T21:03:54  <ArxCruz> :)
2013-10-28T21:03:58  *** mrodden has joined #openstack-infra
2013-10-28T21:04:08  <clarkb> sdague: no, changes to d-g won't be self tested on their ability to setup workspace old
2013-10-28T21:04:26  <ArxCruz> clarkb: yes, zuul is better, I didn't though that
2013-10-28T21:04:27  <fungi> ArxCruz: yes, i think you're right about the failing layout and comparison jobs... they'd need extra intelligence to deal with one of the config files being a puppet template
2013-10-28T21:04:51  <fungi> ArxCruz: clarkb: and yes, if we can supply that from zuul directly, all the better
2013-10-28T21:04:52  <ArxCruz> clarkb: but zuul send ZUUL_URL info ?
2013-10-28T21:05:20  <fungi> didn't even think of that earlier when discussing it with ArxCruz and mordred
2013-10-28T21:05:31  <clarkb> ArxCruz: yeah, zuul is triggering these jobs and injecting environment variables, rather than pass that data through in weird third party places, just do it directly
2013-10-28T21:05:52  <Ajaeger1> infra team, we're splitting up the install guide and I would love some good review on this patch https://review.openstack.org/54076, please
2013-10-28T21:05:53  <clarkb> then you can point at different zuuls without any configuration changes
2013-10-28T21:06:00  <sdague> clarkb: ok, so what we really need is devstack-gate setting itself up independently, ok, let me slice this again.
2013-10-28T21:06:12  <clarkb> sdague: ya that would be the proper fix
2013-10-28T21:06:23  <clarkb> sdague: fwiw if that is terrible I am fine doing what patchset 9 did for now
2013-10-28T21:07:08  <ArxCruz> clarkb: so, if pass ZUUL_URL in zuul, it will export the variable correctly without the need of changes in jjb ?
2013-10-28T21:07:22  <sdague> so, honestly, I think the proper fix requires a lot more refactoring of setup_workspace so that it can take a project as a param
2013-10-28T21:07:54  <sdague> so I think, given that we wedged ourself this morning on a novaclient change, I'd like to get the patch 9 version moving forward now
2013-10-28T21:08:14  <clarkb> ArxCruz: correct if you look at https://jenkins02.openstack.org/job/check-tempest-devstack-vm-full/3598/parameters/? you see there are parameters that are being directly passed into the job from zuul
2013-10-28T21:08:15  <sdague> because we have real possible breaks happening. Then we do this right later.
2013-10-28T21:08:35  *** beagles has quit IRC
2013-10-28T21:08:39  *** thomasem has quit IRC
2013-10-28T21:08:46  <ArxCruz> clarkb: okay, cool
2013-10-28T21:08:50  <clarkb> sdague: sounds good to me, sorry I didn't fully grasp why it was moved initially. Want to push up a thing with the other fix in patchset 10 that is otherwise patchset 9?
2013-10-28T21:09:15  <ArxCruz> fungi: so, can I just abandon https://review.openstack.org/#/c/54160/ ?
2013-10-28T21:09:25  *** yamahata has quit IRC
2013-10-28T21:09:51  <fungi> ArxCruz: yeah, there is definitely a better, more elegant way
2013-10-28T21:09:57  *** yamahata has joined #openstack-infra
2013-10-28T21:09:58  <ArxCruz> :)
2013-10-28T21:10:45  <ArxCruz> okay, hacking zuul now...
2013-10-28T21:11:15  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: Let us gate grenade forward  https://review.openstack.org/53940
2013-10-28T21:11:27  <sdague> clarkb: yeh, I split it a little bit to do the old setup after
2013-10-28T21:11:41  <sdague> and left a big comment
2013-10-28T21:13:14  <sdague> clarkb: also, per previous question, that's sitting on top of 2 refactoring clean ups. Would be good to know if you are good with those as well, as I think it would be good to get this whole series in soon, so we can actually land the havana => master grenade changes, then get that switched on
2013-10-28T21:13:45  *** beagles has joined #openstack-infra
2013-10-28T21:14:30  *** misterpink has joined #openstack-infra
2013-10-28T21:15:07  *** misterpink has quit IRC
2013-10-28T21:18:25  *** misterpink has joined #openstack-infra
2013-10-28T21:19:12  *** fbo_away is now known as fbo
2013-10-28T21:19:51  <zul> i think we should turn on the gate for py3 for cinderclient/novaclient
2013-10-28T21:21:09  <clarkb> zul: It should be on for novaclient
2013-10-28T21:21:34  <zul> sweet
2013-10-28T21:24:26  <clarkb> zul: but we should do cinderclient too if it is ready
2013-10-28T21:25:33  *** dcramer_ has joined #openstack-infra
2013-10-28T21:25:36  <zul> clarkb:  its ready ill do it tonight
2013-10-28T21:28:46  *** mrodden1 has joined #openstack-infra
2013-10-28T21:30:52  *** jhesketh has joined #openstack-infra
2013-10-28T21:31:13  *** mrodden has quit IRC
2013-10-28T21:32:11  *** alcabrera has quit IRC
2013-10-28T21:34:29  *** dkranz has quit IRC
2013-10-28T21:41:33  <fungi> jgriffith: python-cinderclient works and passes tests on python 3.3 now?
2013-10-28T21:41:40  <fungi> zul: that's awesome news, btw
2013-10-28T21:41:41  <clarkb> jog0: sdague: do we expect py33 and pypi tests to not pass for hacking https://review.openstack.org/#/c/54165/1 I ask because novaclient and soon cinderclient are gating on py33 and while flake8 isn't run on them with py33 it isn't far fetched that someone may try that
2013-10-28T21:41:53  *** ruhe has joined #openstack-infra
2013-10-28T21:42:43  <fungi> i thought they did pass at one point and then regressed?
2013-10-28T21:42:58  <clarkb> yeah I think that may be what happened, just checking that it is ok
2013-10-28T21:43:01  *** mriedem has quit IRC
2013-10-28T21:43:04  * fungi could be misremembering
2013-10-28T21:43:04  *** ruhe has quit IRC
2013-10-28T21:43:57  <fungi> it's past beer-o'clock here now, so my memory is increasing in fuzziness
2013-10-28T21:44:19  <fungi> well, technically sak-o'clocky but who's counting?
2013-10-28T21:44:27  *** justinabrahms has quit IRC
2013-10-28T21:44:51  *** thomasem has joined #openstack-infra
2013-10-28T21:45:09  *** thomasem has quit IRC
2013-10-28T21:45:32  *** luhrs1 has quit IRC
2013-10-28T21:45:34  *** thomasem has joined #openstack-infra
2013-10-28T21:46:28  *** justinlilly has joined #openstack-infra
2013-10-28T21:46:57  *** che-arne has joined #openstack-infra
2013-10-28T21:47:11  *** justinlilly is now known as justinabrahms
2013-10-28T21:47:37  *** rakhmerov has quit IRC
2013-10-28T21:52:04  *** justinabrahms has quit IRC
2013-10-28T21:52:53  *** pcm_ has quit IRC
2013-10-28T21:53:08  <openstackgerrit> Arx Cruz proposed a change to openstack-infra/zuul: Add the possibility to pass the zuul url  https://review.openstack.org/54196
2013-10-28T21:53:18  <Ajaeger1> fungi, I can only offer virtual beers and will throw a virtual round for reviews ;) - but it's really good German beer ;)
2013-10-28T21:53:39  <ArxCruz> clarkb: fungi I think I did it right now ^
2013-10-28T21:53:54  *** slong has joined #openstack-infra
2013-10-28T21:54:01  <fungi> Ajaeger1: if it comes in liter steins, i'll start looking for plane tickets ;)
2013-10-28T21:54:21  <fungi> ArxCruz: lookin'
2013-10-28T21:54:30  <Ajaeger1> :)
2013-10-28T21:54:39  *** dcramer_ has quit IRC
2013-10-28T21:55:52  <SpamapS> fungi: did anything ever come of the pbr bug noted this morning?
2013-10-28T21:56:57  *** weshay has quit IRC
2013-10-28T21:57:35  <clarkb> ArxCruz: that change looks good to me other than the pep8 failure
2013-10-28T21:57:36  <fungi> SpamapS: we... think? it's trove-setup-specific?
2013-10-28T21:57:44  *** Ajaeger1 has quit IRC
2013-10-28T21:57:55  <fungi> SpamapS: were you able to recreate it by installing via pip?
2013-10-28T21:59:04  <ArxCruz> clarkb: it's really annoying these blank lines
2013-10-28T21:59:04  <fungi> neither mordred nor i had any luck coming up with a trivial test case to cause that error (note: redstack mysql kickstart doesn't count as "trivial")
2013-10-28T21:59:04  *** esker has quit IRC
2013-10-28T21:59:42  <anteaya> I feel soiled having to type the code I have to type. like being forced 2 tp lik ts
2013-10-28T21:59:47  <anteaya> *shudder*
2013-10-28T21:59:54  <openstackgerrit> Arx Cruz proposed a change to openstack-infra/zuul: Add the possibility to pass the zuul url  https://review.openstack.org/54196
2013-10-28T22:00:16  <clarkb> anteaya: huh? did you end up in AIM land?
2013-10-28T22:00:25  <anteaya> ew
2013-10-28T22:00:29  <fungi> i thought her keyboard started rebelling
2013-10-28T22:00:43  <anteaya> reading how to puppet downloading and unpacking a tarball
2013-10-28T22:00:58  <anteaya> sometime (rarely, but sometimes) I wish I drank
2013-10-28T22:01:16  <anteaya> the last time was when I had to take a live squirrel out of the wall
2013-10-28T22:01:24  <anteaya> this is another one
2013-10-28T22:01:30  <fungi> anteaya: sometimes the computers do respond more favorably to beer
2013-10-28T22:01:42  <anteaya> I'll pour beer on my keyboard
2013-10-28T22:02:09  <SpamapS> fungi: https://bugs.launchpad.net/ubuntu/+source/python-pbr/+bug/1245676
2013-10-28T22:02:28  <fungi> it looked like seafile had instructions for building/installing from source, but it did require some additional dependencies be installed on the system
2013-10-28T22:02:49  <anteaya> would that be easier than the tarball?
2013-10-28T22:03:08  <anteaya> I would still have to download and unpack something, get it in the right directory
2013-10-28T22:03:18  <anteaya> use the exec {} resource
2013-10-28T22:03:20  <anteaya> would I not?
2013-10-28T22:03:37  <fungi> SpamapS: that looks a lot more specific--thanks
2013-10-28T22:04:06  <fungi> anteaya: in that situation we at least have examples of doing that via the vcsrepo module
2013-10-28T22:04:07  <SpamapS> fungi: np, thank andrew_plunk though. :)
2013-10-28T22:04:28  <anteaya> fungi I saw vcsrepo usage for git cloning
2013-10-28T22:04:35  <fungi> SpamapS: well, i'm thanking you for bringing it to my attention sooner than i got back around to that maildir
2013-10-28T22:04:37  <anteaya> does it work with tarballs as well?
2013-10-28T22:04:41  <anteaya> I'll look
2013-10-28T22:04:48  *** ^d has quit IRC
2013-10-28T22:04:52  *** andrew_plunk has joined #openstack-infra
2013-10-28T22:05:02  <anteaya> all hail andrew_plunk
2013-10-28T22:05:06  <SpamapS> fungi: thank you fungi, thank you #openstack-infra.. thank you, thank you, thank you-ooo-ooo</alanis>
2013-10-28T22:05:14  <andrew_plunk> ahaha hello
2013-10-28T22:05:17  *** ^d has joined #openstack-infra
2013-10-28T22:05:21  <fungi> anteaya: you'd use it to clone their git repository and then follow their installation from source instructions (but write a script to encode them)
2013-10-28T22:05:33  <clarkb> anteaya: there are a couple of archive puppet modules on puppet forge that look like they may make the situation more san
2013-10-28T22:05:36  <anteaya> okay, let me try that
2013-10-28T22:05:37  <clarkb> *sane
2013-10-28T22:05:48  <fungi> andrew_plunk: many thanks for responsible and detailed bug reporting!
2013-10-28T22:05:59  <anteaya> clarkb: the puppet forge modules are named archive?
2013-10-28T22:06:08  <andrew_plunk> np fungi: I was just trying to follow the instructions on launchpad
2013-10-28T22:06:30  <anteaya> all hail andrew_plunk's responsible and detailed bug reporting
2013-10-28T22:06:52  <anteaya> I haven't read it yet myself, I'm trusting fungi's judgment here
2013-10-28T22:06:58  <andrew_plunk> ahaha
2013-10-28T22:07:05  *** ^d has quit IRC
2013-10-28T22:07:14  * anteaya reads the andrew_plunk bug report
2013-10-28T22:08:17  * anteaya nods agreement with fungi's original assessment
2013-10-28T22:08:31  <fungi> i'm reading through it now, but it has a full transcript of pip install failure for pbr
2013-10-28T22:08:38  *** thomasem has quit IRC
2013-10-28T22:08:56  <fungi> looks vaguely like a pypi problem...
2013-10-28T22:09:39  * anteaya goes back to puppet examples
2013-10-28T22:09:41  <anteaya> sigh
2013-10-28T22:09:47  <ArxCruz> clarkb: fungi jenkins gave the +1 so if you guys don't mind, go there and gave your blessings :D
2013-10-28T22:10:13  <fungi> ArxCruz: did that work on your systems? (just curious)
2013-10-28T22:10:41  <ArxCruz> fungi: I'm still waiting some job who uses that :/
2013-10-28T22:10:59  <ArxCruz> unless there's a way to force the job
2013-10-28T22:12:51  *** ^d has joined #openstack-infra
2013-10-28T22:12:52  *** ^d has joined #openstack-infra
2013-10-28T22:13:05  <sdague> ok, time to head home for the night - d-g changes: https://review.openstack.org/#/c/54132/, https://review.openstack.org/#/c/54133/, https://review.openstack.org/#/c/53940/ are needed to get grenade actually working on havana (and set up the forward grenade upgrades)
2013-10-28T22:13:54  <sdague> the above would have prevented the python-novaclient wedge this morning (which I assume is going to be reproposed as soon as someone realizes we reverted them)
2013-10-28T22:14:15  <fungi> heh. it'll make an excellent test ;)
2013-10-28T22:14:18  *** senk1 has joined #openstack-infra
2013-10-28T22:14:21  <sdague> https://review.openstack.org/#/c/53739/ - is d-g protection from tempest being able to wedge the world if we aren't up to date on requirements
2013-10-28T22:14:24  *** lnxnut_ has joined #openstack-infra
2013-10-28T22:14:32  *** andrew_plunk has quit IRC
2013-10-28T22:14:39  <sdague> fungi: yep, that was going to be my first test after that's merged, revert the revert
2013-10-28T22:14:51  <anteaya> clarkb: what are the names of the puppet modules to which you refer?
2013-10-28T22:15:06  <anteaya> so far I haven't seen them myself
2013-10-28T22:16:42  *** dkliban has joined #openstack-infra
2013-10-28T22:17:19  <jog0> clarkb: fungi is correct, pypi  passed but there was a regression
2013-10-28T22:18:04  <jog0> clarkb: I agree both should pass, just waiting for someone to pick it up
2013-10-28T22:18:05  *** lnxnut has quit IRC
2013-10-28T22:18:08  *** rakhmerov has joined #openstack-infra
2013-10-28T22:18:16  *** rcleere has quit IRC
2013-10-28T22:19:42  *** senk1 has quit IRC
2013-10-28T22:20:33  <clarkb> anteaya: something/archive. it looks like there are several of them
2013-10-28T22:20:37  <clarkb> probably all forks of each other
2013-10-28T22:20:43  <anteaya> k thanks
2013-10-28T22:21:52  <anteaya> looks worth a look: http://forge.puppetlabs.com/smarchive/archive
2013-10-28T22:22:00  <anteaya> appears to be worth a look
2013-10-28T22:22:08  <anteaya> or look, look, look
2013-10-28T22:24:19  <anteaya> it is moved to here: https://github.com/gini/puppet-archive
2013-10-28T22:25:01  <anteaya> so would the module be called smarachive/archive still or gini/archive, I wonder?
2013-10-28T22:25:32  <anteaya> gini
2013-10-28T22:25:41  *** rakhmerov has quit IRC
2013-10-28T22:26:12  *** senk has joined #openstack-infra
2013-10-28T22:26:32  <openstackgerrit> Clark Boylan proposed a change to openstack-infra/elastic-recheck: Better end of console log indexing detection.  https://review.openstack.org/53487
2013-10-28T22:26:35  *** UtahDave has quit IRC
2013-10-28T22:27:51  <jog0> clarkb: I will respin 54165 because of the H903 typo
2013-10-28T22:27:55  <clarkb> jog0: ok
2013-10-28T22:28:24  <clarkb> 53487 has been rebased on sdague's e-r changes. I still haven't quite tested it, but left a comment in the review about testing (want ot make sure I set up the functional tests properly)
2013-10-28T22:28:47  *** beagles has quit IRC
2013-10-28T22:29:03  *** senk1 has joined #openstack-infra
2013-10-28T22:30:02  <lifeless> mordred: so, changelog and pbr
2013-10-28T22:30:29  *** senk has quit IRC
2013-10-28T22:30:32  <openstackgerrit> Joe Gordon proposed a change to openstack-dev/hacking: Continue reserving H6xx namespace for calling methods  https://review.openstack.org/54165
2013-10-28T22:31:37  *** jerryz has joined #openstack-infra
2013-10-28T22:33:25  *** prad_ has quit IRC
2013-10-28T22:38:20  <openstackgerrit> A change was merged to openstack-infra/jenkins-job-builder: Make --delete-old more robust  https://review.openstack.org/52262
2013-10-28T22:38:42  *** hashar has quit IRC
2013-10-28T22:41:00  *** datsun180b has quit IRC
2013-10-28T22:43:26  *** dims has quit IRC
2013-10-28T22:44:57  *** adalbas has quit IRC
2013-10-28T22:45:21  <harlowja> btw, bumped https://pypi.python.org/pypi/gerrit-view with czuul , comments/feedback welcome
2013-10-28T22:45:36  <harlowja> https://github.com/harlowja/gerrit_view/#czuul (screenshot there)
2013-10-28T22:49:07  <clarkb> fungi: don't let me forget but we should sort out the puppet running on puppetmaster stuff this week as it may make applying keys or removing them summit time interesting
2013-10-28T22:51:40  <fungi> clarkb: very good point (i have a pending change i need to push for that myself tonight too)
2013-10-28T22:52:16  <fungi> harlowja: i did actually start playing around with it last night, but no feedback yet
2013-10-28T22:52:20  <harlowja> np
2013-10-28T22:52:23  <harlowja> its pretty basic, ha
2013-10-28T22:52:57  <fungi> i tend to work in traditional 80x25 terminals (yay greenscreen nostalgia), so some of it seemed a bit cramped
2013-10-28T22:52:57  <clarkb> fungi: yeah I need to push one too
2013-10-28T22:53:15  <harlowja> hmmm, ya the 25 part is tough
2013-10-28T22:53:20  <harlowja> only so much u can do with 25 :-P
2013-10-28T22:53:59  * fungi does a lot in 25 lines x a dozen terminals on his monitor, but yeah, understood
2013-10-28T22:54:20  <harlowja> actually just checked, mine is 156x28, so i guess not that much diff
2013-10-28T22:54:20  <harlowja> ha
2013-10-28T22:54:51  *** lnxnut_ has quit IRC
2013-10-28T22:55:25  *** lnxnut has joined #openstack-infra
2013-10-28T22:55:29  <sdague> clarkb: on this - https://review.openstack.org/#/c/53487/2 - that's matching success runs as well now right? that intentional?
2013-10-28T22:55:51  *** dims has joined #openstack-infra
2013-10-28T22:56:30  <clarkb> sdague: no, I should add a filter on build_status, thanks
2013-10-28T22:56:46  <sdague> yep, that should do it
2013-10-28T22:56:49  <clarkb> sdague: basically need something that happens at the end of every console log and the line where it copies itself works
2013-10-28T22:56:55  <clarkb> but I should filter on build_status
2013-10-28T22:57:44  <sdague> yep
2013-10-28T22:58:00  <sdague> heh, I should go -1 it and leave the feedback there as well :)
2013-10-28T22:59:26  *** lnxnut has quit IRC
2013-10-28T22:59:35  *** DennyZhang has joined #openstack-infra
2013-10-28T22:59:57  <openstackgerrit> Clark Boylan proposed a change to openstack-infra/elastic-recheck: Better end of console log indexing detection.  https://review.openstack.org/53487
2013-10-28T23:00:01  <clarkb> sdague: ^ that should fix it
2013-10-28T23:00:06  <clarkb> thanks
2013-10-28T23:02:20  *** sarob_ has joined #openstack-infra
2013-10-28T23:02:25  <sdague> +2
2013-10-28T23:02:46  *** sarob_ has quit IRC
2013-10-28T23:02:58  *** DennyZhang has quit IRC
2013-10-28T23:03:11  *** senk1 has quit IRC
2013-10-28T23:03:16  *** sarob_ has joined #openstack-infra
2013-10-28T23:06:19  *** sarob has quit IRC
2013-10-28T23:07:28  *** sarob_ has quit IRC
2013-10-28T23:10:01  <lifeless> clarkb: your https://review.openstack.org/#/c/52689/ has inventory :)
2013-10-28T23:10:18  <clarkb> lifeless: thanks
2013-10-28T23:11:17  *** dkliban has quit IRC
2013-10-28T23:12:27  <openstackgerrit> Adrian Otto proposed a change to openstack-infra/config: Adding project Solum to StackForge  https://review.openstack.org/53151
2013-10-28T23:13:25  <clarkb> lifeless: fwiw the file specific comments are common around these parts
2013-10-28T23:13:55  <openstackgerrit> Anita Kuno proposed a change to openstack-infra/config: Create a seafile instance.  https://review.openstack.org/54030
2013-10-28T23:14:13  <lifeless> clarkb: -infra ?
2013-10-28T23:14:17  <clarkb> lifeless: yes
2013-10-28T23:14:48  <lifeless> clarkb: huh, well up to you guys :)
2013-10-28T23:15:05  <clarkb> the other thing should defnitely be fixed though
2013-10-28T23:15:24  <lifeless> clarkb: with the focus on one-concept changes and why-over-what, I don't think anyone else feels the need for per-file-comments.
2013-10-28T23:15:27  <lifeless> but shrug
2013-10-28T23:15:34  <lifeless> clarkb: also a test, I realised I hadn't asked for one.
2013-10-28T23:15:55  <clarkb> lifeless: that captures why and what
2013-10-28T23:16:34  <lifeless> clarkb: right, I know you did :)
2013-10-28T23:16:41  <lifeless> clarkb: if you haven't I would have also whined about hat
2013-10-28T23:16:43  <lifeless> s/hat/that/
2013-10-28T23:17:12  <clarkb> also test, good point (I whipped the change up after dealing with the issue as a way to remind myself to make it so, I should add a test now)
2013-10-28T23:17:54  *** ^d has quit IRC
2013-10-28T23:21:04  <jerryz> clarkb: i see in the code that e-r queries elastic search based on change id and patch id. but if i use recheck to trigger a second build if the first fails due to a known bug, e-r will comment with two bugs if the second build fails due to a different known bug.
2013-10-28T23:22:25  *** oubiwann has quit IRC
2013-10-28T23:22:40  <jerryz> clarkb: is this  by design or could build uuid be part of the query?
2013-10-28T23:23:12  *** rakhmerov has joined #openstack-infra
2013-10-28T23:23:23  <clarkb> jerryz: build_uuid should be part of the query
2013-10-28T23:23:40  <clarkb> jerryz: or log_url which includes part of the build_uuid
2013-10-28T23:24:03  <openstackgerrit> Anita Kuno proposed a change to openstack-infra/config: Create a seafile instance.  https://review.openstack.org/54030
2013-10-28T23:24:17  <reed> guys, is the sched for the DEsign Summit sessions ready?
2013-10-28T23:24:52  <openstackgerrit> Adrian Otto proposed a change to openstack-infra/config: Adding project Solum to StackForge  https://review.openstack.org/53151
2013-10-28T23:25:04  <jerryz> clarkb:     def classify(self, change_number, patch_number, comment):
2013-10-28T23:25:06  <clarkb> reed: I think the schedule for infra is ready, not sure about the other projects
2013-10-28T23:25:15  <clarkb> jerryz: comment is the magic bit that includes the uuid
2013-10-28T23:25:39  *** hashar has joined #openstack-infra
2013-10-28T23:26:05  <anteaya> hey hot and rainy in hk next week
2013-10-28T23:26:18  <reed> clarkb, thanks
2013-10-28T23:26:19  <clarkb> woot
2013-10-28T23:27:00  <pleia2> reed: I am both amused and depressed by your sched tweets today (I feel your pain)
2013-10-28T23:27:16  <pleia2> reed: if you do find an ical integration mechanism, you'll be my bff
2013-10-28T23:27:22  <jerryz> clarkb: i don't quit understand. uuid is a part of the comment for jenkins log_url
2013-10-28T23:27:28  *** rakhmerov has quit IRC
2013-10-28T23:27:36  <jerryz> clarkb: but not part of the elastic-recheck comment
2013-10-28T23:28:04  <reed> pleia2, unfortunately I found no way without loosing the possibility to sync the actual source of data
2013-10-28T23:28:11  <clarkb> jerryz: if you look at the mechanism around that comment variable it is checking that the log_url left in the gerrit comment by zuul/jenkins matches the log_url in elasticsearch
2013-10-28T23:28:14  <pleia2> reed: sigh
2013-10-28T23:28:34  <openstackgerrit> Anita Kuno proposed a change to openstack-infra/config: Create a seafile instance.  https://review.openstack.org/54030
2013-10-28T23:28:50  <reed> pleia2, even with how Sched suggests to operate (add the personal calendar to google), google pulls only once a day
2013-10-28T23:29:07  *** cyeoh_ is now known as cyeoh
2013-10-28T23:29:09  <reed> my owncloud server cannot import an .ics
2013-10-28T23:29:15  <pleia2> ah
2013-10-28T23:29:27  <anteaya> what version of owncloud are you on, reed?
2013-10-28T23:29:40  <reed> I can put it in Thunderbird but then it sits there... useless, as I need it on my phone
2013-10-28T23:29:44  <reed> anteaya, let me check
2013-10-28T23:29:49  <anteaya> k
2013-10-28T23:30:56  <reed> anteaya, 5 something
2013-10-28T23:31:02  <anteaya> okay
2013-10-28T23:31:13  <anteaya> yeah I was on 5 something too
2013-10-28T23:31:23  <anteaya> 5.0.12 is latest stable
2013-10-28T23:31:29  <anteaya> then 6 alpha
2013-10-28T23:31:41  <anteaya> I was on 5.04
2013-10-28T23:31:42  <reed> honestly, I am starting to think that it messes up with the calendars
2013-10-28T23:31:44  <anteaya> 5.0.4
2013-10-28T23:31:56  <reed> hard to diagnose though as my brain may be as buggy
2013-10-28T23:31:58  <clarkb> lifeless: I think I may need to bug jeblair about testing that change. It looks like TestScheduler overrides zuul.merger's init mechanism
2013-10-28T23:32:06  <anteaya> we I'm pounding away on seafile now, we had better all like seafile
2013-10-28T23:32:13  <clarkb> lifeless: not sure if that should be torn out or if we need to do something more silly
2013-10-28T23:32:14  <pleia2> I'll probably just end up using the sched inteface again on my tablet, hope for the best with things on my other calendar (whatever, people know I'm traveling, I can miss things :))
2013-10-28T23:32:25  <clarkb> lifeless: but I definitely think we should have a test (as my discovery shows)
2013-10-28T23:32:45  <reed> anteaya, trying to update... it fails with no discernible error
2013-10-28T23:33:01  <clarkb> reed: clearly the solution is printouts
2013-10-28T23:33:10  <anteaya> yeah, I couldn't update owncloud from the admin page on owncloud either
2013-10-28T23:33:12  <clarkb> reed: I am probably going to print out a schedule just beacuse
2013-10-28T23:33:16  *** dcramer_ has joined #openstack-infra
2013-10-28T23:33:17  <jerryz> clarkb: this is what i see in the debug log about the query: Making a request equivalent to this: curl -XGET 'http://10.145.81.231:9200/_search?size=10' -d '{"sort": {"@timestamp": {"order": "desc"}}, "query": {"query_string": {"query": "( @message:\" 503\" OR message:\" 503\" ) AND filename:\"logs/syslog.txt\" AND syslog_program:\"proxy-server\"\n AND build_change:\"34951\" AND build_patchset:\"1\""}}}'
2013-10-28T23:33:19  <reed> clarkb, why didn't I think of that? :)
2013-10-28T23:33:22  <anteaya> never updated, no output
2013-10-28T23:33:25  *** b3nt_pin has joined #openstack-infra
2013-10-28T23:33:47  <reed> clarkb, unfortunately not a solution for me: I need to be able to see in *one* place all of my appointments
2013-10-28T23:33:57  <clarkb> jerryz: right, the matching happens in e-r (it can probably be done in elasticsearch proper but isn't today)
2013-10-28T23:34:09  <reed> sessions I *have to* be in and personal meetings
2013-10-28T23:34:13  <clarkb> reed: ah
2013-10-28T23:34:17  <reed> if things are not on my calendar they don't happen
2013-10-28T23:34:23  <clarkb> yeah if you have more than just sessions to juggle then printouts will be hard
2013-10-28T23:34:42  <reed> and given that walking from one side to another in HK may take as long as 15 minutes...
2013-10-28T23:34:55  <fungi> reed: clarkb: my solution is a text file with a list of where i intend to go when ;)
2013-10-28T23:35:04  <reed> I need to have a very *solid* system or I'll miss lots of meetings
2013-10-28T23:35:37  <fungi> granted, my text file doesn't beep at me to let me know when something is coming up
2013-10-28T23:35:46  <clarkb> fungi: you'll be surprised at how hard it is to edit a simple txt file on chromeos. It is the biggest flaw so far
2013-10-28T23:35:51  <reed> fungi, a paper agenda would work too... but it doesn't ring to remind me to get the hell out of the meeting and run to a session
2013-10-28T23:35:55  <reed> or viceversa :)
2013-10-28T23:36:05  <reed> i don't like to trust my brain
2013-10-28T23:36:10  <clarkb> like seriously how hard can it be to expose the vi(m) that must be on the system
2013-10-28T23:36:56  <reed> clarkb, are you taking a disposable chrome os?
2013-10-28T23:37:03  <clarkb> reed: yup
2013-10-28T23:37:10  <reed> damn, you paranoid
2013-10-28T23:37:20  <fungi> that would risk exposing ways to risk rooting and installing of non-googOS[TM]
2013-10-28T23:37:28  <reed> now you make me feel like I'll be out there like naked in the snow
2013-10-28T23:37:41  <clarkb> well "disposable" I am not super paranoid about it but need a light machine with good battery life that isn't completely insecure
2013-10-28T23:38:11  <fungi> clarkb: i'm bringing tamper-evident evidence bags, evidence-tape and foil stickers, in case you want to partake (i'll have plenty to go around)
2013-10-28T23:38:13  <reed> clarkb, did you have to sign your soul to google to use it?
2013-10-28T23:38:20  <clarkb> reed: yes
2013-10-28T23:38:28  *** SergeyLukjanov is now known as _SergeyLukjanov
2013-10-28T23:38:31  <reed> clarkb, good :)
2013-10-28T23:38:38  * reed feels better now
2013-10-28T23:38:39  <clarkb> none of my other machiens have secure boot
2013-10-28T23:38:43  <fungi> good for when you don't trust the hotel room safe and want to leave your disposable hardware while you dine
2013-10-28T23:38:51  <clarkb> which is sort of necessary to trust disk encryption
2013-10-28T23:38:51  <reed> fungi, geez
2013-10-28T23:38:58  *** _SergeyLukjanov has quit IRC
2013-10-28T23:39:07  <reed> they can tamper your laptops once they stole it :)
2013-10-28T23:39:08  <clarkb> fungi: nice, I may have to partake
2013-10-28T23:39:19  *** dcramer_ has quit IRC
2013-10-28T23:39:31  <fungi> reed: if they steal it, good riddance. i just want to know if they try to put it back after
2013-10-28T23:39:33  <anteaya> my syntax is okay with puppet lint and that is all I can do tonight, I still haven't run it, if anyone has a boatload of spare time and can't wait to give me the benefit of their time, I welcome your comments or I'll just keep on it tomorrow
2013-10-28T23:39:40  <reed> :)
2013-10-28T23:39:41  <anteaya> https://review.openstack.org/#/c/54030/18
2013-10-28T23:40:21  <clarkb> reed: it has a decent IPS display which makes me want an IPS display on everything now
2013-10-28T23:40:29  <reed> seafile seems interesting... does it store files in swift or just git?
2013-10-28T23:40:35  <clarkb> and ~6 hour battery life which is about 4 hours better than the alternatives
2013-10-28T23:40:48  <anteaya> storage on the my beta is mysql
2013-10-28T23:40:54  *** mrodden1 has quit IRC
2013-10-28T23:40:58  <reed> wikipedia:IPS_display
2013-10-28T23:40:58  <anteaya> we are going for trove once it is up
2013-10-28T23:41:29  <reed> anteaya, it stores files in mysql?
2013-10-28T23:41:40  <anteaya> it doesn't use swift
2013-10-28T23:41:51  <anteaya> mysql was the only db I set up for the beta installs
2013-10-28T23:42:02  *** jergerber has quit IRC
2013-10-28T23:42:49  <reed> i became a big fan of sshuttle over the weekend: looks like it works on my wife's mac os too
2013-10-28T23:43:20  <reed> so very simple ssh sessions in different datacenters will give me VPN tunnels easily
2013-10-28T23:43:21  *** nati_uen_ has joined #openstack-infra
2013-10-28T23:43:46  *** jhesketh_ has joined #openstack-infra
2013-10-28T23:43:48  <reed> on different ports, too... very easy, no need to mess up with openvpn or ipsec
2013-10-28T23:45:35  *** jhesketh has quit IRC
2013-10-28T23:45:49  <clarkb> reed: fwiw I would not use a chromebook for daily use
2013-10-28T23:45:57  *** b3nt_pin is now known as beagles
2013-10-28T23:45:59  <clarkb> but as a travel device it seems decent
2013-10-28T23:46:38  *** nati_ueno has quit IRC
2013-10-28T23:47:15  *** beagles has quit IRC
2013-10-28T23:47:23  *** yamahata has quit IRC
2013-10-28T23:47:48  *** denis_makogon has quit IRC
2013-10-28T23:47:57  <fungi> i like traveling with a cheap netbook. bonus is i'm not stuck with teh googolz
2013-10-28T23:48:01  *** b3nt_pin has joined #openstack-infra
2013-10-28T23:48:15  *** b3nt_pin is now known as beagles
2013-10-28T23:48:49  *** SergeyLukjanov has joined #openstack-infra
2013-10-28T23:51:38  *** weshay has joined #openstack-infra
2013-10-28T23:52:53  *** dcramer_ has joined #openstack-infra
