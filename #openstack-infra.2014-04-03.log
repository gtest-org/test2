2014-04-03T00:00:04  <fungi> davidlenwell: i'll have a look on the gerrit repo
2014-04-03T00:00:20  <davidlenwell> maybe something some place has the wrong date
2014-04-03T00:01:22  <fungi> the gerrit server itself has a sane system time
2014-04-03T00:02:13  <davidlenwell> the merge actually happens in the worker farm thing right ?
2014-04-03T00:02:59  <fungi> davidlenwell: yeah, merge commits look like they have the create commit date since they're created on gerrit
2014-04-03T00:03:17  <fungi> however changes which can merge without needing a merge commit keep their original commit date
2014-04-03T00:03:51  <davidlenwell> might actually be my systems fault
2014-04-03T00:04:13  <davidlenwell> I work in a vm most of the time .. and often suspend it for days at a time .. which seems to have screwed up its date
2014-04-03T00:04:13  <fungi> davidlenwell: it looks to me like your local system time is two weeks behind... do you still have a topic branch or other original commit around from when you were running git review?
2014-04-03T00:04:21  <lifeless> fungi: can you change max-servers to 40 please ?
2014-04-03T00:04:43  <davidlenwell> yep .. thats it ..
2014-04-03T00:04:46  <fungi> lifeless: can you submit a patch? i can manually change it, but puppet is going to change it back if i don't also stop puppet
2014-04-03T00:04:55  <lifeless> submitting patch too, of course
2014-04-03T00:04:58  <fungi> k
2014-04-03T00:05:02  <lifeless> we only have 40 virtualised test environments
2014-04-03T00:05:19  <lifeless> once we get more hardware back online ( Ng is pushing on that) we'll have more
2014-04-03T00:05:29  <fungi> i'm not 100% sure i get the context of those terms, though they are all words in my native tongue
2014-04-03T00:05:42  <clarkb> jogo: https://review.openstack.org/#/c/84690/1 that ready?
2014-04-03T00:05:45  *** Ryan_Lane2 has quit IRC
2014-04-03T00:05:57  <clarkb> zaro: sure let me look at it again
2014-04-03T00:06:00  <lifeless> fungi: each tripleo job uses a cluster of other VMs to run tests
2014-04-03T00:06:08  *** andreaf2 has quit IRC
2014-04-03T00:06:09  <lifeless> fungi: we call that cluster a 'testenv'
2014-04-03T00:06:16  <fungi> lifeless: okay, that. makes sense then
2014-04-03T00:06:18  <lifeless> fungi: we have a separate cluster of hosts that host those testenvs.
2014-04-03T00:06:36  *** blamar has quit IRC
2014-04-03T00:06:42  <lifeless> fungi: there are currently 40 such testenvs, but 55 jobs running would mean 15 jobs not being serviced
2014-04-03T00:06:59  <lifeless> fungi: during high churn periods thats fine - because slaves coming and going will contribute that 15
2014-04-03T00:07:35  <fungi> lifeless: i've dropped it to 40 and very briefly stopped the puppet agent daemon
2014-04-03T00:07:35  *** dcramer_ has joined #openstack-infra
2014-04-03T00:07:46  <lifeless> fungi: but, during sustained overload, it means that we could end up with jobs with a slave active - so the countdown in jenkins starts - and then waiting too long to start doing anything, so they will timeout without cause
2014-04-03T00:08:05  <lifeless> fungi: which if that happened, would be self sustaining, so we'd basically not run anything to completion
2014-04-03T00:08:26  *** talluri has joined #openstack-infra
2014-04-03T00:08:26  *** melwitt has quit IRC
2014-04-03T00:08:50  <fungi> lifeless: yeah, makes sense without some sort of additional queuing layer
2014-04-03T00:09:57  *** blamar has joined #openstack-infra
2014-04-03T00:10:23  <openstackgerrit> lifeless proposed a change to openstack-infra/config: Drop max-servers to 40 for tripleo HP region.  https://review.openstack.org/84903
2014-04-03T00:11:02  *** wenlock has quit IRC
2014-04-03T00:12:33  <clarkb> zaro: approved
2014-04-03T00:12:50  *** talluri has quit IRC
2014-04-03T00:13:29  <openstackgerrit> A change was merged to openstack-infra/gerritlib: add getVersion and listPlugin commands and update replicate command  https://review.openstack.org/69768
2014-04-03T00:13:53  <openstackgerrit> Joshua Hesketh proposed a change to openstack-infra/zuul: Fix jshint linting errors  https://review.openstack.org/84905
2014-04-03T00:13:54  <openstackgerrit> Joshua Hesketh proposed a change to openstack-infra/zuul: Add in train tracks to status page  https://review.openstack.org/84314
2014-04-03T00:13:54  <openstackgerrit> Joshua Hesketh proposed a change to openstack-infra/zuul: Fix up filter issues introduced by jshint changes  https://review.openstack.org/84112
2014-04-03T00:13:55  <openstackgerrit> Joshua Hesketh proposed a change to openstack-infra/zuul: Tweak job layout css in status page  https://review.openstack.org/84316
2014-04-03T00:13:55  *** mgagne has joined #openstack-infra
2014-04-03T00:13:55  <openstackgerrit> Joshua Hesketh proposed a change to openstack-infra/zuul: Adjust change headings on status page  https://review.openstack.org/84317
2014-04-03T00:14:09  <asselin> Hi, for nodepool, when it creates the image, a new keypair is created and used in the image. But when it comes time to ssh in an instance of the image, nodepool uses the ssh key provided in the nodepool.yaml file. Since they (obviously) don't match, nodepool is failing to ssh into the instance.
2014-04-03T00:14:26  <asselin> Am I missing some configuration somewhere?
2014-04-03T00:15:08  *** SumitNaiksatam has quit IRC
2014-04-03T00:15:48  <clarkb> asselin: yes, the setup script should install the public key for that key in the specified user's authorized_keys file
2014-04-03T00:17:51  <asselin> clarkb, sorry, I need to get this clear: The setup script running on the 'master' installs the new 'slave' public key in the 'master' user's authorized_keys file?
2014-04-03T00:20:14  <clarkb> asselin: no, the setup script provided in the nodepool.yaml. That script should when building the image install the authorized keys file for the username provided in nodepool.yaml
2014-04-03T00:20:25  *** maru_afk is now known as marun
2014-04-03T00:20:34  <fungi> clarkb: asselin: the "private-key" file path specified for each image in nodepool.yaml, right?
2014-04-03T00:21:09  <fungi> in http://git.openstack.org/cgit/openstack-infra/config/tree/modules/openstack_project/templates/nodepool/nodepool.yaml.erb we use the local /home/nodepool/.ssh/id_rsa to log in and use puppet to install the public key component of that
2014-04-03T00:22:13  *** yamahata has joined #openstack-infra
2014-04-03T00:22:56  *** gokrokve has quit IRC
2014-04-03T00:22:59  <fungi> the $ssh_key we pass in through http://git.openstack.org/cgit/openstack-infra/config/tree/modules/openstack_project/manifests/slave.pp#n23 corresponds to it, right? (basically the same key the jenkins master authenticates to the slaves with)?
2014-04-03T00:23:31  <jogo> clarkb: I don't know  wasn't aware of that patch
2014-04-03T00:24:10  <clarkb> jogo: are the existing python33 tests passing to a level you are comfy with?
2014-04-03T00:24:18  <clarkb> jogo: if so it is probably fine to start actually gating on it
2014-04-03T00:24:23  <jogo> clarkb: checking now
2014-04-03T00:24:28  <clarkb> jogo: awesome thanks
2014-04-03T00:24:38  <asselin> fungi, clarkb, I have private-key: /home/stack/.ssh/id_rsa
2014-04-03T00:24:38  <asselin> . For puppet, I need to configure it to put the corresponding public key in the instance?
2014-04-03T00:25:39  <fungi> asselin: so /home/stack/.ssh/id_rsa needs to exist on your nodepool server, first of all (that's telling it what its local ssh client should use to log into the new nodes to finalize their configuration)
2014-04-03T00:26:33  <fungi> asselin: and then, yes, the corresponding public part to that keypair needs to get installed (via puppet or whetever) during image creation into the ~/.ssh/authorized_keys file of the username nodepool will use to ssh into the nodes
2014-04-03T00:26:46  *** blamar has quit IRC
2014-04-03T00:27:05  <asselin> fungi, yes, that's on my nodepool server. I see lots of kesy in these files: modules/openstack_project/manifests/*.pp
2014-04-03T00:27:35  <jogo> clarkb: actually I am not
2014-04-03T00:27:42  <fungi> ours uses the jenkins account we create on the images, so in our cause it ends up in the /home/jenkins/.ssh/authorized_keys file on the nodepool template images
2014-04-03T00:27:44  <jogo> comnfortable with hacking gating on py33 yet
2014-04-03T00:27:48  <clarkb> jogo: ok, please leaev a comment (and -1) on the change
2014-04-03T00:27:59  <jogo> I think we first need to explore the impact of updating pep8 and flake8 versions
2014-04-03T00:28:10  <clarkb> jogo: hrm?
2014-04-03T00:28:17  <jogo> I don't think those will be an issue, but IMHO those should get precident
2014-04-03T00:28:21  *** matsuhashi has joined #openstack-infra
2014-04-03T00:28:26  <clarkb> jogo: oh yeah they totally work
2014-04-03T00:28:41  <clarkb> and if they don't we should burn them with fire
2014-04-03T00:28:52  <jogo> clarkb: I agree but, I would rather do this in the right order
2014-04-03T00:28:55  <clarkb> but agreed checking that first should be done (it is easy to do just push a WIP chagne that changes those numbers)
2014-04-03T00:29:02  <jogo> right
2014-04-03T00:29:04  <clarkb> the python33 job will run and tell you if it works
2014-04-03T00:29:48  <jogo> also py33 or py34?
2014-04-03T00:30:03  <fungi> jogo: py33 until we get trusty up in production
2014-04-03T00:30:22  <fungi> jogo: then we'll start adding py34 jobs and deprecating the py33 jobs
2014-04-03T00:30:26  *** thuc has quit IRC
2014-04-03T00:30:52  *** prad has joined #openstack-infra
2014-04-03T00:30:52  *** prad has quit IRC
2014-04-03T00:30:55  <fungi> in theory we should be able to run py27, py34 and pypy jobs on trusty workers
2014-04-03T00:31:00  *** thuc has joined #openstack-infra
2014-04-03T00:31:15  <jogo> fungi: ahh
2014-04-03T00:31:33  <fungi> which means an eventual end to specialized py3k-precise nodes once icehouse is eol support gets
2014-04-03T00:31:47  * fungi no tyep good
2014-04-03T00:32:06  *** blamar has joined #openstack-infra
2014-04-03T00:32:26  <asselin> fungi, so if I manually copy my stack user ssh key to the "ubuntu" user on the slave's authorized_keys it should work. "ubuntu" user is from the providers:images:username: entry in the nodepool.yaml file
2014-04-03T00:32:46  <fungi> i think we discussed that we might consider py33 for havana/icehouse scrapped and just transition to py34 on trusty for juno and drop the py3k-precise nodes sooner if possible
2014-04-03T00:33:26  <fungi> asselin: in theory yes, though that needs to ideally happen during image creation
2014-04-03T00:34:55  *** german_ has quit IRC
2014-04-03T00:35:05  <asselin> fungi, thanks....yes image creation is very slow (different issue I'd like to ask about) so I'd like to understand enough to test before automating.
2014-04-03T00:35:08  *** thuc has quit IRC
2014-04-03T00:36:27  *** markmcclain has quit IRC
2014-04-03T00:36:54  <asselin> fungi, clarkb thanks again for your help. I will continue tomorrow.
2014-04-03T00:39:16  <fungi> asselin: of course--we're always happy to see others use the tools we're developing, and understand they're not always trivial to implement
2014-04-03T00:39:27  *** thuc has joined #openstack-infra
2014-04-03T00:40:31  *** rlandy has quit IRC
2014-04-03T00:40:32  *** thuc_ has joined #openstack-infra
2014-04-03T00:41:17  *** thuc_ has quit IRC
2014-04-03T00:41:35  *** thuc_ has joined #openstack-infra
2014-04-03T00:41:41  *** Adri2000 has quit IRC
2014-04-03T00:43:02  *** thuc__ has joined #openstack-infra
2014-04-03T00:43:17  *** thuc__ has quit IRC
2014-04-03T00:43:45  *** alexandra_ is now known as asettle
2014-04-03T00:43:55  *** thuc has quit IRC
2014-04-03T00:44:07  *** thuc has joined #openstack-infra
2014-04-03T00:44:51  *** thuc__ has joined #openstack-infra
2014-04-03T00:45:20  *** thuc__ has quit IRC
2014-04-03T00:45:49  *** thuc__ has joined #openstack-infra
2014-04-03T00:46:15  *** asettle is now known as alexsettle
2014-04-03T00:46:27  *** thuc_ has quit IRC
2014-04-03T00:46:27  *** alexsettle is now known as Alexandra
2014-04-03T00:46:39  *** thuc__ has quit IRC
2014-04-03T00:47:03  *** thuc_ has joined #openstack-infra
2014-04-03T00:47:30  <lifeless> fungi: https://jenkins05.openstack.org/job/check-tripleo-ironic-undercloud-precise/153/console - that seems hung ?
2014-04-03T00:47:36  *** dcramer_ has quit IRC
2014-04-03T00:48:17  <fungi> agreed, nova list encountered "ERROR: HTTPConnectionPool(host='192.0.2.1', port=5000): Max retries exceeded with url: /v2.0/tokens (Caused by <class 'socket.error'>: [Errno 110] Connection timed out)"
2014-04-03T00:48:24  *** mriedem has joined #openstack-infra
2014-04-03T00:48:35  *** thuc has quit IRC
2014-04-03T00:48:37  <fungi> and the job is now doing nothing, hurtling toward a lengthy job timeout
2014-04-03T00:49:06  <fungi> lifeless: do you want the job aborted, or are you looking for troubleshooting assistance on it?
2014-04-03T00:50:17  <lifeless> fungi: I'm wondering if something is systemically wrong
2014-04-03T00:50:31  <lifeless> fungi: e.g. like a dropped tcp connection
2014-04-03T00:50:38  <lifeless> from slave to jenkins
2014-04-03T00:51:30  <fungi> lifeless: doesn't seem so... jenkins appears to run keepalives to slaves and notices when they go away/stop responding fairly quickly
2014-04-03T00:51:35  <lifeless> ok
2014-04-03T00:51:45  <lifeless> problem in test script then, will ignore
2014-04-03T00:52:01  <fungi> lifeless: i can ssh into the slave and see if it's still doing stuff, or place the node on hold and add an ssh key for you
2014-04-03T00:55:07  *** julim has quit IRC
2014-04-03T00:56:03  *** julim has joined #openstack-infra
2014-04-03T00:56:16  <fungi> or i can go have an evening. yes, i think i might just do that
2014-04-03T00:57:24  *** thuc_ has quit IRC
2014-04-03T01:00:25  *** julim has quit IRC
2014-04-03T01:01:32  *** harlowja is now known as harlowja_away
2014-04-03T01:01:55  *** dcramer_ has joined #openstack-infra
2014-04-03T01:02:26  <lifeless> fungi: is possible to change the place in the for a job ?
2014-04-03T01:03:13  <lifeless> fungi: oy I just missed you :P
2014-04-03T01:03:15  <lifeless> clarkb: ^
2014-04-03T01:03:22  *** yaguang has joined #openstack-infra
2014-04-03T01:03:48  <portante> fungi, clarkb, lifeless: can somebody point me at the official license header template for python source?
2014-04-03T01:03:54  <fungi> lifeless: still here, but not succeeding in parsing your question
2014-04-03T01:04:01  <portante> I was using: http://docs.openstack.org/developer/hacking/
2014-04-03T01:04:16  <openstackgerrit> Joe Gordon proposed a change to openstack-dev/hacking: Test reving the dependencies  https://review.openstack.org/84913
2014-04-03T01:04:28  <lifeless> fungi: I have a job - 84361 which may fix the timeouts on all the ironic-undercloud jobs if landed
2014-04-03T01:04:42  <lifeless> fungi: but it hasn't actually run  and its deep in the queue
2014-04-03T01:04:53  <lifeless> fungi: I'm wondering if its possible to promote it to the front
2014-04-03T01:05:03  <fungi> lifeless: i can enqueue it in the gate if it's still languishing in check waiting for resources, yes
2014-04-03T01:05:41  *** matsuhashi has quit IRC
2014-04-03T01:05:47  <lifeless> fungi: I mean front of check queue
2014-04-03T01:06:03  <lifeless> fungi: erm check-tripleo
2014-04-03T01:06:03  * portante ... **crickets** ...
2014-04-03T01:06:14  <lifeless> portante: is there one?
2014-04-03T01:06:20  *** matsuhashi has joined #openstack-infra
2014-04-03T01:06:49  <portante> I am looking to see if there is an official template somewhere, or if what is on that hacking page above is the one to use
2014-04-03T01:06:53  <portante> lifeless:
2014-04-03T01:07:10  <fungi> lifeless: i can try to reorder that, though i've only ever used zuul promote on the gate pipeline, so no guarantees
2014-04-03T01:07:12  *** julim has joined #openstack-infra
2014-04-03T01:07:24  <lifeless> fungi: please, that would be super useful
2014-04-03T01:09:06  <fungi> lifeless: seems to have worked, though using zuul promote on an independent queue still seems to cancen and resubmit all jobs
2014-04-03T01:09:24  <fungi> s/cancen/cancel/
2014-04-03T01:09:26  <lifeless> fungi: it has to I think, because jenkins
2014-04-03T01:09:58  <fungi> anyway, i'm really not here now ;)
2014-04-03T01:10:51  <jogo> clarkb: commented
2014-04-03T01:11:15  *** yamahata has quit IRC
2014-04-03T01:11:40  *** mrodden has quit IRC
2014-04-03T01:11:55  *** saschpe has quit IRC
2014-04-03T01:12:01  *** julim has quit IRC
2014-04-03T01:12:32  <fungi> portante: i think the closest you're going to get it http://git.openstack.org/cgit/openstack-dev/hacking/tree/hacking/core.py#n142
2014-04-03T01:13:09  *** bhuvan_ has quit IRC
2014-04-03T01:13:11  <portante> fungi: thanks
2014-04-03T01:13:12  <fungi> (that's the text _check_for_exact_apache() compares against)
2014-04-03T01:13:24  <portante> so we don't need any "Copyright" strings in there anymore?
2014-04-03T01:13:27  <portante> huh
2014-04-03T01:13:29  <portante> k
2014-04-03T01:13:48  <fungi> portante: it doesn't check the copyright notices because they're not part of the license and irregular in nature
2014-04-03T01:13:58  <portante> ah
2014-04-03T01:14:35  <fungi> portante: copyright notices are up to personal/project discretion. i think projects benefit from adding and maintaining them, but that's just my opinion
2014-04-03T01:15:07  <portante> fungi: okay, thanks
2014-04-03T01:15:10  <portante> notmyname: ^^^
2014-04-03T01:15:13  *** dcramer_ has quit IRC
2014-04-03T01:15:34  <portante> notmyname: your call, I can add an OpenStack Copyright if you'd like
2014-04-03T01:16:27  <notmyname> portante: not important to me personally, and IIRC, the foundation doesn't want to be assigned copyright
2014-04-03T01:16:30  <fungi> portante: copyrighting something OpenStack is fairly inaccurate ;) the author(s) of the work or their employers in a work-for-hire scenario is/are the copyright holder(s)
2014-04-03T01:17:13  <portante> okay
2014-04-03T01:17:17  <portante> thanks guys
2014-04-03T01:17:40  <jeblair> (unless you're moving around code that is already under openstack foundation copyright as opposed to writing new code)
2014-04-03T01:17:53  <fungi> at the moment, the only new works which should technically be getting a "copyright openstack foundation" are those works written by the handful of us who are directly employed by the foundation, or working on a contract for it
2014-04-03T01:17:54  <fungi> yes
2014-04-03T01:18:25  <jeblair> portante: there are a lot of openstack foundation copyright headers around because at the start of the project, rackspace assigned all of its openstack-related copyrights to the foundation (by way of the llc)
2014-04-03T01:18:27  <notmyname> "Copyright OpenStack, because jeblair told me this had to be in Swift"
2014-04-03T01:18:29  <fungi> preserving existing copyright counts, for code copying, agreed
2014-04-03T01:18:34  <fungi> heh
2014-04-03T01:18:43  *** saschpe has joined #openstack-infra
2014-04-03T01:19:10  <jeblair> notmyname: ;)
2014-04-03T01:19:44  * fungi is apparently actually really bad at not being here
2014-04-03T01:20:06  <jeblair> fungi: you're the worst at it :)
2014-04-03T01:20:19  * jeblair goes away
2014-04-03T01:23:43  <portante> jeblair: thanks
2014-04-03T01:23:53  * portante knows you read that! ;)
2014-04-03T01:29:24  *** nosnos has joined #openstack-infra
2014-04-03T01:32:20  *** rfolco has quit IRC
2014-04-03T01:35:52  *** VijayTripathi has quit IRC
2014-04-03T01:37:30  *** julim has joined #openstack-infra
2014-04-03T01:42:28  *** Adri2000 has joined #openstack-infra
2014-04-03T01:46:31  *** Alexandra is now known as alex-away
2014-04-03T01:53:56  *** sahumada has quit IRC
2014-04-03T01:57:06  *** sahumada has joined #openstack-infra
2014-04-03T02:00:25  *** wenlock has joined #openstack-infra
2014-04-03T02:01:31  *** zns has quit IRC
2014-04-03T02:08:03  *** alff has quit IRC
2014-04-03T02:08:03  *** alff_ has quit IRC
2014-04-03T02:08:33  *** thuc has joined #openstack-infra
2014-04-03T02:08:55  *** HenryG has quit IRC
2014-04-03T02:09:22  <openstackgerrit> Joshua Hesketh proposed a change to openstack-infra/zuul: Move status stylesheets into css file  https://review.openstack.org/84921
2014-04-03T02:09:22  <openstackgerrit> Joshua Hesketh proposed a change to openstack-infra/zuul: Add in sparklines to status page pipelines  https://review.openstack.org/84922
2014-04-03T02:10:43  *** talluri has joined #openstack-infra
2014-04-03T02:12:10  *** alff_ has joined #openstack-infra
2014-04-03T02:12:10  *** alff has joined #openstack-infra
2014-04-03T02:12:34  *** alff has quit IRC
2014-04-03T02:12:34  *** alff_ has quit IRC
2014-04-03T02:13:08  *** thuc has quit IRC
2014-04-03T02:14:59  *** talluri has quit IRC
2014-04-03T02:16:41  *** mgagne1 has joined #openstack-infra
2014-04-03T02:18:49  *** mgagne has quit IRC
2014-04-03T02:21:13  <mordred> jhesketh: why move the js stuff down a level? https://review.openstack.org/#/c/84069/ ?
2014-04-03T02:21:43  <mordred> jhesketh: if the entry isn't in the main tox file, it'll kinda be hard to re-use the gate tox infrastructure we already have ...
2014-04-03T02:22:42  *** jlk has left #openstack-infra
2014-04-03T02:22:54  <jhesketh> mordred: well I figured we could work around the gate with some JJB shell
2014-04-03T02:23:08  <jhesketh> but I moved it so that if we ever separate it out entirely from zuul it's ready to go
2014-04-03T02:23:19  <jhesketh> and it kind of litters the repository
2014-04-03T02:23:36  <jhesketh> mordred: did you read the scrollback yesterday when we spoke about the javascript changes?
2014-04-03T02:23:45  *** Alexandra has joined #openstack-infra
2014-04-03T02:23:46  <mordred> no. let me go find that
2014-04-03T02:23:53  <mordred> cana you tl;dr me?
2014-04-03T02:24:03  <jhesketh> basically we're not sure if we want to introduce all the extra jshint stuff + complexity
2014-04-03T02:24:18  *** Alexandra has left #openstack-infra
2014-04-03T02:24:52  <jhesketh> (you were pinged on it yesterday morning my time, so around 2200-2300 UTC)
2014-04-03T02:26:11  *** Alexandra has joined #openstack-infra
2014-04-03T02:26:13  <mordred> gotcha
2014-04-03T02:26:32  <mordred> so - if we weren't re-inventing grunt and bower  in shell script and vendoring in things
2014-04-03T02:26:40  <mordred> I'd say "yeah, we shoudln't add the tools"
2014-04-03T02:26:47  <mordred> but we're adding tools - just custom written ones
2014-04-03T02:27:12  <mordred> so in my opinion, now that it's gotten complex, we should start using the tools taht are designed fo rthe job at hand
2014-04-03T02:27:23  <mordred> that said - I understand reluctance
2014-04-03T02:28:52  *** Alexandra is now known as asettle
2014-04-03T02:29:22  *** asettle is now known as Alexandra
2014-04-03T02:29:58  *** nkinder has quit IRC
2014-04-03T02:32:09  <clarkb> mordred: its less about tools and moer the way they were introduced
2014-04-03T02:32:18  <clarkb> mordred: that chagne is massive with little to no documentation or comments
2014-04-03T02:32:23  <clarkb> mordred: also it should probably be about 3 changes
2014-04-03T02:32:36  <clarkb> one to add framework with maybe linting, another to add unit tests and another to add tools
2014-04-03T02:32:41  <clarkb> as is its just hard to understand
2014-04-03T02:34:26  *** MarkAtwood has joined #openstack-infra
2014-04-03T02:34:45  *** david-lyle has joined #openstack-infra
2014-04-03T02:34:50  <mordred> clarkb: ok. I can do that
2014-04-03T02:35:01  <clarkb> mordred: the other concern was less css
2014-04-03T02:35:07  <clarkb> because packaging
2014-04-03T02:35:33  <clarkb> and are the js tools really so insane that we need 10 config files to do that
2014-04-03T02:35:36  <clarkb> python needs 2
2014-04-03T02:35:44  <mordred> meh
2014-04-03T02:35:51  <mordred> it's how js works
2014-04-03T02:35:52  <clarkb> mordred: its not meh though
2014-04-03T02:35:54  <mordred> it is
2014-04-03T02:35:55  <clarkb> it is incredibly confusing
2014-04-03T02:35:59  <mordred> it's not really
2014-04-03T02:36:03  <lifeless> mordred: oh hai
2014-04-03T02:36:05  <mordred> and we're alraedy using it
2014-04-03T02:36:09  <mordred> in another infra project
2014-04-03T02:36:10  <clarkb> mordred: zuul isn't
2014-04-03T02:36:21  <clarkb> zuul has a different core group I am going to be a bit more picky
2014-04-03T02:36:28  <clarkb> because 10 config files is insane
2014-04-03T02:36:41  <clarkb> mordred: it seems like there was a lot of overlap in them
2014-04-03T02:36:41  <mordred> ok. that's fine. anyway - I'll rework the changes to be more readable
2014-04-03T02:36:46  <clarkb> installjs vs bootstrap
2014-04-03T02:36:53  <clarkb> and dependencies listed in multiple places and so on
2014-04-03T02:36:57  <mordred> some of them were copies that are not needed
2014-04-03T02:37:09  <openstackgerrit> A change was merged to openstack-infra/elastic-recheck: Add a fingerprint for bug 1301027  https://review.openstack.org/84558
2014-04-03T02:37:10  <uvirtbot> Launchpad bug 1301027 in neutron/havana "Permission denied error in unit tests" [High,Fix committed] https://launchpad.net/bugs/1301027
2014-04-03T02:37:11  <mordred> so, like I said, I'll rework the patches based on that feedback
2014-04-03T02:37:16  <clarkb> ok thanks
2014-04-03T02:37:48  *** esker has joined #openstack-infra
2014-04-03T02:37:48  *** mriedem has quit IRC
2014-04-03T02:39:30  *** mrodden has joined #openstack-infra
2014-04-03T02:40:30  <clarkb> mordred: what does bower do? grunt is basically make and karma is the test suite
2014-04-03T02:40:33  <mordred> yes
2014-04-03T02:40:43  <mordred> bower is the thign that does what "etc/status/fetch-dependencies.sh" does
2014-04-03T02:41:06  <mordred> it fetches web-style dependencies - that is, things that nobody ever intended would _install_ as a library and be consumed
2014-04-03T02:41:09  *** Alexandra_ has joined #openstack-infra
2014-04-03T02:41:12  <mordred> but instead are designed to be included into a website
2014-04-03T02:41:31  *** Alexandra_ has quit IRC
2014-04-03T02:41:47  *** asettle has joined #openstack-infra
2014-04-03T02:41:47  <mordred> it pulls them into bower_components, and then the build chain knows where to find them, so that when it generates the tarball, all is minified properly
2014-04-03T02:42:05  *** nkinder has joined #openstack-infra
2014-04-03T02:42:17  <clarkb> so python setup.py sdist equivalent?
2014-04-03T02:42:30  <mordred> not entirely
2014-04-03T02:42:40  <mordred> it's more like pip - but for a different type of thing
2014-04-03T02:43:19  <jhesketh> mordred: okay, if you're going to rework it again would you mind doing it at the new tail of my changes?
2014-04-03T02:43:23  <mordred> so, like, you use it to grab bootstrap and put it into a local dir - so that you don't have to vendor bootstrap into your tree
2014-04-03T02:43:33  <mordred> jhesketh: absolutely
2014-04-03T02:43:37  *** Alexandra has quit IRC
2014-04-03T02:43:40  <jhesketh> mordred: also I'd like to see this stuff inside the status folder to keep zuul cleaner
2014-04-03T02:43:48  <jhesketh> it does appear to add a lot of config junk
2014-04-03T02:44:34  <clarkb> mordred: it seemed like we define deps in bower separate of grunt
2014-04-03T02:44:40  <mordred> that's right
2014-04-03T02:44:44  <mordred> grunt does not do depends
2014-04-03T02:44:45  <clarkb> is that right? that seems wrong from a we tested X and package Y perspective
2014-04-03T02:45:03  <mordred> it doesn't assume a world where there would bea  distro package of bootstrap that would be used
2014-04-03T02:45:11  <mordred> because that world doesn't raelly exit
2014-04-03T02:45:14  <mordred> exist
2014-04-03T02:45:41  <mordred> you declare the version of bootstrap you want, and bower pulls that down, and then when grunt runs, it uses what's now in the tree
2014-04-03T02:45:51  <mordred> it's a bit like vendoring without having to check the vendored code into the repo
2014-04-03T02:45:53  <clarkb> mordred: oh so grunt does the bower step?
2014-04-03T02:45:56  <mordred> no
2014-04-03T02:46:19  <clarkb> how do we make sure what we package is what we test then?
2014-04-03T02:46:20  <mordred> that's in https://review.openstack.org/#/c/82307/4/tools/install-js.sh
2014-04-03T02:46:36  <mordred> it is - it's just a step before grunt
2014-04-03T02:49:12  <mordred> so - you run npm install to install any npm depends
2014-04-03T02:49:28  <mordred> in our case, those are all dev/test depends and not things that get installed into the site eventually
2014-04-03T02:49:31  <clarkb> which is karma and test depends or jshint
2014-04-03T02:49:33  <clarkb> right
2014-04-03T02:49:34  <mordred> right
2014-04-03T02:49:46  <mordred> then, using bower, you install the libraries that actually _do_ get installed into the site
2014-04-03T02:50:00  *** julim has quit IRC
2014-04-03T02:51:14  <mordred> clarkb: so then, https://review.openstack.org/#/c/82307/4/status/src/index.html
2014-04-03T02:51:19  <mordred> line 24
2014-04-03T02:51:30  <mordred> that chunk is referencing files in the bower_components dir
2014-04-03T02:52:18  <clarkb> but it isn't a script so it doesnt' do things at run time right?
2014-04-03T02:52:20  <mordred> and the minifier will combine them into /js/libs.js and will replace that section with the one that references /js/libs.js instead
2014-04-03T02:52:21  <clarkb> it is build time?
2014-04-03T02:52:25  <clarkb> ah gotcha
2014-04-03T02:52:44  <clarkb> so you end up with a massive file with minified stuff
2014-04-03T02:52:45  *** thuc has joined #openstack-infra
2014-04-03T02:52:47  <mordred> yup
2014-04-03T02:53:00  <mordred> and you know for certain that what you deploy is what you tested :)
2014-04-03T02:53:14  *** thuc_ has joined #openstack-infra
2014-04-03T02:53:24  *** weshay has joined #openstack-infra
2014-04-03T02:54:05  *** pcrews_ has quit IRC
2014-04-03T02:54:36  *** fifieldt_ is now known as fifieldt
2014-04-03T02:54:53  <mordred> but honestly - great point in terms of code drop - I put the unittest stuff in there to show that we can do it and where it goes - but since we don't actually HAVE that
2014-04-03T02:55:08  <mordred> just not having it in tree as step one will be hella clearer :)
2014-04-03T02:57:08  *** thuc has quit IRC
2014-04-03T03:00:16  *** mrodden has quit IRC
2014-04-03T03:02:24  *** mrodden has joined #openstack-infra
2014-04-03T03:05:26  *** matsuhashi has quit IRC
2014-04-03T03:08:19  *** thuc_ has quit IRC
2014-04-03T03:08:51  *** thuc has joined #openstack-infra
2014-04-03T03:11:08  *** yjiang has joined #openstack-infra
2014-04-03T03:11:25  *** thuc has quit IRC
2014-04-03T03:11:53  *** talluri has joined #openstack-infra
2014-04-03T03:12:27  <clarkb> fungi: lifeless: so are we still leaking floating ips? it wasn't clear to me if we were still experiencing that
2014-04-03T03:12:27  *** esker has quit IRC
2014-04-03T03:13:01  *** esker has joined #openstack-infra
2014-04-03T03:13:02  <clarkb> there appaer to be a relatively largish number of tests running now compared to yesterday
2014-04-03T03:14:38  *** sdake has quit IRC
2014-04-03T03:16:14  *** talluri has quit IRC
2014-04-03T03:19:25  <lifeless> clarkb: I'll stop my workaround and we'll find out
2014-04-03T03:22:15  *** mrodden has quit IRC
2014-04-03T03:23:29  *** nosnos has quit IRC
2014-04-03T03:27:07  <clarkb> lifeless: and if we are, I will whip up a patch that checks fixed ip against the server's fixed ip
2014-04-03T03:36:14  *** gokrokve has joined #openstack-infra
2014-04-03T03:36:27  *** gokrokve has quit IRC
2014-04-03T03:36:35  *** basha_ has joined #openstack-infra
2014-04-03T03:37:01  *** gokrokve has joined #openstack-infra
2014-04-03T03:38:11  *** VijayTripathi has joined #openstack-infra
2014-04-03T03:39:02  *** thuc has joined #openstack-infra
2014-04-03T03:39:28  <zaro> fungi: you are correct getVersion is unused.  it's a nice to have. i probably should have added that method in a seperate change.
2014-04-03T03:56:08  *** maxbit has quit IRC
2014-04-03T03:56:35  *** basha_ has quit IRC
2014-04-03T04:00:44  *** harlowja_away is now known as harlowja
2014-04-03T04:02:14  *** SumitNaiksatam has joined #openstack-infra
2014-04-03T04:03:19  <lifeless> clarkb: its looking ok so far, but we really need a few hours - cycled nodes - to be sure
2014-04-03T04:03:24  *** thuc has quit IRC
2014-04-03T04:03:30  <clarkb> rgr
2014-04-03T04:03:36  <lifeless> clarkb: I'll check before I sleep and if leaking put the workaround back
2014-04-03T04:04:00  *** thuc has joined #openstack-infra
2014-04-03T04:07:55  *** thuc has quit IRC
2014-04-03T04:08:45  <lifeless> pleia2: I see there is a fedora job on check-tripleo now
2014-04-03T04:08:51  <lifeless> pleia2: but no images scheduled or live
2014-04-03T04:09:02  <lifeless> pleia2: so this is making all runs fail with NOT REGISTERED
2014-04-03T04:09:17  <lifeless> pleia2: how do you feel about us backing that out ? Or is fedora veryveryclose ?
2014-04-03T04:09:24  <pleia2> lifeless: hmm, there were some earlier, did any of them work?
2014-04-03T04:09:35  *** nosnos has joined #openstack-infra
2014-04-03T04:09:40  <clarkb> we definitely had an image
2014-04-03T04:09:46  <pleia2> the slaves seemed to be building fine earlier
2014-04-03T04:10:48  <pleia2> it should work, but we might want to regroup with derekh tomorrow since he'll know more about actually running the tests I think
2014-04-03T04:11:13  *** thuc has joined #openstack-infra
2014-04-03T04:12:53  <lifeless> theres a slave limit of 1 for fedora
2014-04-03T04:13:01  <lifeless> AIUI we need a limit => jenkinses
2014-04-03T04:13:07  <lifeless> or the other jenkins will barf, no ?
2014-04-03T04:13:25  <lifeless> actually
2014-04-03T04:13:29  <lifeless> I know what I think we should do
2014-04-03T04:13:34  <lifeless> make the fedora job nonvoting
2014-04-03T04:13:36  <lifeless> as its new
2014-04-03T04:13:44  <lifeless> nonvoting in a nonvoting queue :)
2014-04-03T04:14:12  <pleia2> ah yes, I think he put it is as 1 because it's new, but you're right, it really should be non-voting
2014-04-03T04:14:51  <clarkb> 1 should be fine it will scale up
2014-04-03T04:15:14  *** matsuhashi has joined #openstack-infra
2014-04-03T04:15:14  <lifeless> oh right, min-ready
2014-04-03T04:15:20  <clarkb> maybe the jenkins job label doesnt match slave label?
2014-04-03T04:15:59  <pleia2> check-tripleo-overcloud-f20
2014-04-03T04:16:00  <pleia2> check-tripleo-overcloud-f20
2014-04-03T04:16:02  <pleia2> they're the same
2014-04-03T04:16:21  <lifeless> nonvoting is enough to make me happy
2014-04-03T04:16:46  *** VijayTripathi has quit IRC
2014-04-03T04:17:34  <clarkb> image build must've broken then? /me looks at web hosted logs
2014-04-03T04:19:24  <clarkb> pleia2: the label is tripleo-f20 according to nodepool
2014-04-03T04:19:48  <pleia2> clarkb: oh, the name of the slave
2014-04-03T04:20:06  <pleia2> right, you said that, let me check the patches again
2014-04-03T04:20:45  <pleia2> node: 'tripleo-f20'
2014-04-03T04:21:19  <clarkb> ya that looks correct
2014-04-03T04:22:23  <clarkb> I wonder if we have simply been unable to build a new image beacuse all of the quota has been used to kill that backlog
2014-04-03T04:22:40  <clarkb> I don't see tripleo-f20 showing up in the image logs the last few days
2014-04-03T04:22:55  *** dcramer_ has joined #openstack-infra
2014-04-03T04:24:20  *** mrodden has joined #openstack-infra
2014-04-03T04:24:57  <lifeless> clarkb: quota is 60
2014-04-03T04:28:34  *** BadCub01 has quit IRC
2014-04-03T04:29:39  *** michchap has quit IRC
2014-04-03T04:29:57  *** michchap has joined #openstack-infra
2014-04-03T04:32:40  *** masayukig has quit IRC
2014-04-03T04:32:52  *** masayukig has joined #openstack-infra
2014-04-03T04:34:39  *** talluri has joined #openstack-infra
2014-04-03T04:34:48  *** talluri has quit IRC
2014-04-03T04:34:55  *** talluri has joined #openstack-infra
2014-04-03T04:36:38  *** ArxCruz has quit IRC
2014-04-03T04:37:19  *** mihgen has joined #openstack-infra
2014-04-03T04:38:01  *** ArxCruz has joined #openstack-infra
2014-04-03T04:40:18  *** matsuhashi has quit IRC
2014-04-03T04:43:48  *** weshay has quit IRC
2014-04-03T04:44:05  <mordred> dstufft: tchaypo has made a patch for pip that makes us very happy
2014-04-03T04:44:16  *** resker has joined #openstack-infra
2014-04-03T04:44:18  *** resker has quit IRC
2014-04-03T04:45:26  <dstufft> which is that
2014-04-03T04:45:54  <mordred> dstufft: https://github.com/jamezpolley/pip/commit/66dff9a8a3bf95d105792f2aae3dd7caa65b5253
2014-04-03T04:46:11  <mordred> dstufft: it fixxes the issue that file:// and http:// urls exhibit different behvior
2014-04-03T04:46:26  *** matsuhashi has joined #openstack-infra
2014-04-03T04:46:31  <mordred> which has been plaguing me as a person
2014-04-03T04:46:52  <dstufft> sigh
2014-04-03T04:46:55  <dstufft> fucking file:// urls
2014-04-03T04:47:00  <dstufft> buggiest things ever
2014-04-03T04:47:04  <mordred> yah
2014-04-03T04:47:06  <mordred> BUT
2014-04-03T04:47:10  <mordred> really helpful in some cases
2014-04-03T04:47:27  <dstufft> yea yea
2014-04-03T04:47:27  *** esker has quit IRC
2014-04-03T04:47:32  <mordred> (I promise, there really are cases - I'm not lying)
2014-04-03T04:47:37  <mordred> (ok, I'm lying, but not MUCH)
2014-04-03T04:47:41  <dstufft> ;)
2014-04-03T04:48:08  <dstufft> oh
2014-04-03T04:48:15  <dstufft> all our tests are broken right now because of wheel
2014-04-03T04:48:16  <dstufft> lol
2014-04-03T04:48:21  <mordred> NICE
2014-04-03T04:48:25  <dstufft> I forgot about that
2014-04-03T04:49:03  <dstufft> also apparently someone merged or commited pep8 violations
2014-04-03T04:50:15  <tchaypo> dstufft: i hear you're a pip maintainer type
2014-04-03T04:50:23  <mordred> dstufft: if you want gating - we've got some you can use ...
2014-04-03T04:50:27  <clarkb> lifeless: does the base fedora image existing in your cloud after everything got blown away?
2014-04-03T04:50:53  <clarkb> running down ideas for why the image doesn't show up in the image log at all
2014-04-03T04:50:59  <clarkb> and not being able to boot the base image may explain it
2014-04-03T04:51:20  <dstufft> mordred: we theortically test all PRs before they land, probably someone commited directly to develop, or they merged a PR and ignored the failures because everything else is red now anyways so who wants to read the failures to make sure a change isn't introducing more failures
2014-04-03T04:51:32  <dstufft> tchaypo: yea
2014-04-03T04:51:32  <clarkb> lifeless: http://git.openstack.org/cgit/openstack-infra/config/tree/modules/openstack_project/templates/nodepool/nodepool.yaml.erb#n404
2014-04-03T04:51:38  <tchaypo> dstufft:My patch so far is based on bashing out a nasty hack and being surprised that it works. I haven't yet looked at what kind of coding standards or testing pip wants before it can accept the patch
2014-04-03T04:52:03  *** skraynev_afk is now known as skraynev
2014-04-03T04:52:12  <mordred> dstufft: yah. I'm just trolling because $wine
2014-04-03T04:52:27  <tchaypo> mordred: but it
2014-04-03T04:52:30  <tchaypo> s only 4pm!
2014-04-03T04:52:42  <mordred> tchaypo: that's four hours after wine drinking starts!
2014-04-03T04:53:02  <dstufft> tchaypo: your patch looks reasonable, it'd be nice to get some tests for it, but like all our tests are borken right now because wheel
2014-04-03T04:53:09  <tchaypo> baaha
2014-04-03T04:53:17  * mordred goes to do more not-IRC
2014-04-03T04:53:19  <tchaypo> it's nice to know that we aren't the only project broken because wheel
2014-04-03T04:53:23  <mordred> which may involve kevin spacey
2014-04-03T04:53:31  <clarkb> mordred: house of cards?
2014-04-03T04:53:42  <mordred> clarkb: yah. we're still on season one
2014-04-03T04:53:43  <dstufft> someday I'm going to quit all this computering and become a goat herder
2014-04-03T04:53:50  <mordred> dstufft: +1000
2014-04-03T04:53:51  <lifeless> clarkb: I created one yes
2014-04-03T04:53:56  <clarkb> mordred: I will not spoil anything then
2014-04-03T04:53:57  <lifeless> clarkb: you can check with glance list-images
2014-04-03T04:53:58  <mordred> dstufft: I will fund your herd if I can help
2014-04-03T04:54:04  <lifeless> or image-list or whatever it is
2014-04-03T04:54:15  <clarkb> lifeless: ya nova image list I can check tomorrow
2014-04-03T04:54:32  <dstufft> http://d.stufft.io/image/0C3S140L3d0Q apparently github puts build stats on the overbiew now, and lol our PRs
2014-04-03T04:54:39  <lifeless> clarkb: if you like proxying through apis sure
2014-04-03T04:54:58  <clarkb> lifeless: I kinda do, then I only need one client (when can openstaclient be a thing?)
2014-04-03T04:54:58  <lifeless> clarkb: nova image list will go away eventually
2014-04-03T04:55:10  <clarkb> lifeless: hopefully not before openstack iamge list is a thing
2014-04-03T04:55:30  <mordred> clarkb: openstackclient actually works now
2014-04-03T04:55:35  <mordred> clarkb: I've used it to do things
2014-04-03T04:55:40  <clarkb> oh? I should install it then
2014-04-03T04:55:46  <mordred> clarkb: I keep meaning to learn to use it for more things
2014-04-03T04:55:55  <mordred> it'snot 100% complete - but I think it has the things we're likely to use
2014-04-03T04:57:11  <openstackgerrit> Noorul Islam K M proposed a change to openstack-infra/reviewstats: Update solum core-team  https://review.openstack.org/84939
2014-04-03T04:57:36  <dstufft> mordred: your not IRC looks vaguely similar to my not IRC
2014-04-03T04:57:56  <mordred> dstufft: not-IRC is harder to do than IRC - there are 4 more characters
2014-04-03T04:58:02  <clarkb> dstufft: do I need to not spoil things for you too?
2014-04-03T04:58:38  <dstufft> clarkb: oh I meant that I seem to awlays end up back on IRC when I say I'm going to go do something else ;)
2014-04-03T04:58:43  <dstufft> I'm not watching that house of cards show
2014-04-03T04:59:51  <mordred> clarkb: don't say things in scrollback
2014-04-03T04:59:59  <mordred> I do, you know, sometimes read what happened during not-IRC
2014-04-03T05:00:00  <clarkb> don't worry I will be good
2014-04-03T05:00:12  <clarkb> dstufft: its actually quite good
2014-04-03T05:00:13  * mordred throws wet cats into the air
2014-04-03T05:00:17  <dstufft> mordred: dumbledore kills snape
2014-04-03T05:00:26  <mordred> dstufft: you are a bad bad boy
2014-04-03T05:01:01  <clarkb> I can do Game of Thrones spoilers too but I won't
2014-04-03T05:01:19  <dstufft> I need to catch up on both the books and the show :/
2014-04-03T05:01:21  <clarkb> dstufft: reading books is how I do actual no irc and make sure it doesn't become irc
2014-04-03T05:01:49  <clarkb> currently reading green mars, I should go do that soon and fall asleep
2014-04-03T05:01:56  *** thuc has quit IRC
2014-04-03T05:02:00  <mordred> I was about to do not-IRC, but then sandy started spraying medicine on the cat
2014-04-03T05:02:05  <dstufft> somehow when the choice is "enjoy myself" and "get mad at computers" I pick the latter far more than is healthy
2014-04-03T05:02:08  <mordred> so I went back to IRC for a minute
2014-04-03T05:02:17  *** yamahata has joined #openstack-infra
2014-04-03T05:02:19  <mordred> dstufft: computers are extremely vexing
2014-04-03T05:02:29  <clarkb> but for some reason we keep smashing our keyboards
2014-04-03T05:02:32  *** thuc has joined #openstack-infra
2014-04-03T05:02:47  <clarkb> also this software stuff that people write is pretty terrible
2014-04-03T05:02:53  <nibalizer> IRC is my default animation when idle
2014-04-03T05:03:04  <nibalizer> that and typing 'arst' + ^U over and over again
2014-04-03T05:03:13  <StevenK> mordred: What's did the cat do to deserve that? :-P
2014-04-03T05:03:31  *** jcoufal has joined #openstack-infra
2014-04-03T05:03:45  <mordred> StevenK: countless countless things
2014-04-03T05:03:49  <dstufft> tchaypo: I think I just merged stuff to make develop pass tests again for pip
2014-04-03T05:03:59  <dstufft> tchaypo: so you probably want to rebase or something
2014-04-03T05:04:07  <dstufft> but you probably also don't want to run the tests locally
2014-04-03T05:04:14  <dstufft> unless you have nothing to do for like 3 hours
2014-04-03T05:04:26  <StevenK> So pip takes after Launchpad?
2014-04-03T05:04:29  <dstufft> at least it doesn't use up like 15GB of temp space anymore
2014-04-03T05:04:58  <StevenK> (Without using a massive machine and 20 LXC containers, Launchpad's test suite takes about 6 hours)
2014-04-03T05:05:15  <clarkb> dstufft: uh what?
2014-04-03T05:05:26  <clarkb> dstufft: does it build packages for everythign on pypi?
2014-04-03T05:05:31  <clarkb> and install them?
2014-04-03T05:06:02  *** thuc has quit IRC
2014-04-03T05:06:03  <dstufft> StevenK: it takes about 20 minutes per CPython (2.6, 2.7, 3.2, 3.3, and 3.4) and then 45-50 minutes for PyPy
2014-04-03T05:06:31  <dstufft> clarkb: we have a directory full of test data that we copy into a unique per test case temporary directory
2014-04-03T05:06:37  <dstufft> repeat that 400 some times
2014-04-03T05:06:49  <dstufft> also in that test data is 400 some virtualenvs
2014-04-03T05:07:16  *** LinuxJedi has quit IRC
2014-04-03T05:07:27  *** mrmartin has joined #openstack-infra
2014-04-03T05:07:27  <StevenK> mordred: Challenge accepted, re: -dev mail
2014-04-03T05:07:45  <clarkb> dstufft: wow gg
2014-04-03T05:08:03  <openstackgerrit> Marc Abramowitz proposed a change to openstack-infra/jenkins-job-builder: Accept file objects as well as filenames  https://review.openstack.org/84942
2014-04-03T05:08:11  <clarkb> StevenK: yes we should have the summit for M there
2014-04-03T05:08:16  <StevenK> Haha
2014-04-03T05:08:59  <dstufft> clarkb: we didn't used to copy, but using a file:// url (especially an editable one) mutates the directory poitned to by the file:// url
2014-04-03T05:09:11  <dstufft> so we had lots of non deterministic tests that would fail depending on what order they ran in
2014-04-03T05:09:36  <dstufft> also for awhile we had pytest-xdist running to speed things up, which was lol when trying to run two tests at the same time that both wanted to mutate the same directory
2014-04-03T05:09:40  <clarkb> StevenK: I approve of M summit in sydney
2014-04-03T05:09:41  *** ArxCruz has quit IRC
2014-04-03T05:09:47  <clarkb> StevenK: now we just have to make it so
2014-04-03T05:09:56  <clarkb> dstufft: nice
2014-04-03T05:10:03  <tchaypo> How far away is M?
2014-04-03T05:10:09  <clarkb> dstufft: /me knows how that goes having made things work with testr
2014-04-03T05:10:14  <tchaypo> because at the moment our convention center is a tent on a barge
2014-04-03T05:10:22  <clarkb> tchaypo: we are doing J in atlanta
2014-04-03T05:10:37  <dstufft> we don't have pytest-xdist anymore because it thought it was cool to randomly error during collection
2014-04-03T05:10:40  <tchaypo> and our exhibition center is a tent that you can only access by taking a train to central and then transferring to a bus
2014-04-03T05:10:41  <dstufft> :/
2014-04-03T05:10:52  <clarkb> K - paris, L - wherever, M - Sydney
2014-04-03T05:11:00  <tchaypo> so M is november next year?
2014-04-03T05:11:04  <tchaypo> not going to work
2014-04-03T05:11:13  <tchaypo> Try 2016, we might have facilities by then
2014-04-03T05:11:14  <clarkb> tchaypo: don't crush my dreams
2014-04-03T05:11:33  <clarkb> tchaypo: maybe we can get away with a hotel conference center and just do the design summit in sydney
2014-04-03T05:11:42  <clarkb> the conference can go to a big conference center
2014-04-03T05:12:05  *** yamahata has quit IRC
2014-04-03T05:12:06  <tchaypo> I still think we should get RH to host the mid-cycle in Brisbane in the week after pycon-au
2014-04-03T05:12:13  <tchaypo> complaints from seattleites aside
2014-04-03T05:12:29  *** alff has joined #openstack-infra
2014-04-03T05:12:29  *** yamahata has joined #openstack-infra
2014-04-03T05:12:30  *** alff_ has joined #openstack-infra
2014-04-03T05:12:32  *** VijayTripathi has joined #openstack-infra
2014-04-03T05:12:38  <clarkb> tchaypo: Brisbane sounds infinitely better than sunnyvale
2014-04-03T05:16:16  <jhesketh> hypothetically, if pycon-au wasn't going to have an openstack miniconf (but still have openstack content in the main conference), would that affect a mid-cycle plans?
2014-04-03T05:17:37  <tchaypo> jhesketh: my understanding is that there will be a mid-cycle; the timing and venue will be determined by who wants to host
2014-04-03T05:18:20  <tchaypo> I'm suggesting brisbane after pycon because it would be nice for me, but we'd have to find someone who can host 40+ for a week (assuming attendance is similar to sunnyvale)
2014-04-03T05:18:48  <jhesketh> well there's a good chance we can get the pycon-au organisers to help
2014-04-03T05:18:53  <jhesketh> or somebody to sponsor
2014-04-03T05:19:22  <tchaypo> to be clear, this is tripleo we're talking about, not openstack generally
2014-04-03T05:19:34  <jhesketh> ah okay
2014-04-03T05:20:50  <clarkb> tchaypo: that said, the seattle office is much changed
2014-04-03T05:20:59  <clarkb> tchaypo: and has room for people
2014-04-03T05:21:08  <tchaypo> does it have guest wifi?
2014-04-03T05:21:13  <clarkb> yup
2014-04-03T05:21:27  <tchaypo> that's unexpected
2014-04-03T05:21:37  <tchaypo> can we roll that out to all the other offices?
2014-04-03T05:21:39  <clarkb> we'e even got the super secret network
2014-04-03T05:21:47  <clarkb> but apparently we can't use that for guests or something
2014-04-03T05:23:01  *** sdake has joined #openstack-infra
2014-04-03T05:24:08  *** mrmartin has quit IRC
2014-04-03T05:24:18  <clarkb> you know I wonder if we could get them to make a temporary secret network for things like that
2014-04-03T05:24:37  <clarkb> setup a second ssid on a different vlan and pipe that through the same NAT
2014-04-03T05:24:56  <clarkb> or just make it a permanent secret network with weekly passphrase changes
2014-04-03T05:26:44  *** wenlock_ has joined #openstack-infra
2014-04-03T05:26:46  <lifeless> super secret network ?
2014-04-03T05:27:36  <clarkb> melody
2014-04-03T05:28:44  *** asettle has quit IRC
2014-04-03T05:31:45  *** alff_ has quit IRC
2014-04-03T05:31:45  *** alff has quit IRC
2014-04-03T05:32:29  *** harlowja is now known as harlowja_away
2014-04-03T05:37:54  <jhesketh> fungi: ping
2014-04-03T05:38:21  <clarkb> jhesketh: it is 1:30am EDT for fungi right now
2014-04-03T05:38:41  <jhesketh> yeah, wasn't necessarily expecting a response :p
2014-04-03T05:45:05  <mattoliverau> If there is a mid-cycle in Brisbane, we should move it to the goldcoast, rent out wet and wild, and then everybody will want to come :) Water slides, sun, and openstack, what could be better ;)
2014-04-03T05:49:01  *** LinuxJedi has joined #openstack-infra
2014-04-03T05:52:34  *** CaptTofu has joined #openstack-infra
2014-04-03T05:56:32  <mattoliverau> I'm off, cya all tomorrow.
2014-04-03T05:57:01  *** andreaf2 has joined #openstack-infra
2014-04-03T05:58:08  *** nicedice has quit IRC
2014-04-03T06:02:40  *** gokrokve has quit IRC
2014-04-03T06:02:42  <openstackgerrit> Marc Abramowitz proposed a change to openstack-infra/jenkins-job-builder: Small documentation tweaks  https://review.openstack.org/84950
2014-04-03T06:04:54  *** jlibosva has joined #openstack-infra
2014-04-03T06:05:49  *** denis_makogon has joined #openstack-infra
2014-04-03T06:06:09  *** alex-away is now known as asettle
2014-04-03T06:06:33  *** yolanda has joined #openstack-infra
2014-04-03T06:07:22  <tchaypo> dstufft: rebased
2014-04-03T06:08:51  *** andreaf has quit IRC
2014-04-03T06:12:36  *** andreaf2 has quit IRC
2014-04-03T06:13:04  *** thuc has joined #openstack-infra
2014-04-03T06:14:48  *** ildikov_ has quit IRC
2014-04-03T06:16:38  *** wenlock_ has quit IRC
2014-04-03T06:17:37  *** thuc has quit IRC
2014-04-03T06:31:10  *** _nadya_ has joined #openstack-infra
2014-04-03T06:33:22  *** gokrokve has joined #openstack-infra
2014-04-03T06:33:36  *** andreaf has joined #openstack-infra
2014-04-03T06:35:59  <andreaf> jeblair: good morning - I updated https://review.openstack.org/#/c/79314/, thanks for your review. Could you have another look at it?
2014-04-03T06:36:01  *** matsuhashi has quit IRC
2014-04-03T06:36:38  *** mrmartin has joined #openstack-infra
2014-04-03T06:37:37  *** CaptTofu has quit IRC
2014-04-03T06:38:12  *** CaptTofu has joined #openstack-infra
2014-04-03T06:39:16  *** matsuhashi has joined #openstack-infra
2014-04-03T06:42:16  *** yolanda has quit IRC
2014-04-03T06:42:53  *** CaptTofu has quit IRC
2014-04-03T06:43:18  *** gokrokve has quit IRC
2014-04-03T06:44:47  *** _nadya_ has quit IRC
2014-04-03T06:45:21  *** _nadya_ has joined #openstack-infra
2014-04-03T06:48:02  *** sdake has quit IRC
2014-04-03T06:49:37  *** _nadya_ has quit IRC
2014-04-03T06:50:31  *** tianst20 has joined #openstack-infra
2014-04-03T06:51:35  *** alff_ has joined #openstack-infra
2014-04-03T06:51:35  *** alff has joined #openstack-infra
2014-04-03T06:52:36  *** masayukig has quit IRC
2014-04-03T06:52:56  *** jpich has joined #openstack-infra
2014-04-03T06:54:27  *** e0ne has joined #openstack-infra
2014-04-03T06:54:43  *** VijayTripathi has quit IRC
2014-04-03T06:56:03  *** afazekas has joined #openstack-infra
2014-04-03T06:56:04  <lifeless> clarkb: no leaks so far, will check later still
2014-04-03T06:57:03  *** mrda is now known as mrda_away
2014-04-03T07:02:36  *** asettle is now known as alex-gone
2014-04-03T07:04:29  *** zigo has quit IRC
2014-04-03T07:05:15  *** sdague has quit IRC
2014-04-03T07:05:40  *** sdague has joined #openstack-infra
2014-04-03T07:07:58  *** markwash_ has joined #openstack-infra
2014-04-03T07:08:04  *** zigo has joined #openstack-infra
2014-04-03T07:08:17  *** markwash has quit IRC
2014-04-03T07:08:17  *** markwash_ is now known as markwash
2014-04-03T07:10:38  *** mikal has quit IRC
2014-04-03T07:10:46  *** mikal has joined #openstack-infra
2014-04-03T07:10:58  *** mattoliverau has quit IRC
2014-04-03T07:13:11  *** ildikov_ has joined #openstack-infra
2014-04-03T07:14:05  *** mattoliverau has joined #openstack-infra
2014-04-03T07:19:39  *** alff_ has quit IRC
2014-04-03T07:19:39  *** alff has quit IRC
2014-04-03T07:22:30  *** jgallard has joined #openstack-infra
2014-04-03T07:22:38  *** mattoliverau has quit IRC
2014-04-03T07:25:14  *** e0ne_ has joined #openstack-infra
2014-04-03T07:26:05  *** mattoliverau has joined #openstack-infra
2014-04-03T07:28:05  *** che-arne has quit IRC
2014-04-03T07:29:08  *** e0ne has quit IRC
2014-04-03T07:29:34  *** hashar has joined #openstack-infra
2014-04-03T07:29:37  *** marun is now known as marun_afk
2014-04-03T07:35:08  *** roeyc has joined #openstack-infra
2014-04-03T07:40:07  *** gokrokve has joined #openstack-infra
2014-04-03T07:45:10  *** gokrokve has quit IRC
2014-04-03T07:59:42  *** mihgen has quit IRC
2014-04-03T08:05:06  *** derekh has joined #openstack-infra
2014-04-03T08:08:25  *** yassine has joined #openstack-infra
2014-04-03T08:16:45  *** locke105 has quit IRC
2014-04-03T08:16:47  *** fbo_away is now known as fbo
2014-04-03T08:30:08  *** denis_makogon has quit IRC
2014-04-03T08:31:08  *** hashar has quit IRC
2014-04-03T08:33:24  *** derekh has quit IRC
2014-04-03T08:34:55  *** mihgen has joined #openstack-infra
2014-04-03T08:37:39  *** dizquierdo has joined #openstack-infra
2014-04-03T08:40:45  *** gokrokve has joined #openstack-infra
2014-04-03T08:44:58  *** gokrokve has quit IRC
2014-04-03T08:45:13  *** pblaho has joined #openstack-infra
2014-04-03T08:46:23  *** jp_at_hp has joined #openstack-infra
2014-04-03T08:47:21  *** gpocentek has quit IRC
2014-04-03T08:47:21  *** gpocentek has joined #openstack-infra
2014-04-03T08:48:33  *** roeyc has quit IRC
2014-04-03T08:52:50  *** hashar has joined #openstack-infra
2014-04-03T08:54:17  *** e0ne_ has quit IRC
2014-04-03T08:55:13  *** e0ne has joined #openstack-infra
2014-04-03T08:55:54  <davidlenwell> that is a new one to me .. I got "unstable" in the gate on a review that was just an rst file..
2014-04-03T08:56:21  *** che-arne has joined #openstack-infra
2014-04-03T09:00:50  *** Hal has joined #openstack-infra
2014-04-03T09:00:59  *** Hal is now known as Guest78329
2014-04-03T09:02:10  <Guest78329> Hi ! Is someone here could help me understand strange dates (uploaded vs updated) on a patchset review : https://review.openstack.org/#/c/28018/. The uploaded date is post updated one. Stange or feature ?
2014-04-03T09:04:04  *** markmc has joined #openstack-infra
2014-04-03T09:05:10  *** yolanda has joined #openstack-infra
2014-04-03T09:07:20  *** matsuhashi has quit IRC
2014-04-03T09:08:43  *** e0ne_ has joined #openstack-infra
2014-04-03T09:09:59  *** jcoufal has quit IRC
2014-04-03T09:10:36  *** jcoufal has joined #openstack-infra
2014-04-03T09:12:25  *** e0ne has quit IRC
2014-04-03T09:12:54  *** matsuhashi has joined #openstack-infra
2014-04-03T09:13:48  *** ams0 has joined #openstack-infra
2014-04-03T09:15:11  *** morganfainberg is now known as morganfainberg_Z
2014-04-03T09:21:21  <openstackgerrit> Nikita Konovalov proposed a change to openstack-infra/storyboard: Fix token validation  https://review.openstack.org/84965
2014-04-03T09:23:08  *** ociuhandu has quit IRC
2014-04-03T09:25:09  *** reed has joined #openstack-infra
2014-04-03T09:28:56  <SergeyLukjanov> davidlenwell, probably, it was an issue with running job itself, just recheck
2014-04-03T09:29:13  <davidlenwell> I did .. it merged clean .. thanks ..
2014-04-03T09:29:43  <davidlenwell> SergeyLukjanov: sometimes I just make noise when I see something like that .. thanks for responding
2014-04-03T09:33:24  *** derekh has joined #openstack-infra
2014-04-03T09:34:30  <SergeyLukjanov> davidlenwell, np, it happens sometimes
2014-04-03T09:41:30  *** gokrokve has joined #openstack-infra
2014-04-03T09:42:41  *** cyeoh has quit IRC
2014-04-03T09:43:43  *** cyeoh has joined #openstack-infra
2014-04-03T09:45:58  *** gokrokve has quit IRC
2014-04-03T09:47:43  *** ociuhandu has joined #openstack-infra
2014-04-03T09:48:39  *** yassine has quit IRC
2014-04-03T09:59:39  *** matsuhashi has quit IRC
2014-04-03T09:59:56  *** matsuhashi has joined #openstack-infra
2014-04-03T10:01:09  *** ArxCruz has joined #openstack-infra
2014-04-03T10:01:14  *** ArxCruz has quit IRC
2014-04-03T10:06:31  <Guest78329> No idea on the origin of theses dates incoherence ?
2014-04-03T10:09:13  *** fbo is now known as fbo_away
2014-04-03T10:13:02  <SergeyLukjanov> Guest78329, hmmm, /me looking
2014-04-03T10:13:49  <Guest78329> SergeyLukjanov: thanks :-)
2014-04-03T10:14:08  <SergeyLukjanov> Guest78329, probably, it's time when quantum -> neutron gerrit projects rename was happened
2014-04-03T10:14:09  *** wenlock has quit IRC
2014-04-03T10:15:19  <SergeyLukjanov> Guest78329, yup, here is an example, the same upload date for
2014-04-03T10:15:20  <SergeyLukjanov> https://review.openstack.org/#/c/32922/
2014-04-03T10:16:14  <Guest78329> ha, interesting.
2014-04-03T10:16:41  <Guest78329> Do you think there is a way to retrieve the original upload date ?
2014-04-03T10:17:47  *** alexpilotti has joined #openstack-infra
2014-04-03T10:18:28  <SergeyLukjanov> Guest78329, datetime of the first comment should be very near to the upload datetime (same day I think)
2014-04-03T10:19:04  <SergeyLukjanov> Guest78329, I think it's quite normal that it was backported and approved the same day
2014-04-03T10:21:57  <Guest78329> SergeyLukjanov: you are right, it is the same workaround reviewstats is using for submission time estimation, the first review is usualy Jenkins one. I was looking for a more direct metadata usage. If you think there is no other way to do it via gerrit, I think the first comment date usage is the most effective workaround (another could be using the internal git branch log, exact date, expensive algo)
2014-04-03T10:22:05  *** chandankumar_ has joined #openstack-infra
2014-04-03T10:22:35  <Guest78329> SergeyLukjanov: So do you think there is no other way ?
2014-04-03T10:23:16  <SergeyLukjanov> Guest78329, /me don't see any other option atm
2014-04-03T10:23:49  <Guest78329> SergeyLukjanov: thank you very much for the advice and the quick response :)
2014-04-03T10:24:34  <SergeyLukjanov> Guest78329, np
2014-04-03T10:29:28  *** Guest78329 has quit IRC
2014-04-03T10:30:39  *** e0ne_ has quit IRC
2014-04-03T10:33:45  *** hashar has quit IRC
2014-04-03T10:37:18  *** jgallard has quit IRC
2014-04-03T10:38:53  <sdague> morning SergeyLukjanov
2014-04-03T10:39:03  <SergeyLukjanov> sdague, morning
2014-04-03T10:39:10  <SergeyLukjanov> sdague, how are you?
2014-04-03T10:39:28  <sdague> good, almost time for 2nd cup of coffee
2014-04-03T10:40:12  <sdague> also excited that someone else seems to be using my devstack-vagrant project, because I got a pull request - https://github.com/sdague/devstack-vagrant/pull/1
2014-04-03T10:40:52  <SergeyLukjanov> oh, I forget about lunch :(
2014-04-03T10:41:06  <SergeyLukjanov> sdague, nice, looking on it
2014-04-03T10:41:38  <SergeyLukjanov> sdague, mmm, multinode devstack locally
2014-04-03T10:42:13  *** gokrokve has joined #openstack-infra
2014-04-03T10:43:25  <SergeyLukjanov> sdague, you can setup vagrant proxy caching to speed up re-build - http://fgrehm.viewdocs.io/vagrant-cachier
2014-04-03T10:45:29  <sdague> I usually just build a mostly built box and stick it on my local http server
2014-04-03T10:46:28  *** gokrokve has quit IRC
2014-04-03T10:46:32  <sdague> it will build from a pure upstream 12.04 for easy of use, but if recapture the guest after first build then I save about 12 minutes build time
2014-04-03T10:47:37  <SergeyLukjanov> sdague, cool
2014-04-03T10:48:12  *** Ryan_Lane has quit IRC
2014-04-03T10:48:35  <openstackgerrit> Sergey Lukjanov proposed a change to openstack-infra/devstack-gate: Prepare for Juno dev  https://review.openstack.org/83075
2014-04-03T10:48:47  *** matsuhashi has quit IRC
2014-04-03T10:48:56  *** reed has quit IRC
2014-04-03T10:49:53  <SergeyLukjanov> I should rebase it on https://review.openstack.org/#/c/84287/3/devstack-vm-gate.sh
2014-04-03T10:49:57  <SergeyLukjanov> sdague, correct?
2014-04-03T10:51:03  <SergeyLukjanov> and is it ok to approve https://review.openstack.org/#/c/84287/3/devstack-vm-gate.sh?
2014-04-03T10:51:55  <sdague> I believe https://review.openstack.org/#/c/84287/3 is safe
2014-04-03T10:52:14  <sdague> if you double check my logic to make sure that I didn't drop anything, that would be good
2014-04-03T10:52:35  <sdague> SergeyLukjanov: and yes, I think rebasing on that change is the right thing to do
2014-04-03T10:53:00  <SergeyLukjanov> sdague, going to re-check and approve and then rebase
2014-04-03T10:53:48  <sdague> we're still going to have to wait for stable/icehouse devstack before we approve https://review.openstack.org/83075, which is going to be 2 weeks.
2014-04-03T10:54:46  <SergeyLukjanov> sdague, yup
2014-04-03T10:55:07  <SergeyLukjanov> sdague, your patch adds n-cond while there we no n-cond before
2014-04-03T10:55:20  *** Clabbe has joined #openstack-infra
2014-04-03T10:55:57  *** matsuhashi has joined #openstack-infra
2014-04-03T10:56:03  <sdague> it wasn't in the base list
2014-04-03T10:56:14  <sdague> because it was not in grizzly?
2014-04-03T10:56:21  <sdague> that can't be right
2014-04-03T10:56:36  <SergeyLukjanov> sdague, oh, sorry
2014-04-03T10:56:50  <sdague> yeh, it was at the end of L37
2014-04-03T10:56:50  <SergeyLukjanov> sdague, it was in the end of line 37
2014-04-03T10:57:02  <sdague> that was one of the reasons for the variable reorg
2014-04-03T10:57:11  <sdague> so all the services were logically grouped
2014-04-03T10:57:32  <SergeyLukjanov> yeah, that's a good idea
2014-04-03T10:58:09  <SergeyLukjanov> sdague, is it correct that you'd like to remove sysstat and pidstat?
2014-04-03T10:58:23  <sdague> yes
2014-04-03T10:58:39  <sdague> they were deleted from devstack
2014-04-03T10:58:51  <SergeyLukjanov> oh, got it
2014-04-03T10:59:06  <sdague> dstat is just much nicer
2014-04-03T10:59:22  <sdague> and written in python so easy to extend if we want to do better stats
2014-04-03T11:00:17  <SergeyLukjanov> yeah, agreed
2014-04-03T11:00:32  <SergeyLukjanov> it seems really good to use dstat IMO
2014-04-03T11:02:35  <SergeyLukjanov> sdague, looks like it's not good to remove "cinder" from services
2014-04-03T11:02:36  <SergeyLukjanov> [~/workspace/openstack-dev/devstack] ➜  grep -irn "enable.*cinder" . | grep -v .git                                          [master] [15:01:26]
2014-04-03T11:02:36  <SergeyLukjanov> ./exercises/boot_from_volume.sh:45:is_service_enabled cinder || exit 55
2014-04-03T11:02:36  <SergeyLukjanov> ./exercises/volumes.sh:42:is_service_enabled cinder || exit 55
2014-04-03T11:02:36  <SergeyLukjanov> ./lib/cinder:163:    if is_service_enabled cinder; then
2014-04-03T11:02:37  <SergeyLukjanov> ./lib/nova:471:    if is_service_enabled cinder; then
2014-04-03T11:02:38  <SergeyLukjanov> ./stack.sh:727:if is_service_enabled cinder; then
2014-04-03T11:02:39  <SergeyLukjanov> ./stack.sh:1024:if is_service_enabled cinder; then
2014-04-03T11:02:40  <SergeyLukjanov> ./stack.sh:1193:if is_service_enabled cinder; then
2014-04-03T11:02:41  <SergeyLukjanov> ./unstack.sh:133:if is_service_enabled cinder; then
2014-04-03T11:04:05  <sdague> hmmmm
2014-04-03T11:04:24  <sdague> how did it pass?
2014-04-03T11:04:58  <sdague> also, thanks for catching that
2014-04-03T11:08:21  <StevenK> SergeyLukjanov: git grep ? :-0
2014-04-03T11:08:24  <StevenK> :-) even
2014-04-03T11:09:17  *** afazekas has quit IRC
2014-04-03T11:09:25  *** e0ne has joined #openstack-infra
2014-04-03T11:09:43  <openstackgerrit> A change was merged to openstack-infra/devstack-gate: Correcting the right path to mysql log in Fedora 19  https://review.openstack.org/79967
2014-04-03T11:11:34  *** e0ne_ has joined #openstack-infra
2014-04-03T11:12:46  <SergeyLukjanov> StevenK, I'm always forgetting about git grep when running grep ;)
2014-04-03T11:13:23  *** e0ne__ has joined #openstack-infra
2014-04-03T11:13:53  *** e0ne_ has quit IRC
2014-04-03T11:13:54  *** e0ne has quit IRC
2014-04-03T11:15:01  *** matsuhashi has quit IRC
2014-04-03T11:15:06  <lifeless> Clabbe: still no leaks, so I think thats good
2014-04-03T11:15:26  <SergeyLukjanov> sdague, there are the same usages for nova and glance
2014-04-03T11:15:38  *** matsuhashi has joined #openstack-infra
2014-04-03T11:17:11  <sdague> SergeyLukjanov: is_service_enabled nova should do the right thing
2014-04-03T11:17:28  <sdague> I guess we just don't have the is_cinder_enabled script yet
2014-04-03T11:17:39  *** hashar has joined #openstack-infra
2014-04-03T11:17:41  <sdague> I'll fix d-g
2014-04-03T11:18:00  *** e0ne__ has quit IRC
2014-04-03T11:19:34  *** matsuhashi has quit IRC
2014-04-03T11:20:57  *** yassine has joined #openstack-infra
2014-04-03T11:21:38  *** matsuhashi has joined #openstack-infra
2014-04-03T11:21:58  *** yjiang has quit IRC
2014-04-03T11:22:30  *** zhiyan_ is now known as zhiyan
2014-04-03T11:24:01  *** afazekas has joined #openstack-infra
2014-04-03T11:25:52  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: normalize the services for a post grizzly world  https://review.openstack.org/84287
2014-04-03T11:26:00  <sdague> SergeyLukjanov: there we go
2014-04-03T11:26:04  <sdague> thanks for the catch
2014-04-03T11:26:52  <SergeyLukjanov> sdague, np, I'm glad to be useful here ;)
2014-04-03T11:27:38  <anteaya> mattoliverau: I like the way you think, and I can get behind a tent on a barge
2014-04-03T11:31:18  *** jcoufal has quit IRC
2014-04-03T11:32:35  <sdague> anteaya: I clearly missed an interesting conversation :)
2014-04-03T11:35:27  *** jgallard has joined #openstack-infra
2014-04-03T11:36:30  *** jgallard has quit IRC
2014-04-03T11:36:47  *** jgallard has joined #openstack-infra
2014-04-03T11:38:09  *** mbacchi has joined #openstack-infra
2014-04-03T11:41:58  *** dcramer_ has quit IRC
2014-04-03T11:42:03  *** e0ne has joined #openstack-infra
2014-04-03T11:43:05  *** gokrokve has joined #openstack-infra
2014-04-03T11:44:19  *** mbacchi has quit IRC
2014-04-03T11:45:06  *** rfolco has joined #openstack-infra
2014-04-03T11:47:11  *** HenryG has joined #openstack-infra
2014-04-03T11:48:08  *** gokrokve has quit IRC
2014-04-03T11:48:57  *** flaper87|afk is now known as flaper87
2014-04-03T11:48:59  *** talluri has quit IRC
2014-04-03T11:51:10  <anteaya> sdague: 'tis in the backscroll
2014-04-03T11:51:46  <anteaya> one way or another, pencil some part of austrailia into your upcoming iternerary
2014-04-03T11:52:19  <anteaya> clarkb wants Sydney for M
2014-04-03T11:52:32  <anteaya> which might end up being a tent on a barge
2014-04-03T11:52:38  <anteaya> which has a nice sound to it
2014-04-03T11:52:57  *** matsuhashi has quit IRC
2014-04-03T11:53:03  <anteaya> and mattoliverau figures if we hit oz for mid-cycle we might as well rent a waterpark for the day
2014-04-03T11:53:51  <sdague> nice
2014-04-03T11:54:20  <sdague> Nov 2016 in Sydney would be cool
2014-04-03T11:54:28  <sdague> Nov 2015 in Sydney would be cool
2014-04-03T11:54:32  <sdague> stupid maths
2014-04-03T11:55:28  <anteaya> we could do it twice in a row
2014-04-03T11:55:34  <anteaya> double header
2014-04-03T11:55:58  *** mbacchi has joined #openstack-infra
2014-04-03T11:56:11  *** yaguang has quit IRC
2014-04-03T11:56:34  *** weshay has joined #openstack-infra
2014-04-03T12:00:49  *** mriedem has joined #openstack-infra
2014-04-03T12:05:59  *** dmsimard has joined #openstack-infra
2014-04-03T12:06:07  <dmsimard> Hi guys
2014-04-03T12:09:00  <dmsimard> http://logs.openstack.org/79/81179/6/check/gate-puppet-ceph-puppet-lint/a7d1339/console.html
2014-04-03T12:09:14  <dmsimard> "http://logs.openstack.org/79/81179/6/check/gate-puppet-ceph-puppet-lint/a7d1339/console.html#_2014-04-02_03_02_52_942 | no such file to load -- rspec-system/rake_task"
2014-04-03T12:09:27  *** gokrokve has joined #openstack-infra
2014-04-03T12:09:28  <dmsimard> Yet the test passed ?
2014-04-03T12:09:34  <dmsimard> It should have failed, no ?
2014-04-03T12:10:01  *** yamahata has quit IRC
2014-04-03T12:10:04  *** StevenK_ has joined #openstack-infra
2014-04-03T12:10:35  *** fbo_away is now known as fbo
2014-04-03T12:10:54  *** mrodden has quit IRC
2014-04-03T12:10:55  *** mrodden has joined #openstack-infra
2014-04-03T12:10:56  *** StevenK has quit IRC
2014-04-03T12:13:38  *** gokrokve has quit IRC
2014-04-03T12:15:19  *** persia has quit IRC
2014-04-03T12:15:26  *** persia has joined #openstack-infra
2014-04-03T12:15:50  *** persia is now known as Guest57160
2014-04-03T12:20:02  *** ArxCruz has joined #openstack-infra
2014-04-03T12:21:27  *** pdmars has joined #openstack-infra
2014-04-03T12:21:36  <anteaya> hi dmsimard I'm not familar with the expectations of that test, you might try the core for that project: https://review.openstack.org/#/admin/groups/226,members
2014-04-03T12:21:49  *** pdmars has quit IRC
2014-04-03T12:22:15  <dmsimard> I'm a core :)
2014-04-03T12:22:16  *** pdmars has joined #openstack-infra
2014-04-03T12:22:32  <dmsimard> I'll check the test definitions more thoroughly
2014-04-03T12:23:54  *** david-lyle has quit IRC
2014-04-03T12:25:20  <anteaya> okay
2014-04-03T12:26:09  *** aysyd has joined #openstack-infra
2014-04-03T12:26:22  *** jhesketh has quit IRC
2014-04-03T12:26:49  *** yolanda has quit IRC
2014-04-03T12:30:06  *** che-arne has quit IRC
2014-04-03T12:31:16  *** che-arne has joined #openstack-infra
2014-04-03T12:32:40  *** che-arne has quit IRC
2014-04-03T12:33:36  *** che-arne has joined #openstack-infra
2014-04-03T12:35:12  <fungi> dmsimard: you probably want to prepend #!/bin/bash -xe on the builder at http://git.openstack.org/cgit/openstack-infra/config/tree/modules/openstack_project/files/jenkins_job_builder/config/macros.yaml#n77
2014-04-03T12:35:56  <fungi> assuming the other commands in the builder are expected to exit 0 under normal conditions as well
2014-04-03T12:36:23  *** Guest57160 has quit IRC
2014-04-03T12:36:23  *** Guest57160 has joined #openstack-infra
2014-04-03T12:36:46  *** Guest57160 is now known as persia
2014-04-03T12:37:14  <fungi> dmsimard: though since rake lint is the last line of that shell snippet, it shouldn't be necessary to catch that particular failure
2014-04-03T12:37:42  <fungi> dmsimard: what are the chances that when rake lint can't find rspec-system/rake_task it exits 0?
2014-04-03T12:37:56  <fungi> that would certainly explain the behavior you're seeing
2014-04-03T12:38:31  *** che-arne has quit IRC
2014-04-03T12:38:41  <dmsimard> yeah, I'll talk with mgagne or bodepd who are more familiar with that particular job, see what we can do. It's a common job so I have to be especially careful :)
2014-04-03T12:40:17  *** miqui has joined #openstack-infra
2014-04-03T12:40:57  *** yolanda has joined #openstack-infra
2014-04-03T12:42:25  *** xchu_ has joined #openstack-infra
2014-04-03T12:46:16  *** ameade has joined #openstack-infra
2014-04-03T12:50:48  *** nosnos has quit IRC
2014-04-03T12:53:04  *** eharney has joined #openstack-infra
2014-04-03T12:53:33  <openstackgerrit> A change was merged to openstack-infra/config: Drop max-servers to 40 for tripleo HP region.  https://review.openstack.org/84903
2014-04-03T12:54:18  *** thuc has joined #openstack-infra
2014-04-03T12:54:56  *** thuc_ has joined #openstack-infra
2014-04-03T12:55:17  *** dprince has joined #openstack-infra
2014-04-03T12:58:02  *** che-arne has joined #openstack-infra
2014-04-03T12:58:25  *** thuc has quit IRC
2014-04-03T13:00:49  *** yaguang has joined #openstack-infra
2014-04-03T13:01:28  *** mancdaz has quit IRC
2014-04-03T13:01:54  *** mancdaz has joined #openstack-infra
2014-04-03T13:02:04  *** lcostantino has joined #openstack-infra
2014-04-03T13:02:24  *** StevenK_ is now known as StevenK
2014-04-03T13:03:15  *** adalbas has quit IRC
2014-04-03T13:04:04  *** adalbas has joined #openstack-infra
2014-04-03T13:05:41  <sdague> just when I thought I understood the oslo.config breaks, I found a new edge condition
2014-04-03T13:07:08  *** dims_ has quit IRC
2014-04-03T13:07:33  *** maxbit has joined #openstack-infra
2014-04-03T13:07:48  <fungi> sdague: oslo.config has sharp edges in more than 3 dimensions
2014-04-03T13:08:09  <fungi> we need a hyperspatial map to explore them adequately
2014-04-03T13:09:25  *** dcramer_ has joined #openstack-infra
2014-04-03T13:09:34  *** zehicle_at_dell has quit IRC
2014-04-03T13:10:18  *** gokrokve has joined #openstack-infra
2014-04-03T13:10:23  <sdague> I totally need an occulus rift debugger for them
2014-04-03T13:10:44  *** jeckersb_gone is now known as jeckersb
2014-04-03T13:11:51  *** changbl has quit IRC
2014-04-03T13:14:36  *** gokrokve has quit IRC
2014-04-03T13:15:55  *** julim has joined #openstack-infra
2014-04-03T13:17:39  <fungi> i was thinking a skulljack--after all your eyes are really only interpreting 3 dimensions courtesy of parallax between a pair of two-dimensional surfaces
2014-04-03T13:19:12  *** che-arne has quit IRC
2014-04-03T13:19:18  *** chandankumar_ has quit IRC
2014-04-03T13:19:24  *** skraynev is now known as skraynev_afk
2014-04-03T13:19:45  *** Guest78329 has joined #openstack-infra
2014-04-03T13:20:41  *** dims_ has joined #openstack-infra
2014-04-03T13:20:49  *** rfolco has quit IRC
2014-04-03T13:21:59  *** zns has joined #openstack-infra
2014-04-03T13:22:48  *** rfolco has joined #openstack-infra
2014-04-03T13:23:07  *** signed8bit has joined #openstack-infra
2014-04-03T13:27:12  *** weshay has quit IRC
2014-04-03T13:30:08  *** weshay has joined #openstack-infra
2014-04-03T13:30:46  *** freyes has joined #openstack-infra
2014-04-03T13:31:56  *** thomasem has joined #openstack-infra
2014-04-03T13:37:47  <openstackgerrit> Ilya Shakhat proposed a change to openstack-infra/config: Add new stackforge project DriverLog  https://review.openstack.org/85033
2014-04-03T13:40:04  *** gondoi has quit IRC
2014-04-03T13:40:43  *** thuc_ has quit IRC
2014-04-03T13:40:54  *** gondoi has joined #openstack-infra
2014-04-03T13:41:19  *** thuc has joined #openstack-infra
2014-04-03T13:42:45  <dhellmann> sdague: what's this one?
2014-04-03T13:45:14  *** nkinder has quit IRC
2014-04-03T13:45:37  *** thuc has quit IRC
2014-04-03T13:45:54  *** jgrimm has quit IRC
2014-04-03T13:46:59  *** mihgen has quit IRC
2014-04-03T13:47:51  <sdague> the setup_install change from yesterday
2014-04-03T13:48:03  <sdague> seems to cause a grenade issue
2014-04-03T13:48:24  <sdague> because it's not doing pip install -U
2014-04-03T13:48:27  <sdague> only pip install
2014-04-03T13:48:47  <sdague> https://review.openstack.org/#/c/85027/
2014-04-03T13:50:28  *** hughsaunders has quit IRC
2014-04-03T13:52:06  *** ameade has quit IRC
2014-04-03T13:56:22  *** sdake__ is now known as sdake
2014-04-03T13:57:42  *** hughsaunders has joined #openstack-infra
2014-04-03T14:01:05  *** mwagner_lap has joined #openstack-infra
2014-04-03T14:01:47  *** german_ has joined #openstack-infra
2014-04-03T14:01:58  <ruhe> folks, this change https://review.openstack.org/#/c/80690/ (If dependency not in global reqs exit with a 1). is there any way to disable that check for particular gate job?
2014-04-03T14:02:01  <flaper87> how does one enable SSL in devstack ?
2014-04-03T14:05:38  *** ominakov has joined #openstack-infra
2014-04-03T14:05:53  <openstackgerrit> Ilya Shakhat proposed a change to openstack-infra/config: Add new stackforge project DriverLog  https://review.openstack.org/85033
2014-04-03T14:06:23  *** thuc has joined #openstack-infra
2014-04-03T14:07:04  <openstackgerrit> afazekas proposed a change to openstack-infra/elastic-recheck: Add query for a heat db error  https://review.openstack.org/85039
2014-04-03T14:09:37  *** che-arne has joined #openstack-infra
2014-04-03T14:10:29  <mtreinish> SergeyLukjanov: on https://review.openstack.org/#/c/84840/ the duplication is intentional
2014-04-03T14:10:44  <mtreinish> look at the follow-up patch which fixes the names for the duplicate jobs
2014-04-03T14:11:01  *** gokrokve has joined #openstack-infra
2014-04-03T14:14:20  *** wenlock has joined #openstack-infra
2014-04-03T14:15:14  *** xchu_ has quit IRC
2014-04-03T14:15:29  <andreaf> sdague, jeblair: could you have a look at https://review.openstack.org/#/c/79314/ - I'd like to start running the keystone v3 experimental checks
2014-04-03T14:15:48  *** gokrokve has quit IRC
2014-04-03T14:18:03  *** thedodd has joined #openstack-infra
2014-04-03T14:18:46  *** wenlock has quit IRC
2014-04-03T14:19:26  <dhellmann> the new job definitions for oslo mean we're running gate-{name}-docs, but some of the libs have their docs hosted on rtfd.org
2014-04-03T14:19:50  <dhellmann> I could fix it by copying the job definitions to all of those libs, or making a new template in layout.yaml and moving the docs jobs there
2014-04-03T14:19:56  <dhellmann> any preference for which approach is right?
2014-04-03T14:20:07  <dhellmann> maybe a dev-docs template?
2014-04-03T14:21:13  *** pblaho has quit IRC
2014-04-03T14:21:25  <jeblair> dhellmann: all openstack projects have docs hosted on docs.o.o/developer, so we should have gate-name-docs (which just verifies that they can build), but we should also have name-docs which publishes them there
2014-04-03T14:21:33  <openstackgerrit> Ilya Shakhat proposed a change to openstack-infra/config: Add new stackforge project DriverLog  https://review.openstack.org/85033
2014-04-03T14:22:04  <dhellmann> jeblair: ok, so are we still in requirements freeze? I would need to add Pillow and maybe some other libs. The stevedore docs use graphviz, too.
2014-04-03T14:22:27  <dhellmann> I suppose I could comment out the diagrams for now
2014-04-03T14:22:39  <jeblair> andreaf: can you change "check-" to "{pipeline}-" in the job names in the jjb definition?
2014-04-03T14:23:12  <jeblair> dhellmann: tbh, i don't know if we're in "test-requirements" freeze or if that's even a thing... :)  ttx?
2014-04-03T14:23:59  <andreaf> jeblair: but that would run in the experimental pipeline, is that ok? I checked other experimental jobs and they use check instead of {pipeline}#
2014-04-03T14:24:07  *** thuc_ has joined #openstack-infra
2014-04-03T14:24:09  *** markmcclain has joined #openstack-infra
2014-04-03T14:24:23  <jeblair> andreaf: it just defines the jobs, it doesn't necessarily run them
2014-04-03T14:24:39  *** jgrimm has joined #openstack-infra
2014-04-03T14:25:02  <andreaf> jeblair: do I have to define experimental-.... jobs then?
2014-04-03T14:25:21  *** vhoward- has joined #openstack-infra
2014-04-03T14:25:51  <jeblair> andreaf: nope, just change "check-" to "{pipeline}-" and the template invocation will create "check-" and "gate-" versions of the job.  you can ignore the gate version and leave "check-" as the job that's invoked in layout.yaml
2014-04-03T14:26:31  <andreaf> jeblair: right, got it, thanks
2014-04-03T14:27:01  *** chandan_kumar has quit IRC
2014-04-03T14:27:25  *** chandan_kumar has joined #openstack-infra
2014-04-03T14:27:39  *** gokrokve has joined #openstack-infra
2014-04-03T14:28:01  *** thuc has quit IRC
2014-04-03T14:28:09  <openstackgerrit> Doug Hellmann proposed a change to openstack/requirements: Add Pillow for stevedore doc build  https://review.openstack.org/85047
2014-04-03T14:28:18  *** thuc_ has quit IRC
2014-04-03T14:29:47  <ttx> jeblair: grey area. makes sense to freeze them as well since good packagers should run the tests so need to have test-deps packaged
2014-04-03T14:30:12  *** chandan_kumar has quit IRC
2014-04-03T14:30:33  <jeblair> ttx: thanks
2014-04-03T14:30:37  <dhellmann> ttx, jeblair : can I at least make that job non-voting for now? it's brand new -- yesterday
2014-04-03T14:30:39  *** afazekas has quit IRC
2014-04-03T14:30:51  <dhellmann> otherwise we won't be able to do any work on the cross-project gating jobs
2014-04-03T14:31:38  <ttx> dhellmann: sure, don't want that to block us too much
2014-04-03T14:31:54  <dhellmann> ok, good, I'll do that for now
2014-04-03T14:32:00  <dhellmann> the other changes are up for review, too, but those can wait
2014-04-03T14:33:16  *** alff has joined #openstack-infra
2014-04-03T14:33:16  *** alff_ has joined #openstack-infra
2014-04-03T14:33:39  *** esker has joined #openstack-infra
2014-04-03T14:35:50  <openstackgerrit> Andrea Frittoli  proposed a change to openstack-infra/config: Add experimental keystonev3 jobs  https://review.openstack.org/79314
2014-04-03T14:36:41  <andreaf> jeblair: done. thanks - I think I finally understood jjb :P
2014-04-03T14:36:58  *** CaptTofu has joined #openstack-infra
2014-04-03T14:37:51  <openstackgerrit> Derek Higgins proposed a change to openstack-infra/config: Add the second tripleo provider  https://review.openstack.org/83057
2014-04-03T14:38:19  *** nkinder has joined #openstack-infra
2014-04-03T14:38:36  *** weshay has quit IRC
2014-04-03T14:39:02  <fungi> ruhe: doesn't look like there's a toggle to skip that behavior--where is it exhibiting an issue?
2014-04-03T14:39:03  *** markwash has quit IRC
2014-04-03T14:39:16  <fungi> andreaf: see my comments on 79314
2014-04-03T14:39:36  <fungi> sorry i didn't catch you fast enough before you uploaded another patchset
2014-04-03T14:40:24  *** wenlock has joined #openstack-infra
2014-04-03T14:41:03  <andreaf> fungi: thanks for the review :) I'll fix it right away
2014-04-03T14:42:01  <fungi> andreaf: you're welcome!
2014-04-03T14:43:01  <openstackgerrit> Doug Hellmann proposed a change to openstack-infra/config: Disable gate-stevedore-docs  https://review.openstack.org/85055
2014-04-03T14:44:34  <dhellmann> jeblair, ttx: ^^
2014-04-03T14:44:39  <openstackgerrit> Andrea Frittoli  proposed a change to openstack-infra/config: Add experimental keystonev3 jobs  https://review.openstack.org/79314
2014-04-03T14:45:28  <andreaf> fungi, jeblair: ^^^ new patch-set up
2014-04-03T14:45:34  *** rlandy has joined #openstack-infra
2014-04-03T14:49:07  <openstackgerrit> Brant Knudson proposed a change to openstack/requirements: Remove pam  https://review.openstack.org/85058
2014-04-03T14:50:08  *** ameade has joined #openstack-infra
2014-04-03T14:51:35  *** vhoward- has left #openstack-infra
2014-04-03T14:52:16  *** yaguang has quit IRC
2014-04-03T14:52:34  *** mfer has joined #openstack-infra
2014-04-03T14:52:46  <dhellmann> ok, now the requirements check for cliff is complaining about duplicate requirements "in master" https://jenkins02.openstack.org/job/gate-cliff-requirements/1/console
2014-04-03T14:53:02  <dhellmann> I've submitted a change to remove the dupes, but it won't pass because the original files are broken?
2014-04-03T14:55:17  *** pcrews_ has joined #openstack-infra
2014-04-03T14:56:14  <openstackgerrit> Doug Hellmann proposed a change to openstack-infra/config: Disable broken oslo jobs  https://review.openstack.org/85055
2014-04-03T14:56:40  <dhellmann> updated the previous change to disable the cliff requirements job, too ^^
2014-04-03T14:57:48  <dhellmann> starting new libs is going to be a lot simpler than adopting existing projects like cliff and stevedore :-)
2014-04-03T14:58:10  *** thuc has joined #openstack-infra
2014-04-03T14:58:31  <openstackgerrit> Marc Abramowitz proposed a change to openstack-infra/jenkins-job-builder: Small documentation tweaks  https://review.openstack.org/84950
2014-04-03T14:58:45  *** thuc_ has joined #openstack-infra
2014-04-03T14:59:11  *** mihgen has joined #openstack-infra
2014-04-03T15:00:08  *** rlandy has quit IRC
2014-04-03T15:00:33  *** rlandy has joined #openstack-infra
2014-04-03T15:00:54  *** mgagne1 has quit IRC
2014-04-03T15:01:27  <fungi> dhellmann: we probably need to do something similar to https://review.openstack.org/84590
2014-04-03T15:02:06  <dhellmann> fungi: I *thought* I had seen something about that recently
2014-04-03T15:02:24  *** thuc has quit IRC
2014-04-03T15:02:26  <dhellmann> fungi: which is likely to land sooner? :-)
2014-04-03T15:02:41  <fungi> dhellmann: looks like there's already an ignore_dups flag, so maybe just add it to the correct read() call
2014-04-03T15:03:25  <dhellmann> fungi: ok, I'll see about adding that
2014-04-03T15:04:37  <fungi> dhellmann: i think it's just branch_reqs.read_all_requirements(ignore_dups=True)
2014-04-03T15:05:07  <fungi> oh, except that's not passed through from read_all_requirements()
2014-04-03T15:05:22  <fungi> dhellmann: i'll just amend my change to do that bit from the strict flag
2014-04-03T15:05:37  *** hashar has quit IRC
2014-04-03T15:05:48  <dhellmann> fungi: ok, cool
2014-04-03T15:08:43  *** weshay has joined #openstack-infra
2014-04-03T15:08:47  *** julienvey has left #openstack-infra
2014-04-03T15:11:03  *** atiwari has joined #openstack-infra
2014-04-03T15:11:08  <openstackgerrit> Jeremy Stanley proposed a change to openstack-infra/config: Requirements check should tolerate existing cruft  https://review.openstack.org/84590
2014-04-03T15:11:10  <fungi> dhellmann: ^ (added a little more explanation to the commit message too)
2014-04-03T15:11:44  *** dguerri_ is now known as _dguerri
2014-04-03T15:12:02  *** _dguerri is now known as dguerri_
2014-04-03T15:12:49  <dhellmann> fungi: why do we run those tests against master before merging in the proposed change?
2014-04-03T15:13:37  <fungi> dhellmann: due to an oversight... looks like slightly overzealous drying
2014-04-03T15:14:01  <dhellmann> you added strict=True on line 98, which I think is still going to cause cliff's job to fail
2014-04-03T15:14:09  <fungi> the same function gets used for reading the old and new copies to generate the dict
2014-04-03T15:14:12  *** david-lyle has joined #openstack-infra
2014-04-03T15:14:27  <fungi> but the style checks are performed in the read function
2014-04-03T15:14:31  <dhellmann> maybe I'm confused about the initial state of the repo
2014-04-03T15:14:40  <fungi> so this change turns the style checks off while reading the original
2014-04-03T15:15:03  <dhellmann> so the original values are read second? on line 103?
2014-04-03T15:15:06  *** VijayTripathi has joined #openstack-infra
2014-04-03T15:15:08  <fungi> s/generate the dict/generate the DIFF/
2014-04-03T15:15:15  <fungi> dhellmann: yes
2014-04-03T15:15:34  <dhellmann> ah, ok, I had it backwards :-)
2014-04-03T15:15:46  <fungi> head_reqs is from the git fetch head (your proposed change) and branch_reqs is from the target branch tip
2014-04-03T15:16:06  <fungi> i agree the variable names aren't exceedingly elucidating
2014-04-03T15:16:15  <dhellmann> ok, it makes sense now, I was just thinking of it happening in the other order and mis-reading the code as a result
2014-04-03T15:16:18  <dhellmann> +1
2014-04-03T15:16:20  <fungi> perhaps since i've sussed out the spaghetti there, i should add some comments
2014-04-03T15:16:44  <fungi> doing that now
2014-04-03T15:16:57  * dhellmann nods
2014-04-03T15:17:11  <fungi> because that makes at least three people i had to explain the code too, so i think that means it's not readable as is
2014-04-03T15:17:18  <fungi> er, to
2014-04-03T15:17:35  <fungi> took me a while of staring at it as well
2014-04-03T15:18:26  <dhellmann> my future self is constantly battling with my past self
2014-04-03T15:19:27  <dhellmann> and of course that leaves my present self stuck in the middle
2014-04-03T15:21:13  *** zns has quit IRC
2014-04-03T15:22:27  *** sdake_ has joined #openstack-infra
2014-04-03T15:22:27  *** sdake_ has quit IRC
2014-04-03T15:22:27  *** sdake_ has joined #openstack-infra
2014-04-03T15:24:51  *** zns has joined #openstack-infra
2014-04-03T15:25:50  *** zhiyan is now known as zhiyan_
2014-04-03T15:26:48  <openstackgerrit> Jeremy Stanley proposed a change to openstack-infra/config: Requirements check should tolerate existing cruft  https://review.openstack.org/84590
2014-04-03T15:26:49  <fungi> dhellmann: ^ now with comments![tm]
2014-04-03T15:28:37  <dhellmann> fungi: nice!
2014-04-03T15:28:48  *** yamahata has joined #openstack-infra
2014-04-03T15:29:02  <fungi> hopefully nobody need explain that script ever again
2014-04-03T15:30:01  <dhellmann> heh
2014-04-03T15:30:45  *** ams0 has quit IRC
2014-04-03T15:30:55  <dhellmann> fungi: if you think we can land your change today, I can keep the cliff requirements job voting
2014-04-03T15:31:35  <sandywalsh> hey guys, when adding people to a gerrit group, is there anything required for them other than a launchpad account?
2014-04-03T15:31:39  <fungi> dhellmann: if jeblair's cool with it, or mordred/clarkb/SergeyLukjanov happen to be around, it seems likely
2014-04-03T15:31:48  <sandywalsh> I have a user I'm trying to add that isn't getting found.
2014-04-03T15:32:23  <fungi> sandywalsh: their lp account name may not be the same as the gerrit account name they're authenticating with it
2014-04-03T15:32:56  *** mgagne has joined #openstack-infra
2014-04-03T15:33:09  <dhellmann> fungi: ok, I'll wait, and if yours merges I'll update my change so it only turns off the stevedore job that wasn't working
2014-04-03T15:33:13  <fungi> sandywalsh: gerrit only relies on lp accounts for openid authentication, and can import some details initially from the openid metadata the first time they log in
2014-04-03T15:33:25  <sandywalsh> fungi: k, I'll verify that. Thanks
2014-04-03T15:33:40  <fungi> sandywalsh: but some details (name, e-mail addresses, et cetera) can change in gerrit later
2014-04-03T15:33:56  <sandywalsh> fungi: gotcha
2014-04-03T15:33:57  <fungi> sandywalsh: similarly, they may make changes to lp after that which aren't reflected in gerrit
2014-04-03T15:34:26  <fungi> sandywalsh: and if they've never logged into gerrit, they won't necessarily have an account at all (that goes for pretty much any new accounts in the past year or so)
2014-04-03T15:34:41  *** mgagne1 has joined #openstack-infra
2014-04-03T15:34:48  *** mgagne1 has quit IRC
2014-04-03T15:34:48  *** mgagne1 has joined #openstack-infra
2014-04-03T15:35:05  <sandywalsh> fungi: that's what I suspect the problem is. I don't think they've logged in.
2014-04-03T15:35:38  *** MarkAtwood has quit IRC
2014-04-03T15:35:42  <fungi> if they never log into gerrit, probably no need for them to belong to any groups in it ;)
2014-04-03T15:35:45  *** rcleere has joined #openstack-infra
2014-04-03T15:36:00  <sandywalsh> yeah, that's for sure
2014-04-03T15:38:09  *** mgagne has quit IRC
2014-04-03T15:40:08  *** CaptTofu has quit IRC
2014-04-03T15:41:50  *** andreaf has quit IRC
2014-04-03T15:42:21  <derekh> Hi, just wondering why the check-tripleo-overcloud-f20 is coming is as NOT_REGISTERED? do I need to do anything else to start the job running? e.g. https://review.openstack.org/#/c/84876/
2014-04-03T15:43:46  *** che-arne has quit IRC
2014-04-03T15:44:21  <fungi> derekh: i think it means we're not getting (nor never have while the current jenkins master servers were running) any nodes building successfully for the node label that job wants
2014-04-03T15:45:19  <fungi> derekh: looks like we have no nodepool images for it
2014-04-03T15:45:30  *** zehicle has joined #openstack-infra
2014-04-03T15:45:41  <fungi> checking image logs now to see why. probably never built any successfully since the last time that cloud was rebuilt
2014-04-03T15:45:51  <derekh> fungi: ok, will take a look, the template images seem to be there at least,
2014-04-03T15:46:17  <derekh> fungi: tripleo-f20-1396318442.template.openstack.org
2014-04-03T15:46:19  <fungi> derekh: the base images?
2014-04-03T15:46:29  <fungi> oh, the template instance
2014-04-03T15:47:14  *** jgriffith has quit IRC
2014-04-03T15:47:30  <fungi> that template was created 02:14:02 utc tuesday
2014-04-03T15:47:42  <fungi> probably in the midst of the provider issues
2014-04-03T15:48:03  <fungi> i'll blow it away--it's a sign that the image build which was initiated on that try never completed
2014-04-03T15:48:14  <fungi> nodepool may have been restarted in the middle of it or something
2014-04-03T15:48:22  <derekh> fungi: ahh ok, thanks
2014-04-03T15:50:10  <fungi> oh... i was mis-grepping the lists. f20 not fedora
2014-04-03T15:50:58  <fungi> so we do have images, (from a couple days ago) just no new nodes building from them
2014-04-03T15:51:59  *** zns has joined #openstack-infra
2014-04-03T15:52:11  *** flaper87 is now known as flaper87|afk
2014-04-03T15:52:11  <SergeyLukjanov> morning folks
2014-04-03T15:52:52  *** jlibosva has quit IRC
2014-04-03T15:53:05  *** dguerri_ is now known as _dguerri
2014-04-03T15:53:11  *** zns has quit IRC
2014-04-03T15:53:20  <SergeyLukjanov> fungi, dhellmann, re https://review.openstack.org/#/c/84590/4: IIRC dup requirements will break pip install -r ...
2014-04-03T15:53:46  <fungi> SergeyLukjanov: agreed, but does that job try to pip install -r?
2014-04-03T15:53:56  *** zns has joined #openstack-infra
2014-04-03T15:54:11  *** zehicle has quit IRC
2014-04-03T15:54:14  <fungi> SergeyLukjanov: anyway, the point is to allow people to submit changes which remove the dupe requirements
2014-04-03T15:54:31  <dhellmann> SergeyLukjanov: right, we have dupes now but can't remove them because the job prevents the patch from landing
2014-04-03T15:54:46  <fungi> SergeyLukjanov: if the job bails on existing duplicated already on the branch without testing the proposed fix, then it leaves the problem unfixable
2014-04-03T15:54:53  <dhellmann> SergeyLukjanov: also, I think pip doesn't complain unless the requirements are different
2014-04-03T15:55:00  <SergeyLukjanov> fungi, agreed
2014-04-03T15:55:37  *** jgallard has quit IRC
2014-04-03T15:55:38  <fungi> SergeyLukjanov: so the intended outcome of this change is to not let new changes land *unless* they fix the dupes, trailing newlines, et cetera, but at least allow them to be fixed
2014-04-03T15:55:49  *** che-arne has joined #openstack-infra
2014-04-03T15:55:58  <SergeyLukjanov> fungi, sounds reasonable
2014-04-03T15:56:02  <fungi> the way the script is currently written, you can't merge a fix for those problems
2014-04-03T15:56:14  *** _dguerri is now known as dguerri_
2014-04-03T15:57:17  <SergeyLukjanov> fungi, +2 from me
2014-04-03T15:57:21  <SergeyLukjanov> dhellmann, ^^
2014-04-03T15:57:45  <dhellmann> SergeyLukjanov: thanks!
2014-04-03T15:58:03  <openstackgerrit> James E. Blair proposed a change to openstack-infra/zuul: Add subway map to status page  https://review.openstack.org/84314
2014-04-03T15:58:47  *** jgriffith has joined #openstack-infra
2014-04-03T15:58:53  *** zns_ has joined #openstack-infra
2014-04-03T15:59:05  <fungi> derekh: so looking in the debug logs, nodepool sees a deficit/allocation request for tripleo-f20 nodes, but isn't trying to build any. current suspicions are misconfiguration on that label in nodepool.yaml, or maybe something making the snapshot images unusable for them which isn't being noted in the log
2014-04-03T15:59:05  *** changbl has joined #openstack-infra
2014-04-03T15:59:40  <fungi> derekh: also it's failing to build new images for those because of a failure to add a floating-ip to the template instance, not sure whether it's related
2014-04-03T15:59:55  *** mrmartin has quit IRC
2014-04-03T16:00:16  <derekh> fungi: ok, just on a call at the moment for will look through some logs once I'm off
2014-04-03T16:00:22  *** alff_ has quit IRC
2014-04-03T16:00:27  *** alff has quit IRC
2014-04-03T16:01:09  *** jlibosva has joined #openstack-infra
2014-04-03T16:01:35  *** marun_afk is now known as marun
2014-04-03T16:01:38  *** zns has quit IRC
2014-04-03T16:01:42  <fungi> derekh: i don't think we're hitting our floating-ip quota because nova floating-ip-list only shows 33 entries
2014-04-03T16:02:24  *** thuc_ has quit IRC
2014-04-03T16:02:56  *** thuc has joined #openstack-infra
2014-04-03T16:03:22  *** andreaf has joined #openstack-infra
2014-04-03T16:05:10  *** mdenny has quit IRC
2014-04-03T16:05:33  *** mdenny has joined #openstack-infra
2014-04-03T16:05:39  <derekh> fungi: does the IP fail to get added or can you not ssh to the IP? if its the later I think this is an issue lifeless was looking at where the nic's are being added in the wrong order
2014-04-03T16:06:25  *** MarkAtwood has joined #openstack-infra
2014-04-03T16:06:58  *** thuc has quit IRC
2014-04-03T16:07:29  <fungi> derekh: not sure. i went ahead and blew away the existing f20 images in case there was something about them causing nodepoold not to want to use them for new nodes. nodepoold is now trying to build another image--we'll see if it continues to hit any issues
2014-04-03T16:07:46  <SergeyLukjanov> fungi, could you please take a look at https://review.openstack.org/#/c/84503/?
2014-04-03T16:07:48  <jeblair> fungi: is there a label for them?
2014-04-03T16:07:54  <fungi> jeblair: there is
2014-04-03T16:08:00  <SergeyLukjanov> fungi, +2 from jenkins, but it's not merged
2014-04-03T16:09:07  <fungi> jeblair: i can see in the config the label which the jobs want is represented, refers to the image name (which is the same as the label name in this case) and the debug logs report a deficit/allocation request for the nodes but wasn't trying to build any from the images it had
2014-04-03T16:10:34  <fungi> SergeyLukjanov: that's definitely weird. i'll check zuul's log for that merge
2014-04-03T16:10:45  <SergeyLukjanov> fungi, thank you!
2014-04-03T16:11:19  *** melwitt has joined #openstack-infra
2014-04-03T16:11:45  <jeblair> fungi: ok; if it doesn't clear up soon there may be an allocator bug; let me know if you want me to look into it
2014-04-03T16:12:26  *** freyes has quit IRC
2014-04-03T16:12:37  <fungi> SergeyLukjanov: it's wip
2014-04-03T16:12:46  <fungi> i missed it when i first looked over the change
2014-04-03T16:12:50  <SergeyLukjanov> fungi, oh, shame on me...
2014-04-03T16:12:57  <fungi> SergeyLukjanov: wip changes can't merge
2014-04-03T16:13:17  <SergeyLukjanov> fungi, do I need to re-approve it?
2014-04-03T16:13:43  *** krtaylor has quit IRC
2014-04-03T16:13:48  <fungi> jeblair: agreed, i just wanted to rule out any fallout from the provider outages/bugs before looking harder at it being an allocator logic problem
2014-04-03T16:14:06  <fungi> SergeyLukjanov: i would un-wip, then remove and re-add approval
2014-04-03T16:14:22  <SergeyLukjanov> fungi, I already unwiped it, it's my change :)
2014-04-03T16:14:55  <fungi> SergeyLukjanov: and if it still doesn't work, may need to delete the jenkins crvw=+2 change and reapprove again (as a gerrit admin you should be able to delete other votes)
2014-04-03T16:15:10  <fungi> er, the vfry=+2
2014-04-03T16:15:20  <SergeyLukjanov> fungi, I'm afraid that I'm not gerrit admin ;(
2014-04-03T16:15:50  <fungi> oh, right, i can delete it if the reapproval isn't working
2014-04-03T16:15:51  <SergeyLukjanov> fungi, anyway, everything is ok, it's in zuul pipeline now
2014-04-03T16:15:58  <fungi> great!
2014-04-03T16:15:59  <SergeyLukjanov> fungi, re-approve is working ok
2014-04-03T16:16:03  <fungi> then no bug there to fix
2014-04-03T16:16:22  <openstackgerrit> Ilya Shakhat proposed a change to openstack-infra/config: Add new stackforge project DriverLog (driver verification)  https://review.openstack.org/85033
2014-04-03T16:16:49  <fungi> derekh: at least we're past the floating-ip issue for the image build... it's currently puppeting the new template instance
2014-04-03T16:17:06  *** talluri has joined #openstack-infra
2014-04-03T16:17:23  <SergeyLukjanov> fungi, looks like it works because of https://github.com/openstack-infra/config/blob/master/modules/openstack_project/files/zuul/layout.yaml#L68
2014-04-03T16:17:49  <fungi> yep, agreed. i think we had a bug there at one point and then fixed it
2014-04-03T16:18:49  *** maxbit has quit IRC
2014-04-03T16:19:16  *** maxbit has joined #openstack-infra
2014-04-03T16:21:40  <openstackgerrit> James E. Blair proposed a change to openstack-infra/zuul: Add subway map to status page  https://review.openstack.org/84314
2014-04-03T16:26:23  *** fbo is now known as fbo_away
2014-04-03T16:26:24  *** yassine has quit IRC
2014-04-03T16:27:26  *** locke105 has joined #openstack-infra
2014-04-03T16:27:29  *** jpich has quit IRC
2014-04-03T16:27:52  <clarkb> morning
2014-04-03T16:28:06  <openstackgerrit> A change was merged to openstack-infra/zuul: Fix jshint linting errors  https://review.openstack.org/84905
2014-04-03T16:28:07  *** zns_ has quit IRC
2014-04-03T16:28:10  <openstackgerrit> A change was merged to openstack-infra/zuul: Fix up filter issues introduced by jshint changes  https://review.openstack.org/84112
2014-04-03T16:28:12  <jeblair> i'm at a dead end with https://review.openstack.org/#/c/84314/ i don't know how to undo something bootstrap has done.  i'd personally rather just not use bootstrap so it's pretty hard for me to work up the enthusiasm to go any further.
2014-04-03T16:29:16  *** mrodden has quit IRC
2014-04-03T16:29:57  *** maxbit has quit IRC
2014-04-03T16:30:02  *** thuc_ has joined #openstack-infra
2014-04-03T16:30:12  <clarkb> fungi: dhellmann have a link for the cliff thing? fwiw I intend on doing my best to dig into reviews today
2014-04-03T16:30:25  <jeblair> also, no one from wikimedia ever reviewed those changes :(
2014-04-03T16:32:59  <pleia2> good morning
2014-04-03T16:33:20  <zaro> morning
2014-04-03T16:33:58  <dhellmann> clarkb: https://review.openstack.org/#/c/84590/
2014-04-03T16:34:36  <dhellmann> clarkb: also https://review.openstack.org/#/c/85055/
2014-04-03T16:36:40  <jeblair> sdague: when you have a sec; can you see if you need to add anything to this thread: Subject: Re: [OpenStack-Infra] Multi-node aspects of the infra
2014-04-03T16:36:46  *** bhuvan has joined #openstack-infra
2014-04-03T16:37:49  *** ominakov has quit IRC
2014-04-03T16:38:01  *** thuc has joined #openstack-infra
2014-04-03T16:41:40  *** thuc_ has quit IRC
2014-04-03T16:46:51  <clarkb> dhellmann: I just approved 84590, should 85055 be ammended to only make stevedore non voting?
2014-04-03T16:47:09  <clarkb> dhellmann: or would you prefer to make them both non voting at this time regardless of 84590 merging?
2014-04-03T16:47:44  <dhellmann> clarkb: let's go ahead and make them both non-voting for now -- I'll fix cliff up and then make it voting again in the next day or two
2014-04-03T16:48:09  <clarkb> ok
2014-04-03T16:48:39  <openstackgerrit> David Caro proposed a change to openstack-infra/jenkins-job-builder: Added recursive option  https://review.openstack.org/85106
2014-04-03T16:49:22  <openstackgerrit> A change was merged to openstack-infra/config: Requirements check should tolerate existing cruft  https://review.openstack.org/84590
2014-04-03T16:49:46  *** e0ne has quit IRC
2014-04-03T16:50:12  *** e0ne has joined #openstack-infra
2014-04-03T16:50:19  *** krtaylor has joined #openstack-infra
2014-04-03T16:52:28  <openstackgerrit> A change was merged to openstack-infra/config: Disable broken oslo jobs  https://review.openstack.org/85055
2014-04-03T16:52:46  <dhellmann> thanks, clarkb
2014-04-03T16:53:03  *** alexpilotti has quit IRC
2014-04-03T16:54:38  *** e0ne has quit IRC
2014-04-03T16:55:05  <openstackgerrit> David Caro proposed a change to openstack-infra/jenkins-job-builder: Added recursive option  https://review.openstack.org/85106
2014-04-03T16:57:18  *** Ryan_Lane has joined #openstack-infra
2014-04-03T16:57:22  <ruhe> fungi: yes it does. we've recently switched murano tests to the openstack ci gate. but we still have one depedency not present in global-requirements. and it'll take sufficient amount of time to add it to global-requirements
2014-04-03T16:57:27  *** alff has joined #openstack-infra
2014-04-03T16:57:48  *** alff_ has joined #openstack-infra
2014-04-03T16:58:49  <fungi> ruhe: right, i think if your project requirements aren't suitable for requirements gating yet, you need to make that job non-voting and also make sure your project name is not present in openstack/requirements:projects.txt on relevant branches
2014-04-03T16:59:29  *** andreaf has quit IRC
2014-04-03T16:59:45  *** ominakov has joined #openstack-infra
2014-04-03T16:59:53  <fungi> ruhe: otherwise your ci jobs will also be forced to use our pypi mirror, which is only populated with requirements from openstack/requirements:global-requirements.txt
2014-04-03T17:01:55  <fungi> ruhe: you'll see some other projects also have their versions of that job set to voting: false in the jobs list, like http://git.openstack.org/cgit/openstack-infra/config/tree/modules/openstack_project/files/zuul/layout.yaml#n470
2014-04-03T17:02:51  <fungi> pvo: any idea who manages the iopenedthecloud.com site? the ajaxy submit button on it is broken
2014-04-03T17:03:01  *** wchrisj_ has joined #openstack-infra
2014-04-03T17:04:03  *** prad has joined #openstack-infra
2014-04-03T17:04:58  *** MarkAtwood has quit IRC
2014-04-03T17:05:37  <clarkb> fungi: is tripleo-f20 happy yet? reading sb and it looks like it was building a new image last
2014-04-03T17:06:33  <fungi> clarkb: not yet. i blew away the old images, new one built and went into a ready state, debug log continues to show a deficit of 1 and allocation requests for the label, but nodepool doesn't appear to be trying to build nodes from the image
2014-04-03T17:06:56  <fungi> jeblair: now i'm starting to more strongly suspect something's not quite kosher with the allocation logic
2014-04-03T17:07:18  <fungi> i can try bumping the min-ready a little in nodepool.yaml and see what happens
2014-04-03T17:07:25  <fungi> right now it's 1
2014-04-03T17:07:50  <clarkb> fungi: did pabelanger's changes around min-ready defaults merge? I guess that shouldn't affect this either way since we have an explicit value of 1
2014-04-03T17:08:13  <fungi> though dsvm-precise-krnl has min-ready: 1 and it builds nodes
2014-04-03T17:08:13  <derekh> fungi: cool, thanks, will be back in a bit to check it out
2014-04-03T17:08:21  *** derekh has quit IRC
2014-04-03T17:08:28  *** MarkAtwood has joined #openstack-infra
2014-04-03T17:10:39  <ruhe> fungi: thanks for input. but i'm speaking about dvsm jobs. they also fail because of requirements
2014-04-03T17:11:26  <fungi> ruhe: they shouldn't if you take your project out of the projects.txt in openstack/requirements i think
2014-04-03T17:11:42  <ruhe> fungi: here is an example http://git.openstack.org/cgit/openstack-infra/config/tree/modules/openstack_project/files/zuul/layout.yaml#n470
2014-04-03T17:11:57  <ruhe> fungi: here is correct link http://logs.openstack.org/61/85061/1/check/gate-murano-devstack-dsvm/98eb517/logs/devstacklog.txt.gz#_2014-04-03_15_04_23_013
2014-04-03T17:13:12  *** unicell has quit IRC
2014-04-03T17:14:10  <ruhe> fungi: and murano is not present in openstack/requirements
2014-04-03T17:14:15  *** harlowja_away is now known as harlowja
2014-04-03T17:14:15  <fungi> ruhe: yeah, i think it's not supposed to be running _sync_requirements_file()
2014-04-03T17:14:24  <fungi> looking at devstack to see why it might
2014-04-03T17:16:19  *** nicedice has joined #openstack-infra
2014-04-03T17:17:07  <ruhe> fungi: it seems that we need to use setup_develop_no_requirements_update from devstack/functions-common
2014-04-03T17:17:18  <ruhe> i'll try that
2014-04-03T17:18:06  *** yjiang has joined #openstack-infra
2014-04-03T17:18:40  <rcarrillocruz> hmm, got two reviews that failed at job check-tripleo-ironic-undercloud-precise , and i don't think my code has anything with that,
2014-04-03T17:18:55  <rcarrillocruz> anyone else getting that job failing?
2014-04-03T17:19:14  *** mihgen has quit IRC
2014-04-03T17:20:26  <clarkb> rcarrillocruz: I think that may be a known problem as tripleo + ironic isn't working yet. #tripleo can confirm
2014-04-03T17:21:14  <rcarrillocruz> thx clarkb, i'm diggint in the console logs, will check it out at #tripleo
2014-04-03T17:22:13  *** zns has joined #openstack-infra
2014-04-03T17:23:18  *** yjiang has quit IRC
2014-04-03T17:24:21  <fungi> ruhe: the only place in devstack i find a call to setup_package (formerly known as setup_develop_no_requirements_update) is within setup_package_with_req_sync
2014-04-03T17:24:31  <clarkb> fungi: reading https://review.openstack.org/#/c/84828/1 if the project has the overriden branch I would expect that branch to be used
2014-04-03T17:24:50  <fungi> clarkb: even if the change being tested is not on that branch?
2014-04-03T17:25:11  <fungi> clarkb: because under those circumstances, you wind up not testing the change
2014-04-03T17:25:27  <clarkb> fungi: right I don't think this was intended on testing changes but for use in periodic jobs
2014-04-03T17:25:34  <clarkb> I need to go reread job defs really quickly I guess
2014-04-03T17:25:54  <fungi> clarkb: and if the change being tested *is* targeting that branch, then it will be used anyway without needing to override the branch for the zuul_project
2014-04-03T17:25:57  <openstackgerrit> Khai Do proposed a change to openstack-infra/config: fix gerrit plugin build job  https://review.openstack.org/85114
2014-04-03T17:26:06  <clarkb> actually I think the term 'override' here is confusing me
2014-04-03T17:26:16  <fungi> clarkb: the override is used in periodic bitrot jobs and backwards-compat test jobs presently
2014-04-03T17:26:20  <clarkb> brnach override is for periodic jobs, this is a ref override?
2014-04-03T17:26:59  <fungi> clarkb: for example, if you make a change to devstack-gate master, one variant of jobs tests that change with the override set to stable/havana
2014-04-03T17:27:00  <clarkb> fungi: right, which aren't changes
2014-04-03T17:27:18  <clarkb> fungi: ya, so I think we want the existing behavior
2014-04-03T17:27:20  <fungi> clarkb: which works with the current setup because devstack-gate only has a master branch
2014-04-03T17:27:35  <clarkb> the idea is test everything on a common branch or fall back on master otherwise
2014-04-03T17:27:54  <openstackgerrit> Marc Abramowitz proposed a change to openstack-infra/jenkins-job-builder: jenkins-job-builder: Allow read/write stdin/stdout  https://review.openstack.org/84778
2014-04-03T17:27:58  *** mrodden has joined #openstack-infra
2014-04-03T17:28:05  <fungi> clarkb: but then trying to test master tempest changes against stable/havana projects didn't work the same way, because tempest actually had a stable/havana branch which ended up used as a fallback
2014-04-03T17:28:46  <clarkb> fungi: so, I think you need a new featuer in d-g to support that
2014-04-03T17:28:52  <clarkb> fungi: the existing feature is working as expected
2014-04-03T17:29:26  *** MarkAtwood has quit IRC
2014-04-03T17:29:29  <fungi> clarkb: i disagree, because the existing feature has a hole which lets you not test your proposed change if you have a backward-compat job overriding to a branch that project actually has
2014-04-03T17:29:58  <clarkb> fungi: but your change implicitly disables an explicit override
2014-04-03T17:30:11  <fungi> clarkb: take for example devstack-gate... if we suddenly added a stable/havana branch (not that we would be likely to do so) the backward-compat jobs for it would suddenly cease working correctly
2014-04-03T17:30:37  *** MarkAtwood has joined #openstack-infra
2014-04-03T17:30:39  *** MarkAtwood has quit IRC
2014-04-03T17:30:40  <clarkb> fungi: right, I am not disagreeing we may want to test what you describe. I am saying that implictly breaking an explicit override is the wrong way to do it
2014-04-03T17:30:47  <clarkb> the point of that code is to do what it currently does
2014-04-03T17:30:59  <fungi> clarkb: the override is for all projects, but i think it really should be for all projects if there's no change to be tested, and for all projects except the project which has the change to be tested otherwise
2014-04-03T17:31:01  *** VijayTripathi has quit IRC
2014-04-03T17:31:20  <fungi> clarkb: "the point of that code is to do what it currently does" could be used to negate any bug
2014-04-03T17:31:36  <clarkb> fungi: :P seriously though it is an override saying use this branch
2014-04-03T17:31:42  <clarkb> fungi: which is what it does
2014-04-03T17:32:23  <fungi> the override could just as easily mean use this branch on all projects except the project for the change being tested. under what circumstances would we want to avoid testing the change and just check out a branch instead?
2014-04-03T17:32:27  <clarkb> fungi: also, wouldn't it fall back on master anyways because the ref is against the master branch and not the havana branch
2014-04-03T17:32:36  <clarkb> fungi: I am pretty sure it will fallback as the ref won't be available
2014-04-03T17:33:28  *** Guest78329 has quit IRC
2014-04-03T17:33:48  <fungi> clarkb: it tries the zuul ref but modifies it to a nonexistent name (by changing the zuul branch to the override branch), fails to find that (because it isn't there) then looks to see if the project has the override branch and if so uses the tip of that
2014-04-03T17:34:06  *** morganfainberg_Z is now known as morganfainberg
2014-04-03T17:34:16  <fungi> thus it never falls back to trying the actual proposed change
2014-04-03T17:34:56  *** maxbit has joined #openstack-infra
2014-04-03T17:35:35  <fungi> and, i may be missing something, but i'm failing to identify the circumstances under which we'd ever want a change to be tested by a job which just uses the branch instead of the change being proposed
2014-04-03T17:36:00  <clarkb> the zuul ref looks like refs/zuul/master/Z3b0813341d954e1ca84a0986cb6ee4c3 in your proposed scenario. The override would chnage it to refs/zuul/stable/havana/Z3b0813341d954e1ca84a0986cb6ee4c3. it will clone the stable havana one first which will fail (should because the change was against master), then it will fetch the master ref which does exist
2014-04-03T17:36:12  *** packet has joined #openstack-infra
2014-04-03T17:36:13  *** packet has quit IRC
2014-04-03T17:36:38  <clarkb> fungi: the behavipr you describe should only happen in periodic jobs
2014-04-03T17:36:44  <clarkb> and change should do the right thing
2014-04-03T17:36:48  <fungi> no, between those it checks to see if the project has a stable/havana branch and just checks that out instead if it finds one, then never falls back to the master ref
2014-04-03T17:37:17  <fungi> i have job logs demonstrating this behavior
2014-04-03T17:37:18  *** gokrokve has quit IRC
2014-04-03T17:37:28  <clarkb> fungi: ah ok, so that is where the bug is I think
2014-04-03T17:37:35  <fungi> i agree
2014-04-03T17:38:10  <clarkb> fungi: I think we need a second fallback ref
2014-04-03T17:38:47  <clarkb> first try the override, then try original, then try fallback
2014-04-03T17:40:56  <fungi> i'm not sure why what i have there wouldn't work... the ZUUL_REF won't exist on periodic pipeline jobs, will it? and there won't ever be a ZUUL_REF on the override branch for ZUUL_PROJECT
2014-04-03T17:41:23  <clarkb> fungi: its more a matter of confusion, I am really confused why we would override an override
2014-04-03T17:41:41  <fungi> or actually, there might be if there's a change ahead of it in a dependent pipeline, which could then make matters even worse
2014-04-03T17:41:59  <clarkb> fungi: it would be a different zuul ref
2014-04-03T17:42:16  <clarkb> each change has a unique (as provided by uuid4) zuul ref
2014-04-03T17:42:48  <fungi> right, but refs with that uuid on the branches of any changes ahead of it in the pipeline for the same project
2014-04-03T17:43:14  <clarkb> no, it should only be on the one branch
2014-04-03T17:43:29  <clarkb> pretty sure the merge doesn't bother making refs for every branch
2014-04-03T17:43:32  *** rainya has quit IRC
2014-04-03T17:43:38  <fungi> i don't think that's the case... otherwise grenade jobs wouldn't dtrt in a dependent pipeline, for example
2014-04-03T17:43:39  <clarkb> only does it for the one associated with the current change
2014-04-03T17:45:23  *** thedodd has quit IRC
2014-04-03T17:45:25  <sdague> jeblair: will do. I'm going to try to sort out some of these tempest master patches first
2014-04-03T17:45:27  *** jlibosva has quit IRC
2014-04-03T17:45:33  <clarkb> arg thats right http://git.openstack.org/cgit/openstack-infra/zuul/tree/zuul/merger/merger.py#n269
2014-04-03T17:45:34  <fungi> let's say you have two changes to nova in the gate, 1 and 2... 1 is a change to stable/havana and 2 is a change to master
2014-04-03T17:45:55  <fungi> you want grenade to test that upgrading from havana with 1 applied to master with 2 applied works
2014-04-03T17:46:02  *** jlibosva has joined #openstack-infra
2014-04-03T17:46:23  <fungi> thus the zuul ref for testing 2 includes the same uuid for nova on both stable/havana and master
2014-04-03T17:46:35  <clarkb> ya
2014-04-03T17:46:49  *** rlandy has quit IRC
2014-04-03T17:46:55  <sdague> I think I've got a mobius strip of race -1s. A -1ed by bug B, fix for bug -1ed by bug C, fix for C -1ed by bug A.
2014-04-03T17:47:14  <clarkb> sdague: put some hot wheels on it, free energy
2014-04-03T17:47:27  <clarkb> fungi: so, following that train of thought, does this new override behavior impact grenade?
2014-04-03T17:47:43  <sdague> heh
2014-04-03T17:47:46  <clarkb> fungi: eg will it break projects that want to be checked out on an override in order to go to a future branch?
2014-04-03T17:47:54  <fungi> clarkb: i don't believe so, because we don't run grenade with override branches
2014-04-03T17:48:24  <fungi> grenade does it's own branch handling logic
2014-04-03T17:48:33  *** ildikov_ has quit IRC
2014-04-03T17:49:03  <fungi> right now the override is only used for periodic bitrot jobs and backwards-compatibility jobs
2014-04-03T17:49:48  <fungi> also i think the unit test failing on 84828 is actually incorrect, but haven't looked at how to correct it yet
2014-04-03T17:50:18  <clarkb> fungi: thats what sparked my concern :)
2014-04-03T17:51:10  <fungi> clarkb: so, an example run which i'm trying to fix with that is http://logs.openstack.org/12/82112/8/check/check-tempest-dsvm-full-havana/2a5debd/
2014-04-03T17:51:38  <clarkb> right so that passed because it checked out tempest stable/havana
2014-04-03T17:51:44  <fungi> if you look in the workspace setup log you can see where it's selecting stable/havana tip for openstack/tempest rather than the zuul ref
2014-04-03T17:52:22  <clarkb> fungi: I understand the problem we are trying to fix. I am just not convinced that fix is the one we want. Mostly because it is really confusing to override and override
2014-04-03T17:52:23  <sdague> clarkb / fungi: what's the nodepool implications of this - https://review.openstack.org/#/c/85057/
2014-04-03T17:52:37  <sdague> will I be breaking things badly before the images regen?
2014-04-03T17:53:04  <sdague> I'm going to change the heat guest image we use for testing to be an architecture match with the hosts we're on
2014-04-03T17:53:09  *** che-arne has quit IRC
2014-04-03T17:53:11  <sdague> in the hope of being a little faster
2014-04-03T17:53:22  *** khyati has joined #openstack-infra
2014-04-03T17:53:59  <fungi> looks like 214mb?
2014-04-03T17:54:44  <clarkb> sdague: every test will have to download that image and can't rely on its cache
2014-04-03T17:54:55  <clarkb> sdague: whcih may cause things to fail if it takes a long time or if the downloads are unreliable
2014-04-03T17:55:16  <fungi> right. some of those jobs may fail if the download is interrupted. also we might ddos the fedora mirrors ;)
2014-04-03T17:55:17  <sdague> clarkb: could we trigger a nodepool rebuild manually post merge?
2014-04-03T17:55:23  <clarkb> sdague: you can do it in two steps, add new image to stackrc, then use new image/remove old image to do it in a safer way
2014-04-03T17:55:40  <clarkb> sdague: we can but some regions aren't reliable in that manner
2014-04-03T17:55:46  <clarkb> sdague: eg it can take days to get a new image
2014-04-03T17:55:51  <sdague> interesting
2014-04-03T17:55:52  <zaro> mgagne1: what's up? new nick now?
2014-04-03T17:55:56  <fungi> right, and just space those out by a day, and then get us to manually update any images which failed to build overnight (hpcloud-az2, i'm looking at you)
2014-04-03T17:56:02  <sdague> well the problem is the current image is pretty problematic I think
2014-04-03T17:56:50  <clarkb> fungi: I am poking at d-g unittests now to try and grok the failure
2014-04-03T17:56:58  <fungi> i have a shell while loop i can use to repeatedly retry updating a nodepool image without deleting all the existing images to get nodepool to do that itself
2014-04-03T17:57:25  <fungi> that way we don't lose test capacity due to unavailable images in a provider
2014-04-03T17:58:09  <sdague> ok
2014-04-03T17:58:16  *** derekh has joined #openstack-infra
2014-04-03T17:59:07  <fungi> though in tough times, that loop has had to run for close to 48 hours nonstop to get a fresh image update to complete in hpcloud-az2 because of the current metadata server instability there
2014-04-03T17:59:26  <sdague> ok
2014-04-03T17:59:31  <sdague> interesting
2014-04-03T18:00:01  <clarkb> fungi: I think the indication of that unittest is d-g expects to setup branches for grenade (whether or not that is actually the case is another question)
2014-04-03T18:00:36  <mordred> clarkb: d-g unittests?
2014-04-03T18:00:40  *** whoops has joined #openstack-infra
2014-04-03T18:00:55  <jeblair> mordred: i wrote some a while back.  :)
2014-04-03T18:01:19  <clarkb> fungi: d-g appears to do that setup for us. it does setup_workspace for old/ and new/
2014-04-03T18:01:25  <clarkb> fungi: so I think that change does break grenade
2014-04-03T18:01:46  <jeblair> shouldn't it only break grenade if the override is set?
2014-04-03T18:01:52  <clarkb> jeblair: yes
2014-04-03T18:02:20  <clarkb> jeblair: actually wait, maybe not
2014-04-03T18:02:27  <fungi> right, i think grenade and the override branch logic are probably fundamentally incompatible anyway
2014-04-03T18:02:35  <clarkb> jeblair: because grenade is changing $branch to setup_project which is hwo the override works too
2014-04-03T18:02:39  <clarkb> so the override is overloaded
2014-04-03T18:02:45  <jeblair> so we could decide to explicitly not support that case
2014-04-03T18:03:01  <fungi> also a valid option
2014-04-03T18:03:30  <clarkb> ya so grenade would be affected always
2014-04-03T18:03:40  <clarkb> because grenade is effectively a branch override
2014-04-03T18:03:45  *** rwsu has quit IRC
2014-04-03T18:03:46  <jeblair> or we can define its behavior as "it overrides what we would normally do with grenade" which is to say, if you set override_tempest_branch to master, then you get tempest master in both grenade checkouts
2014-04-03T18:04:07  <sdague> jeblair: I actually think tempest on both branches is acceptable
2014-04-03T18:04:14  <sdague> sorry, tempest master on both sides
2014-04-03T18:04:21  <sdague> it's actually the behavior we want
2014-04-03T18:04:27  <jeblair> sdague: yeah, it's thinking a few steps ahead here, but that does seem like it might match what you want to do
2014-04-03T18:04:53  <sdague> I also agree, grenade is all kinds of edge cases
2014-04-03T18:06:07  *** dizquierdo has quit IRC
2014-04-03T18:07:38  <sdague> clarkb: so yeh... mirror fail isn't theoritical - http://logs.openstack.org/78/85078/2/check/check-tempest-dsvm-full/91f8c9b/logs/devstacklog.txt.gz#_2014-04-03_16_00_13_042
2014-04-03T18:08:11  <sdague> when will we know that a nodepool has updated images?
2014-04-03T18:09:00  <clarkb> sdague: http://nodepool.openstack.org has logs you can check, or we can do a listing for you
2014-04-03T18:10:35  <fungi> sdague: basically we should just merge the first part on one day, then check in the second day and i can manually update any stragglers which failed to work on the daily periodic updates, and let you know once they're caught up so you can approve the second half
2014-04-03T18:10:45  <sdague> fungi: ok
2014-04-03T18:10:54  <sdague> let me figure out a bridge patch for that
2014-04-03T18:11:02  *** thedodd has joined #openstack-infra
2014-04-03T18:11:18  <fungi> or if it's urgent, i can manually update all of them between patches, but would rather not unless you really need it asap
2014-04-03T18:11:48  <sdague> well... here's the challenge, in this new model I was having yuo get this image if you had heat enabled
2014-04-03T18:12:13  <sdague> I guess I can trick nodepool by putting the imageurl add in there in a block devstack never executes?
2014-04-03T18:12:35  *** gokrokve has joined #openstack-infra
2014-04-03T18:13:27  *** malini has joined #openstack-infra
2014-04-03T18:13:35  <fungi> or break the urls out into a separate file which you reference from the script logic, and we can tweak our prep scripts to grab everything in that file (or everything in a certain section of the file, or with a specific comment tag, or...)
2014-04-03T18:14:20  <fungi> doing something with downloads similar to the way debs and rpms are handled might make devstack a little more extensible anyway
2014-04-03T18:15:01  <sdague> ok, so there is a related impact which is this patch - https://review.openstack.org/#/c/81486/
2014-04-03T18:15:10  *** talluri has quit IRC
2014-04-03T18:15:14  <sdague> will the nodepool parser be able to handle that?
2014-04-03T18:15:37  <sdague> or does that beg the issue of a bash script in devstack to evaluate out all the image urls?
2014-04-03T18:16:46  <fungi> sdague: http://git.openstack.org/cgit/openstack-infra/config/tree/modules/openstack_project/files/nodepool/scripts/cache_devstack.py#n82
2014-04-03T18:17:29  *** phschwartz has quit IRC
2014-04-03T18:17:43  <fungi> sdague: so only lines in stackrc which start with IMAGE_URLS will match
2014-04-03T18:17:55  <sdague> right, but us moving to vars in urls
2014-04-03T18:18:04  *** phschwartz has joined #openstack-infra
2014-04-03T18:18:06  <sdague> would seem to break it
2014-04-03T18:18:08  <fungi> sdague: and that change has them commented, thus #IMAGE_URLS (which doesn't match_
2014-04-03T18:18:43  <jogo> ahh marconi now has a PTL candidate
2014-04-03T18:18:54  <sdague> fungi: no, that wasn't what I was concerned on
2014-04-03T18:19:03  <fungi> sdague: oh
2014-04-03T18:19:06  <sdague> IMAGE_URLS=${IMAGE_URLS:-"http://download.cirros-cloud.net/${CIRROS_VERSION}/cirros-
2014-04-03T18:19:06  <sdague> ${CIRROS_VERSION}-x86_64-uec.tar.gz"};;
2014-04-03T18:19:20  <sdague> I don't see how the cache handles the vars
2014-04-03T18:19:35  <fungi> sdague: ahh, right, it doesn't seem to
2014-04-03T18:20:10  <fungi> sdague: it strips away to default variable values if they're specified
2014-04-03T18:20:15  *** chrisstreeter_ has joined #openstack-infra
2014-04-03T18:20:30  <fungi> but not recursively
2014-04-03T18:21:07  <sdague> ok, so in the stack of fixes I think we need then, is actually the script in devstack to generate all the image urls
2014-04-03T18:21:08  *** phschwartz has quit IRC
2014-04-03T18:21:11  <fungi> and only for the IMAGE_URLS envvar itself
2014-04-03T18:21:41  <mtreinish> jogo: you can still run :)
2014-04-03T18:22:14  <fungi> sdague: agreed. i think we should simplify the parsing in cache_devstack.py by making devstack carry or generate a list of urls
2014-04-03T18:22:19  <zaro> anteaya: have you tried to do the puppet for gerrit?
2014-04-03T18:22:33  <anteaya> no
2014-04-03T18:22:40  <sdague> fungi: ok, before I end up with stack overflow, let me do that one
2014-04-03T18:22:48  <anteaya> i have not tried to use the gerrit puppet module
2014-04-03T18:22:50  <zaro> anteaya: do you have puppet setup in a vm?
2014-04-03T18:22:52  <sdague> then work backwards on these
2014-04-03T18:22:56  <anteaya> I found the config overwhelming
2014-04-03T18:22:59  *** phschwartz has joined #openstack-infra
2014-04-03T18:23:14  *** dkliban has quit IRC
2014-04-03T18:23:15  <zaro> anteaya: haha!! that's why i haven't done it either.
2014-04-03T18:23:20  <fungi> sdague: and we likely need to phase that too so we can do phased deprecation across an image build (or two)
2014-04-03T18:23:23  <anteaya> zaro: no i have just been working on setting up a gerrit manually and working backward with the puppet manifest
2014-04-03T18:23:31  <anteaya> makes sense to me
2014-04-03T18:24:14  <fungi> sdague: or else temporarily complicate cache_devstack.py by assembling and deduping the list from both sources
2014-04-03T18:24:24  <sdague> yep
2014-04-03T18:25:11  <zaro> who's the person to talk to about puppet dashboard?
2014-04-03T18:25:28  <fungi> anteaya: zaro: fwiw, that's what i did the first time too... made the puppet spaghetti easier to follow once i had done most of the same steps by hand
2014-04-03T18:25:32  <zaro> i want to add review-dev.o.o to it.
2014-04-03T18:25:46  <fungi> zaro: is puppet agent running on review-dev?
2014-04-03T18:25:52  <anteaya> zaro: nibalizer is probably the best person
2014-04-03T18:25:58  <zaro> fungi: probably not.
2014-04-03T18:25:59  <fungi> zaro: it should just automatically show up if so
2014-04-03T18:26:16  <zaro> fungi: not sure what i should do about that.
2014-04-03T18:26:19  <anteaya> zaro: I can keep stepping through it by hand and let you know when I am in a better position for understanding the puppet manifest
2014-04-03T18:26:42  <anteaya> then we can work on seeing how to make it work to install gerrit
2014-04-03T18:26:45  <anteaya> if you want
2014-04-03T18:26:48  <fungi> zaro: all puppetboard is doing is displaying info about reports it finds in puppetdb, which in turn are merely forwarded by the puppetmaster, which it does for any it receives from running puppet agents
2014-04-03T18:27:01  <mgagne1> Anyone going to pycon?
2014-04-03T18:27:02  <zaro> fungi: i have review-dev setup with gerrit-2.8, but if i let puppet install gerrit i don't think all the patches have merged for it to work.
2014-04-03T18:27:04  *** mgagne1 is now known as mgagne
2014-04-03T18:27:31  <openstackgerrit> James E. Blair proposed a change to openstack-infra/gear: Add access control  https://review.openstack.org/84873
2014-04-03T18:27:45  <zaro> fungi: running puppet won't update the server?
2014-04-03T18:27:51  <jeblair> fungi: do i need to look at the nodepool allocator?
2014-04-03T18:27:58  <fungi> zaro: right, basically puppetboard is a display of systems running the puppet agent, and tells you what the agent has done. if the agent isn't running on review-dev, then there's little reason for it to appear on puppetboard anyway right?
2014-04-03T18:27:58  *** mwagner_lap has quit IRC
2014-04-03T18:28:58  <fungi> jeblair: yeah, i mentioned it earlier but it probably got buried in the devstack{,-gate} discussion. i'm seeing if i can spot the logic error (assuming there is one to spot)
2014-04-03T18:29:03  <zaro> fungi: agreed.  so i would like it to run the agent but that will probably break gerrit on it.
2014-04-03T18:29:46  <zaro> fungi: gerrit won't work until a few more patches for 2.8 is merged.
2014-04-03T18:29:50  <fungi> zaro: unelss the review_dev.pp passes through enough of the changes you've been making locally to reflect what you need
2014-04-03T18:30:35  <fungi> which might not be worth the effort until it's closer to solved
2014-04-03T18:30:38  *** alexpilotti has joined #openstack-infra
2014-04-03T18:30:46  <zaro> anteaya: sure. let know if you run into troubles by hand.
2014-04-03T18:31:55  <anteaya> okay thanks
2014-04-03T18:32:02  <anteaya> about every 5 minutes
2014-04-03T18:32:06  <anteaya> I'll take notes
2014-04-03T18:34:29  <zaro> fungi: ok. i think i get it.  i'll check all of the changes on my private puppet vm before running the agent on review-dev.
2014-04-03T18:35:12  <zaro> anteaya: really wanted to put this off, but now i really need to run the puppet.
2014-04-03T18:36:27  *** dmsimard has left #openstack-infra
2014-04-03T18:36:40  <anteaya> yeah, we are getting close to upgrade
2014-04-03T18:36:53  <anteaya> I don't think running the puppet with be a 2 day thing to figure out how to do
2014-04-03T18:37:15  <zaro> mgagne: no pycon for me.  did you want to have an 'add me' to reviewers on gerrit?
2014-04-03T18:37:16  *** derekh has quit IRC
2014-04-03T18:38:39  <anteaya> mgagne: mgagne1 yea pleia2 and I are
2014-04-03T18:38:46  <anteaya> I still have to book my train
2014-04-03T18:38:51  <mgagne> zaro: http://i.imgur.com/DncoG3V.jpg
2014-04-03T18:39:14  <anteaya> lol
2014-04-03T18:39:15  *** derekh has joined #openstack-infra
2014-04-03T18:40:52  <pleia2> hehe
2014-04-03T18:41:44  *** dmsimard has joined #openstack-infra
2014-04-03T18:41:51  <fungi> jeblair: from the debug log it looks like label_demand.get(label.name, 0) is perpetually 0 for that label
2014-04-03T18:42:33  <fungi> jeblair: however demand is 1, so maybe label_demand[label.name] = demand isn't working?
2014-04-03T18:43:07  *** dmsimard has left #openstack-infra
2014-04-03T18:43:20  <fungi> though if not, i would think that would break building nodes for the other labels... :/
2014-04-03T18:43:46  <zaro> mgagne: your wish is my command.. https://gerrit-review.googlesource.com/#/c/55651
2014-04-03T18:44:05  <mgagne> zaro: :D
2014-04-03T18:44:26  <mgagne> zaro: they look to not like my idea lol
2014-04-03T18:44:36  <zaro> mgagne: :(
2014-04-03T18:45:11  <mgagne> zaro: greasemonkey then =)
2014-04-03T18:46:10  <pabelanger> fungi, is there anyway to have nodepool not use a saved image, but launch / bootstrap / attach jenkins slave all at once?
2014-04-03T18:46:59  <zaro> mgagne: maybe you can tell them about your use case.
2014-04-03T18:47:20  <mgagne> zaro: well, he proposed a "solution" wish is to -1 the change until you have time to review.
2014-04-03T18:47:40  <mgagne> zaro: but my use case might be limited to OpenStack as AFAIK we have a custom dashboard right?
2014-04-03T18:47:52  <mgagne> zaro: and changes won't show up to this dashboard until I'm added to reviewers
2014-04-03T18:48:34  <jeblair> fungi: okay, i'll look into it after lunch (maybe i can make a test case)
2014-04-03T18:48:41  <zaro> mgagne: custom dashboard?
2014-04-03T18:49:00  <mgagne> zaro: isn't the homepage a dashboard written/coded by OpenStack team?
2014-04-03T18:49:00  <zaro> mgagne: not sure what you mean, gerrit web page is from upstream.
2014-04-03T18:49:32  *** zns has quit IRC
2014-04-03T18:49:32  <zaro> mgagne: nope.  it's only the 'important changes' page that's custom.
2014-04-03T18:49:45  <mgagne> zaro: oh
2014-04-03T18:49:57  <zaro> mgagne: and that will probably go away after we upgrade gerrit.
2014-04-03T18:50:42  *** marun is now known as marun_afk
2014-04-03T18:50:59  <sdague> fungi: how about this - Sean Dague proposed a change to openstack-dev/devstack: add an image_list tool  https://review.openstack.org/85142 ?
2014-04-03T18:51:03  *** msabramo has joined #openstack-infra
2014-04-03T18:51:06  <sdague> the output is one image per line
2014-04-03T18:51:09  <sdague> full url
2014-04-03T18:51:15  <jeblair> sdague, fungi, clarkb, mordred, SergeyLukjanov: so i heard back from the 1st of the three possible new node providers -- they can offer 100@2cpux8gb or 50@4cpux8gb, or, presumably (since they'd have to add it to their flavor catalog), 25@8cpux8gb
2014-04-03T18:51:25  <jeblair> it seems they are cpu constrained
2014-04-03T18:51:37  <sdague> how good are their cpus?
2014-04-03T18:51:39  <jeblair> they are open to adding more capacity later
2014-04-03T18:51:54  <jeblair> (as they grow their service and add more pods)
2014-04-03T18:52:09  <sdague> 2cpu doesn't do us any real good at this point
2014-04-03T18:52:20  <sdague> 4 is good if the cpus themselves are good
2014-04-03T18:52:24  <sdague> re: newish
2014-04-03T18:52:39  <sdague> 8 is awesomer
2014-04-03T18:52:40  <jeblair> they say they are not oversubscribed
2014-04-03T18:52:49  <clarkb> the only reason we use 8cpu nodes at all is that particular provider limits cpu time in fun ways
2014-04-03T18:52:50  <sdague> yeh, it's not even oversubscribed I think
2014-04-03T18:52:56  <clarkb> ++ to 4cpu
2014-04-03T18:53:10  <sdague> the old rax 4cpu were slow because they were amd chips with low cache
2014-04-03T18:53:22  *** ominakov has quit IRC
2014-04-03T18:53:28  <jeblair> sdague: don't we use 8 cpus on the nice new fast rax nodes though?
2014-04-03T18:53:38  <sdague> jeblair: we use 8 cpu on them
2014-04-03T18:53:48  <sdague> core for core they are still slower than hp
2014-04-03T18:53:54  <sdague> well then hp 1.0
2014-04-03T18:54:20  *** dteselkin_ has quit IRC
2014-04-03T18:54:21  *** derekh has quit IRC
2014-04-03T18:54:47  <jeblair> okay, so maybe both hp 1.1 and rax are limited in some way
2014-04-03T18:54:56  <sdague> hp 1.1 is very clearly limitted
2014-04-03T18:55:12  <sdague> but I think that's intentional
2014-04-03T18:55:24  <clarkb> ya
2014-04-03T18:55:27  <sdague> honestly, the per core performance on hp 1.0 is somewhat astonishing
2014-04-03T18:55:29  *** meera has joined #openstack-infra
2014-04-03T18:55:57  <jeblair> so the worst case is that we end up with 25 nodes to start.  we might end up with 50.
2014-04-03T18:55:57  <sdague> it was head to head as good as some very respectable physical hardware I had at IBM
2014-04-03T18:56:01  <sdague> yeh
2014-04-03T18:56:05  <sdague> I'd say lets try at 4
2014-04-03T18:56:07  <jeblair> and we might end up with more over time
2014-04-03T18:56:25  <sdague> and figure out if it's limitted enough that we really want to switch to 8s instead
2014-04-03T18:56:27  <jeblair> considering the time we'll invest in benchmarking, setting up, etc, is that worth it?
2014-04-03T18:56:42  <sdague> jeblair: fair
2014-04-03T18:56:54  <sdague> sure, I guess everything else is 8s
2014-04-03T18:57:14  <jeblair> sdague: oh no, sorry, i'm fine trying 4...
2014-04-03T18:57:24  <sdague> jeblair: oh, yeh, I think 4s are fine
2014-04-03T18:57:26  <sdague> lets start there
2014-04-03T18:57:40  <jeblair> sdague: i meant should we proceed in general, with either (i mean, we'd still need to figure out what they're doing differently even with 8 -- everyone does something different :(
2014-04-03T18:58:00  <sdague> jeblair: ++ we should proceed
2014-04-03T18:58:07  <mordred> jeblair: well, each time we do that, we learn more and make our overall system more resilient
2014-04-03T18:58:08  <sdague> both for getting more resource for infra
2014-04-03T18:58:18  <mordred> one of these times we'll add a new system and it'll Just Work
2014-04-03T18:58:21  <sdague> and for helping learn how different OS is in the field
2014-04-03T18:58:29  *** ildikov_ has joined #openstack-infra
2014-04-03T18:58:46  <sdague> because I think that understanding of differences is very useful feedback to the community, the board, and the vendors
2014-04-03T18:59:12  <nibalizer> zaro: hi, puppetboard.o.o you mean?
2014-04-03T18:59:49  <nibalizer> puppetboard is a unique project from puppet dashborad
2014-04-03T18:59:58  <nibalizer> review-dev doesn't seem to be checking in
2014-04-03T19:00:21  *** _nadya_ has joined #openstack-infra
2014-04-03T19:00:38  <nibalizer> which is strange, is that node running puppet?
2014-04-03T19:00:53  <nibalizer> success, or failure, it should be submitting reports to puppetdb
2014-04-03T19:00:59  <nibalizer> i do see a node definition in site.pp
2014-04-03T19:00:59  <jeblair> okay.  i think 25 won't make a huge difference for our resource usage, 50 is getting there, 100 is what i was shooting for. but you're right, there are other intagibles, and working to establish a relationship is probably worth it.
2014-04-03T19:01:03  *** alff_ has quit IRC
2014-04-03T19:01:03  *** alff has quit IRC
2014-04-03T19:02:27  <fungi> pabelanger: no feature for that yet, but probably not too complicated to add if you wanted to hack on it
2014-04-03T19:03:13  <clarkb> did board meeting just start?
2014-04-03T19:03:16  <clarkb> anyone have a number for that?
2014-04-03T19:03:22  <mordred> yah
2014-04-03T19:03:29  <mordred> 1-650-479-3207
2014-04-03T19:03:38  <mordred> Session number: 925 304 456
2014-04-03T19:03:42  <fungi> sdague: that looks reasonable (assuming it works--i haven't tested it). as long as we can run that statelessly in a fresh clone of devstack, we should be able to use that to determine what to download and precache
2014-04-03T19:03:45  <jeblair> and #openstack-board
2014-04-03T19:04:29  <pabelanger> fungi, Ya, was considering adding it.  Having some problems with saved images launching (delayed) so wanted to see if there was another way
2014-04-03T19:04:37  <sdague> fungi: it works locally
2014-04-03T19:04:56  <pabelanger> but, working on a patch to implement a launchnode timeout, code is there but not exposed in yaml file
2014-04-03T19:05:06  <sdague> it also has a safety latch to exit if < 5 images are returned (the current known sane number)
2014-04-03T19:05:15  <sdague> so check the exit code on it in use
2014-04-03T19:05:16  <pabelanger> we'll wait 3600 mins before cancelling the build
2014-04-03T19:05:23  <pabelanger> Rather way 15mins :)
2014-04-03T19:05:26  <pabelanger> wait(
2014-04-03T19:05:29  <pabelanger> grr
2014-04-03T19:06:06  *** thedodd has quit IRC
2014-04-03T19:06:29  <fungi> jeblair: agreed, even if we start out small, the potential to scale that up in the future might be worth the up-front effort as well
2014-04-03T19:06:48  <clarkb> woot finallymanaged to make a meeting, I am putting them on my calendar now
2014-04-03T19:08:57  *** mwagner_lap has joined #openstack-infra
2014-04-03T19:09:58  <fungi> was worried i'd dialed in too late, but they're still starting
2014-04-03T19:10:17  <msabramo> very easy PR for jenkins-job-builder - probably ready for merge - https://review.openstack.org/84950; could squeeze it in before meeting starts… :-)
2014-04-03T19:11:41  *** derekh has joined #openstack-infra
2014-04-03T19:11:43  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: allow for generic branch overrides  https://review.openstack.org/84829
2014-04-03T19:12:04  <sdague> I finally figured out why the generic branch bit was exploding on grenade
2014-04-03T19:12:18  <openstackgerrit> A change was merged to openstack-infra/storyboard-webclient: Tightened up story detail UI  https://review.openstack.org/84882
2014-04-03T19:13:00  <sdague> $OVERRIDE_OSLO.VMWARE_BRANCH
2014-04-03T19:13:06  <sdague> not so much a real bash variable
2014-04-03T19:13:23  <jeblair> haha
2014-04-03T19:14:32  <clarkb> fungi: jeblair does https://review.openstack.org/#/c/84829/ fix the d-g thing we were talking about earlier?
2014-04-03T19:14:55  <fungi> clarkb: it does a different thing
2014-04-03T19:14:58  *** ilives has joined #openstack-infra
2014-04-03T19:15:18  <fungi> clarkb: that's where we can say "test this nova stable/havana change using tempest master"
2014-04-03T19:15:50  <clarkb> fungi: right, which I thought was relasted to what you were doing and tempest stable/havana was being used instead of master
2014-04-03T19:16:03  <phschwartz> Anyone know the travel time between the conference center where the summit is and Hartford Jackson?
2014-04-03T19:16:08  <dhellmann> fungi: I'm still seeing failures in cliff because of duplicate requirements in master https://jenkins04.openstack.org/job/gate-cliff-requirements/1/console
2014-04-03T19:16:29  <dhellmann> fungi: I thought your change merged?
2014-04-03T19:16:40  <clarkb> dhellmann: we need to wait for new images to be built
2014-04-03T19:16:47  <fungi> clarkb: right, but with that we don't want to override the master branch, while when testing tempest master against stable/havana projects we do
2014-04-03T19:16:48  <dhellmann> clarkb: ah
2014-04-03T19:16:55  <clarkb> dhellmann: since we are image based and not running against static slaves anymore
2014-04-03T19:17:01  <fungi> er, don't want to override the default branch
2014-04-03T19:17:07  *** chadlung has joined #openstack-infra
2014-04-03T19:17:10  <dhellmann> ok, the job is non-voting so we'll go ahead
2014-04-03T19:17:16  <dhellmann> clarkb: when do image builds happen?
2014-04-03T19:17:26  <clarkb> fungi: gotcha, master should be used if master change and stable havana if havana change
2014-04-03T19:17:31  <clarkb> dhellmann: early morning EST
2014-04-03T19:18:07  <clarkb> dhellmann: we can also trigger them manually, which we may do if sdague sorts out the fedora image things for heat
2014-04-03T19:18:21  <fungi> clarkb: right, this one just changes the default branch for one project, which doesn't cover the use case of testing tempest master changes against stable server branches
2014-04-03T19:18:34  <dhellmann> clarkb: ok, I'll just ignore that failure for now, since it's only master that has the issue
2014-04-03T19:21:29  *** thedodd has joined #openstack-infra
2014-04-03T19:21:38  *** Clabbe has quit IRC
2014-04-03T19:21:55  *** Clabbe has joined #openstack-infra
2014-04-03T19:22:37  <clarkb> sdague: what does the eval do in that change? it echos the override then evals that?
2014-04-03T19:23:00  <fungi> clarkb: it's so that it can construct the envvars it wants to look for
2014-04-03T19:23:05  <sdague> clarkb: that lets us do the whole project thing dynamically
2014-04-03T19:23:15  <openstackgerrit> A change was merged to openstack-infra/storyboard-webclient: ngDelete directive  https://review.openstack.org/84504
2014-04-03T19:23:20  <sdague> instead of having to enumerate them all up front
2014-04-03T19:23:41  <clarkb> fungi: sdague: isn't the echo sufficient?
2014-04-03T19:23:41  *** jlibosva has quit IRC
2014-04-03T19:23:47  <sdague> no
2014-04-03T19:23:47  <clarkb> it will echo something or ""
2014-04-03T19:24:04  <sdague> because you have to construct a variable name
2014-04-03T19:24:28  *** david-lyle has quit IRC
2014-04-03T19:24:42  * clarkb learns him a shell
2014-04-03T19:25:11  <sdague> I'm pretty sure there is no way to do that without the eval, I did try for a while on different approaches
2014-04-03T19:25:36  <sdague> but the problem is you want to check for a variable existing, but you want to build up what that variable name would be from another variable
2014-04-03T19:25:50  *** zns has joined #openstack-infra
2014-04-03T19:26:07  *** malini is now known as malini_afk
2014-04-03T19:26:11  *** zns has quit IRC
2014-04-03T19:26:31  <openstackgerrit> Paul Belanger proposed a change to openstack-infra/nodepool: Create launch-timeout setting for providers  https://review.openstack.org/85150
2014-04-03T19:26:45  *** jp_at_hp has quit IRC
2014-04-03T19:26:54  <clarkb> ya, after doing it interactively I see why the eval exists. we need to go from $project_branch_var -> $OVERRIDE_nova_BRANCH -> somebranch
2014-04-03T19:26:59  <sdague> yep
2014-04-03T19:27:01  *** zns has joined #openstack-infra
2014-04-03T19:27:05  *** zns has quit IRC
2014-04-03T19:27:12  <clarkb> that middle step I didn't grok until just now
2014-04-03T19:27:35  <sdague> yeh, it's a little tricky, and the unit tests are helpful in making sure it's right
2014-04-03T19:27:40  *** zns has joined #openstack-infra
2014-04-03T19:27:40  <sdague> I definitely messed it up the first time
2014-04-03T19:29:55  *** fbo_away is now known as fbo
2014-04-03T19:30:02  <clarkb> fungi: so run this by me again, this could be used to do tempest master everywhere right? but it can't be used to naturally select the proper branch based on the change branch
2014-04-03T19:30:12  <clarkb> all of this branch stuff is brain melty
2014-04-03T19:30:47  <pabelanger> Hmm
2014-04-03T19:30:48  <fungi> clarkb: right. the two patches are compliments of one another
2014-04-03T19:31:16  <fungi> clarkb: one lets you gate master tempest changes on stable server projects, the other lets you gate stable server changes on master tempest
2014-04-03T19:31:20  *** alff has joined #openstack-infra
2014-04-03T19:31:21  *** alff_ has joined #openstack-infra
2014-04-03T19:31:29  *** e0ne has joined #openstack-infra
2014-04-03T19:31:30  *** jlibosva has joined #openstack-infra
2014-04-03T19:31:41  <clarkb> sdague: it is still failing unittests btw
2014-04-03T19:32:00  <sdague> clarkb: really?
2014-04-03T19:32:08  <fungi> clarkb: they're basically the two halves of the symmetry for gating tempest master on stable servers when there's still a stable tempest branch
2014-04-03T19:32:10  <clarkb> ya, see zuul status
2014-04-03T19:32:17  <clarkb> fungi: gotcha thanks
2014-04-03T19:32:17  <sdague> oh, I see
2014-04-03T19:33:19  <pabelanger> well, this is new for nodepool: http://pastebin.com/91S3eAju
2014-04-03T19:33:24  <fungi> clarkb: the fixes/features to support this are potentially useful long-term, even after tempest master gets healthy enough to be able to support stable/havana servers and we subsequently delete the stable/havana branch from tempest
2014-04-03T19:33:25  <pabelanger> just updated to the latest master
2014-04-03T19:34:20  <pabelanger> https://github.com/openstack-infra/nodepool/commit/fca89ee0a0797d7e994c4d0c11c7746f7f136636 seems to be the issue
2014-04-03T19:34:22  <fungi> pabelanger: did zmq get updated?
2014-04-03T19:34:26  <fungi> ooh
2014-04-03T19:34:37  <pabelanger> fungi, let me check my version
2014-04-03T19:35:12  <fungi> pabelanger: i'll get you a pip list from our nodepool server so you can compare versions
2014-04-03T19:35:16  *** jp_at_hp has joined #openstack-infra
2014-04-03T19:36:11  <clarkb> it may depend on the C version too which pyzmq via pip should bundle up for you
2014-04-03T19:36:35  <fungi> pabelanger: http://paste.openstack.org/show/75019
2014-04-03T19:38:14  *** zns has quit IRC
2014-04-03T19:38:47  <pabelanger> same version
2014-04-03T19:38:50  <pabelanger> 13.1.0
2014-04-03T19:38:57  <pabelanger> so, must be build flags
2014-04-03T19:39:09  <clarkb> pabelanger: are you running that on linux?
2014-04-03T19:39:38  *** zns has joined #openstack-infra
2014-04-03T19:39:46  <pabelanger> clarkb, ubuntu 12.04 is what I run nodepool on
2014-04-03T19:39:47  <clarkb> wonder if maybe a platform difference
2014-04-03T19:39:48  <sdague> clarkb: ok, one more fix, unit tests running clean again
2014-04-03T19:39:55  <clarkb> pabelanger: thats what we use too thanks
2014-04-03T19:39:59  <openstackgerrit> Sean Dague proposed a change to openstack-infra/devstack-gate: allow for generic branch overrides  https://review.openstack.org/84829
2014-04-03T19:40:28  *** thuc has quit IRC
2014-04-03T19:41:23  <fungi> pabelanger: apparently RCVTIMEO gets passed down into libzmq from what i'm seeing
2014-04-03T19:41:46  <pabelanger> fungi, yes, I think that is my issue
2014-04-03T19:41:49  <pabelanger> I have 2.1.1 installed
2014-04-03T19:41:55  <pabelanger> rebuilding pyzmq now
2014-04-03T19:42:01  <pabelanger> to see if anything shows up
2014-04-03T19:42:46  *** jlibosva has quit IRC
2014-04-03T19:42:54  *** mrda_away is now known as mrda
2014-04-03T19:43:53  *** imcsk8_lap has quit IRC
2014-04-03T19:44:02  *** thuc_ has joined #openstack-infra
2014-04-03T19:44:06  *** imcsk8_lap has joined #openstack-infra
2014-04-03T19:44:12  <zaro> nibalizer: i meant puppetdb.o.o, i don't think the agent is running on review-dev.o.o
2014-04-03T19:44:52  *** _nadya_ has quit IRC
2014-04-03T19:44:52  *** thuc_ has quit IRC
2014-04-03T19:44:56  <zaro> nibalizer: i don't want to turn it on yet until i all my patches merge for that server.
2014-04-03T19:45:15  <pabelanger> fungi, are you using a newer version then libzmq1 2.1.11-1ubuntu1 ?
2014-04-03T19:45:28  *** thuc has joined #openstack-infra
2014-04-03T19:45:29  <fungi> pabelanger: we don't have libzmq1 installed on our nodepool server
2014-04-03T19:45:47  <clarkb> fungi: pabelanger that is what I expected, pyzmq bundles it into the python lib install if you don't have the system install
2014-04-03T19:45:58  <clarkb> but if system install is there it links against that
2014-04-03T19:46:02  <pabelanger> Ah
2014-04-03T19:46:03  <pabelanger> okay
2014-04-03T19:46:09  <pabelanger> so, that is my issue
2014-04-03T19:47:22  *** jp_at_hp1 has joined #openstack-infra
2014-04-03T19:47:53  <sdague> so do we want to merge the layout - https://review.openstack.org/#/c/84864/
2014-04-03T19:48:07  <sdague> then the d-g job will start generating real results on the branch override?
2014-04-03T19:48:29  *** markwash has joined #openstack-infra
2014-04-03T19:48:36  <pabelanger> fungi, clarkb: okay, that was it.  Removed the system library
2014-04-03T19:48:48  *** jp_at_hp has quit IRC
2014-04-03T19:49:57  <clarkb> sdague: that was my goal, but a second review would be good before I hit the go button
2014-04-03T19:50:36  *** zhiyan_ is now known as zhiyan
2014-04-03T19:51:49  <chadlung> Anyone seen this before on DevStack? "tox' is not a global requirement but it should be,something went wrong"
2014-04-03T19:52:09  <clarkb> chadlung: did you add tox to a requirements list somewhere?
2014-04-03T19:52:34  <chadlung> clarkb: Its been in the python-barbicanclient for a while now
2014-04-03T19:53:01  <chadlung> clarkb: just started failing today, did some troubleshooting but can't seem to see where this is happening
2014-04-03T19:53:05  *** denis_makogon_ has joined #openstack-infra
2014-04-03T19:53:24  <clarkb> chadlung: was python-barbicanclient recently added to openstack/requirements/projects.txt?
2014-04-03T19:53:48  <clarkb> devstack applies the requirements from global reqs to individual projects to make sure they all work with the global set of reqs. fwiw you rpboably shouldn't hae tox in a dep list
2014-04-03T19:53:55  <clarkb> if not consuming tox directly
2014-04-03T19:54:06  *** denis_makogon_ is now known as denis_makogon
2014-04-03T19:54:19  <chadlung> clarkb: We are planning to get rid of it
2014-04-03T19:54:42  <chadlung> clarkb: we don't show up in https://github.com/openstack/requirements/blob/master/projects.txt
2014-04-03T19:55:13  <clarkb> chadlung: ya, I wonder if devstack updated how it applies global reqs
2014-04-03T19:55:54  *** ilives has quit IRC
2014-04-03T19:56:07  *** ilives has joined #openstack-infra
2014-04-03T19:56:16  <chadlung> clarkb: I was checking commit history, since our devstack gate broke this morning it didn't look like the recent devstack commits would've done that
2014-04-03T19:56:28  *** rwsu has joined #openstack-infra
2014-04-03T19:57:01  <fungi> clarkb: i believe this is related to ruhe's issue earlier
2014-04-03T19:57:12  <clarkb> fungi: oh good point /me checks scrollback
2014-04-03T19:57:16  <fungi> i suspect it's a regression in devstack
2014-04-03T19:57:40  <clarkb> ya
2014-04-03T19:57:56  <fungi> clarkb: i can't find anywhere in devstack now that provides a means to conditionally bypass the requirements override and the check for missing global reqs
2014-04-03T19:58:39  <dstufft> chadlung: wat, python-barbicanclient shouldn't have tox in it's requirements, only i's test requirements? unless my understand of pbr or global requirements is wrong :|
2014-04-03T19:58:46  <clarkb> I11acb169e74069be0618e57496ff342f9e788493 that change maybe?
2014-04-03T19:58:56  <clarkb> dstufft: not even its test requirements
2014-04-03T19:58:59  <sdague> what's up?
2014-04-03T19:59:07  <clarkb> dstufft: it is a meta requirement, where if you have it installed you can use it
2014-04-03T19:59:18  <chadlung> dstufft: I'm pulling it out on my fork to test with DevStack. See if that works.
2014-04-03T19:59:19  <sdague> requirements vs. devstack?
2014-04-03T19:59:21  <clarkb> sdague: devstack breaking on global reqs for non integrated things
2014-04-03T19:59:24  <clarkb> sdague: y
2014-04-03T19:59:30  <dstufft> clarkb: chadlung oh well that's probably my fault then
2014-04-03T19:59:37  <dstufft> why it's there that is
2014-04-03T19:59:44  <dstufft> I blame pbr reading requirements.txt
2014-04-03T19:59:45  <dstufft> :D
2014-04-03T20:00:47  <sdague> fungi: jogo added an enforcer on update.py
2014-04-03T20:01:00  <sdague> what we should probably do it make the enforcement optional
2014-04-03T20:01:09  <clarkb> oh it was requirements change that did it?
2014-04-03T20:01:09  <sdague> based on an environment variable
2014-04-03T20:01:12  <sdague> yes
2014-04-03T20:01:31  <sdague> update.py now exits badly if it finds something that is not in the requirements list
2014-04-03T20:01:40  <anteaya> yay
2014-04-03T20:01:43  <fungi> sdague: yep, that seems to be the issue. probably should just dynamically base it on whether the project being setup is in projects.txt in the reqs repo
2014-04-03T20:01:58  *** bhuvan_ has joined #openstack-infra
2014-04-03T20:01:59  <anteaya> all programs have at least one ptl candidate
2014-04-03T20:02:10  <anteaya> and as of right now we have 6 elections
2014-04-03T20:02:24  <fungi> anteaya: yep, jogo is out of luck for getting to be a de-facto ptl
2014-04-03T20:02:28  *** harlowja has quit IRC
2014-04-03T20:02:30  <sdague> fungi: well, I think that gets more complicated than you imagine
2014-04-03T20:02:37  <anteaya> he will have to be faster next time
2014-04-03T20:02:52  <sdague> I honestly think an override per job that is to ignore non standard requirements would be the right call
2014-04-03T20:03:06  <clarkb> sdague: can't it key off of projects.txt?
2014-04-03T20:03:13  <clarkb> if project not in projects.txt move on
2014-04-03T20:03:23  <sdague> the problem there
2014-04-03T20:03:31  *** harlowja has joined #openstack-infra
2014-04-03T20:03:41  <sdague> is if someone gets a git tree into a job, not in projects.txt, it can wedge everything
2014-04-03T20:03:53  * anteaya goes for a walk
2014-04-03T20:03:56  *** ilives has quit IRC
2014-04-03T20:04:04  <fungi> sdague: clarkb: i suppose devstack-gate could compare ZUUL_PROJECT against openstack/requirements:projects.txt and then export an envvar for whether or not devstack should pass an option into the updater to enforce or not enforce
2014-04-03T20:04:10  <sdague> I think it should be a global lever
2014-04-03T20:04:24  <clarkb> sdague: gotcha
2014-04-03T20:04:31  <clarkb> global per test
2014-04-03T20:04:37  <sdague> clarkb: yes
2014-04-03T20:04:38  <fungi> that, yeah
2014-04-03T20:04:46  <sdague> and not dynamically
2014-04-03T20:04:50  <sdague> so they have to add
2014-04-03T20:04:59  *** ilives has joined #openstack-infra
2014-04-03T20:05:08  <sdague> NON_STANDARD_REQS=1
2014-04-03T20:05:09  *** bhuvan has quit IRC
2014-04-03T20:05:16  <sdague> then it would be a warning
2014-04-03T20:05:18  <fungi> so i don't think the job definition needs it, devstack-gate can figure it out, right?
2014-04-03T20:05:20  *** bhuvan_ is now known as bhuvan
2014-04-03T20:05:31  <sdague> which would also be really help in understanding which projects are outside of it or not
2014-04-03T20:05:42  *** _nadya_ has joined #openstack-infra
2014-04-03T20:05:56  <sdague> fungi: well we got into this because we discovered only very late that trove wasn't in projects.txt or doing req jobs
2014-04-03T20:06:01  <fungi> sdague: otherwise we can no longer reuse any dsvm job names on non-openstack projects
2014-04-03T20:06:01  <sdague> and had a bunch of extra reqs
2014-04-03T20:06:09  <clarkb> fungi: right so sdague is saying it should be explicit and not implicit
2014-04-03T20:06:13  <clarkb> so that stuff doesn't sneak by
2014-04-03T20:06:19  *** HenryG has quit IRC
2014-04-03T20:06:24  *** dprince has quit IRC
2014-04-03T20:06:38  <sdague> fungi: but we don't anyway right?
2014-04-03T20:06:44  <sdague> because they would co-gate if we did
2014-04-03T20:06:49  <fungi> so we should have one set of dsvm jobs for projects which get enforcement, and another for projects which don't
2014-04-03T20:06:57  <sdague> we are clearly not going to co-gate with a project that doesn't do global reqs
2014-04-03T20:07:02  <fungi> sdague: that's a good point
2014-04-03T20:07:08  <clarkb> ++
2014-04-03T20:07:18  *** CaptTofu has joined #openstack-infra
2014-04-03T20:07:37  *** rwsu has quit IRC
2014-04-03T20:08:00  <sdague> ok, so it's late enough in the day that I'm bad at picking variable names
2014-04-03T20:08:09  <sdague> so if someone picks it, I'll do the update.py patch
2014-04-03T20:08:36  <clarkb> fungi: https://review.openstack.org/#/c/84828/ has a comment now.  Ithink that will fix the test problem
2014-04-03T20:08:38  <fungi> $FRED={branch:-foo}
2014-04-03T20:08:58  <fungi> even my joke code has syntax errors. oh well
2014-04-03T20:09:08  *** rwsu has joined #openstack-infra
2014-04-03T20:09:24  <clarkb> fungi: close enough :)
2014-04-03T20:09:56  <fungi> clarkb: thanks--i'll see if i can get that to pass
2014-04-03T20:10:38  <clarkb> jogo: https://review.openstack.org/#/c/84913/1 wow that is really unhappy :)
2014-04-03T20:11:01  *** rwsu has quit IRC
2014-04-03T20:11:44  *** rwsu has joined #openstack-infra
2014-04-03T20:12:11  *** ociuhandu has quit IRC
2014-04-03T20:13:27  <openstackgerrit> Derek Higgins proposed a change to openstack-infra/config: Increase min-ready for tripleo-f20 nodes  https://review.openstack.org/85160
2014-04-03T20:13:47  <sdague> how do I fixture the environment?
2014-04-03T20:14:16  <clarkb> sdague: one sec
2014-04-03T20:14:53  <clarkb> sdague: https://pypi.python.org/pypi/fixtures EnvironmentVariable ?
2014-04-03T20:15:39  *** malini_afk is now known as malini
2014-04-03T20:16:27  <jogo> clarkb: global reqs broke it, have to test locally first
2014-04-03T20:16:59  <clarkb> jogo: because those packages aren't in the mirror?
2014-04-03T20:17:27  <openstackgerrit> Jeremy Stanley proposed a change to openstack-infra/config: New gerrit group - oslo-messaging-core  https://review.openstack.org/85162
2014-04-03T20:19:16  <clarkb> mtreinish: re https://review.openstack.org/#/c/84840/1 I am pretty sure I pointed that out to sdague when it went in and he wanted that behavior is this something we should chat about before fixing?
2014-04-03T20:19:27  *** julim has quit IRC
2014-04-03T20:19:36  * fungi is disappearing for a bit to cook dinner
2014-04-03T20:19:50  <sdague> clarkb: honestly, I could go either way at this point
2014-04-03T20:19:55  <mtreinish> clarkb: well it doesn't make any sense to run non neutron jobs on neutron patches
2014-04-03T20:20:01  <mtreinish> it just wastes a node
2014-04-03T20:20:16  <mtreinish> and bounces neutron patches for no reason
2014-04-03T20:21:11  <mtreinish> but if there's a counter point I'm overlooking we can look at it
2014-04-03T20:21:11  <jogo> clarkb: yup
2014-04-03T20:21:38  <clarkb> mtreinish: not really, more just sanity check since a month ago we went yes this is wrong but oh well :)
2014-04-03T20:22:04  <sdague> mtreinish: well if there is going to be a separate template, it should pull in all the neutron common jobs
2014-04-03T20:22:11  <sdague> and do neutron client as well, right?
2014-04-03T20:22:17  <nibalizer> zaro: puppetboard.o.o is a cname for puppetdb.o.o so we're talking about the same thing
2014-04-03T20:22:23  <nibalizer> zaro: what is your desired end state?
2014-04-03T20:22:53  <nibalizer> basically you won't have review-dev appearing as a node in puppetboard until you run the agent on it
2014-04-03T20:22:54  <sdague> the reason for the one template was most to avoid human error, even if it means there is whitespace where the test doesn't mean anything
2014-04-03T20:23:50  <openstackgerrit> A change was merged to openstack-infra/config: Add stable filters for neutron functional+api jobs  https://review.openstack.org/84815
2014-04-03T20:23:50  <mtreinish> sdague: yeah I should switch neutronclient too
2014-04-03T20:23:56  <mtreinish> one sec I'll update the patch
2014-04-03T20:23:57  <clarkb> sdague: mtreinish: yes covering the client too would be good
2014-04-03T20:24:00  <clarkb> mtreinish: thanks
2014-04-03T20:24:07  <msabramo> clarkb: thanks for the review on https://review.openstack.org/84950 !
2014-04-03T20:24:08  <sdague> and if it's neutron specific
2014-04-03T20:24:18  <sdague> pull *all* the common jobs between them into that template
2014-04-03T20:24:38  <sdague> so we don't run into the issue again later with only updating one or the other
2014-04-03T20:26:09  <mtreinish> sdague: wouldn't that mean adding the neutron template to every project that uses the integrated-gate template?
2014-04-03T20:26:24  <sdague> mtreinish: no
2014-04-03T20:26:34  <sdague> why would it ?
2014-04-03T20:26:48  <mtreinish> maybe I misread
2014-04-03T20:26:53  <clarkb> I think sdague is proposing two common lists
2014-04-03T20:26:57  <clarkb> one for not neutron and another for neutron
2014-04-03T20:27:05  <clarkb> they may have some overlap, but will be different
2014-04-03T20:27:05  <sdague> right, that
2014-04-03T20:27:30  *** rwsu has quit IRC
2014-04-03T20:27:58  <sdague> which is actually what https://review.openstack.org/#/c/84840/ is
2014-04-03T20:28:24  <mtreinish> ok that's probably why I was confused
2014-04-03T20:28:32  <sdague> but if we are bothering to carve off the integrated-gate-neutron template, and it's really only 2 jobs, we should do all the overlap
2014-04-03T20:28:59  <sdague> so add check-grenade-dsvm-neutron, check-tempest-dsvm-neutron-pg
2014-04-03T20:29:12  <sdague> and everything else that's common between neutron and python-neutronclient
2014-04-03T20:29:19  <clarkb> SlickNik: mtreinish sdague https://review.openstack.org/#/c/84369/1 removes a trove job, we hae that coverred as the integrated gate now?
2014-04-03T20:29:29  <sdague> clarkb: yes
2014-04-03T20:29:35  <sdague> trove is in the regular gate now
2014-04-03T20:29:38  <clarkb> woot /me approves
2014-04-03T20:29:43  <sdague> let me double check
2014-04-03T20:30:05  <sdague> http://logs.openstack.org/42/85142/1/check/check-tempest-dsvm-full/0e1d2c9/console.html#_2014-04-03_19_36_48_522
2014-04-03T20:30:06  <sdague> yes
2014-04-03T20:30:10  <sdague> in the regular gate
2014-04-03T20:30:19  <clarkb> approved
2014-04-03T20:31:03  *** rwsu has joined #openstack-infra
2014-04-03T20:31:16  *** slagle has joined #openstack-infra
2014-04-03T20:31:18  *** VijayTripathi has joined #openstack-infra
2014-04-03T20:33:23  <mtreinish> sdague: does the cells job run with neutron?
2014-04-03T20:33:52  <clarkb> mtreinish: I think no, unless there is a specific cells job for it
2014-04-03T20:34:07  <mtreinish> clarkb: ok then I should remove that from neutronclient too
2014-04-03T20:34:25  <clarkb> mtreinish: let me double check
2014-04-03T20:34:40  <sdague> mtreinish: I doubt it
2014-04-03T20:34:50  <slagle> hi, i don't seem to have permissions to create branches for the tripleo projects (i'm in the tripleo-ptl) group in gerrit
2014-04-03T20:34:56  <slagle> are there some additional permissions that are needed?
2014-04-03T20:35:00  <clarkb> mtreinish: no neutron
2014-04-03T20:35:09  <mtreinish> clarkb: ok thanks
2014-04-03T20:35:11  <clarkb> slagle: which project? I can take a look
2014-04-03T20:35:13  *** VijayTripathi has quit IRC
2014-04-03T20:35:18  <clarkb> slagle: any specific examples?
2014-04-03T20:35:30  <slagle> clarkb: tripleo-image-elements is one
2014-04-03T20:35:34  <slagle> clarkb: using the ui, https://review.openstack.org/#/admin/projects/openstack/tripleo-image-elements,branches
2014-04-03T20:35:36  *** derekh has quit IRC
2014-04-03T20:36:22  <slagle> if i try to create one called stable/icehouse, i get: Cannot create refs/heads/stable/icehouse
2014-04-03T20:36:32  <clarkb> slagle: so if we look at https://review.openstack.org/#/admin/projects/openstack/tripleo-image-elements,access tripleo-ptl has no refs/heads/* create permissions. Let me get an example of what perms are needed and you can propose that change
2014-04-03T20:36:40  <openstackgerrit> Matthew Treinish proposed a change to openstack-infra/config: Only run jobs with neutron on neutron changes  https://review.openstack.org/84840
2014-04-03T20:36:51  <mtreinish> clarkb, sdague: I think that got everything
2014-04-03T20:36:57  <slagle> clarkb: awesome, thanks
2014-04-03T20:37:13  *** thuc has quit IRC
2014-04-03T20:37:44  <openstackgerrit> A change was merged to openstack-infra/config: Remove experimental trove devstack-gate job  https://review.openstack.org/84369
2014-04-03T20:37:50  *** thuc has joined #openstack-infra
2014-04-03T20:39:14  *** gondoi is now known as zz_gondoi
2014-04-03T20:39:21  *** thuc_ has joined #openstack-infra
2014-04-03T20:39:33  <openstackgerrit> Matthew Treinish proposed a change to openstack-infra/config: Change names for duplicate neutron jobs  https://review.openstack.org/83172
2014-04-03T20:39:45  <clarkb> slagle: actually I can't fine a good example quickly. but under the refs/heads/* perms for triple* files in https://git.openstack.org/cgit/openstack-infra/config/tree/modules/openstack_project/files/gerrit/acls/openstack you want to add 'create = tripleo-ptl'
2014-04-03T20:39:52  <clarkb> slagle: that will allow you to create branches
2014-04-03T20:40:07  <clarkb> make those changes, propose them to gerrit and we should get that in for you torrow
2014-04-03T20:40:10  <clarkb> *tomorrow
2014-04-03T20:40:20  *** khyati has quit IRC
2014-04-03T20:40:38  *** david-lyle has joined #openstack-infra
2014-04-03T20:40:43  *** thuc__ has joined #openstack-infra
2014-04-03T20:40:45  *** rainya- has joined #openstack-infra
2014-04-03T20:40:53  *** khyati has joined #openstack-infra
2014-04-03T20:41:17  <SlickNik> clarkb: As Sean said, it's part of the integrated gate now, so needed to be removed. Thanks!
2014-04-03T20:41:54  *** thuc has quit IRC
2014-04-03T20:42:07  <slagle> clarkb: cool, thanks
2014-04-03T20:42:39  *** _nadya_ has quit IRC
2014-04-03T20:42:41  <meera> hello all: I'm trying to figure out who I should contact to get resolution on an issue I'm having while doing a git review. I'm trying to submit code to tempest. The issue I'm having is "fatal: ICLA contributor agreement requires current contact information.". I have updated the contact information and in the Agreements settings I have verified the ICLA license agreement exists. I have uploaded newly generated ssh public key to gerrit and
2014-04-03T20:42:41  <meera> launchpad systems. Is there someone who I can work with one on one on getting this issue resolved?
2014-04-03T20:42:49  <openstackgerrit> Sean Dague proposed a change to openstack/requirements: allow for NON_STANDARD_REQS override  https://review.openstack.org/85167
2014-04-03T20:42:56  <sdague> clarkb: ^^^
2014-04-03T20:43:15  <sdague> going for a walk while there is sun, but that should be the fix needed for barbican
2014-04-03T20:43:21  <clarkb> mtreinish: reviewed, there is a tyop
2014-04-03T20:43:24  <openstackgerrit> Matthew Treinish proposed a change to openstack-infra/config: Change names for duplicate neutron jobs  https://review.openstack.org/83172
2014-04-03T20:43:24  <openstackgerrit> Matthew Treinish proposed a change to openstack-infra/config: Only run jobs with neutron on neutron changes  https://review.openstack.org/84840
2014-04-03T20:43:40  <clarkb> meera: yes, I can help with that
2014-04-03T20:43:41  <mtreinish> clarkb: yeah, '=' != '-'
2014-04-03T20:44:14  <meera> thanks clark
2014-04-03T20:44:17  <clarkb> meera: are you sure that the usernames match up? make sure the username at https://review.openstack.org/#/settings/ matches the one in the gerrit remote shown by git remote -v
2014-04-03T20:44:33  <clarkb> meera: you may be trying to use two different accounts and the wires are getting crossed
2014-04-03T20:44:38  *** thuc_ has quit IRC
2014-04-03T20:45:51  <openstackgerrit> Cyril Roelandt proposed a change to openstack-infra/config: heatclient: make the py33 gate voting  https://review.openstack.org/85170
2014-04-03T20:45:54  *** marun_afk is now known as marun
2014-04-03T20:46:17  <openstackgerrit> James Slagle proposed a change to openstack-infra/config: Allow tripleo-ptl group to create branches  https://review.openstack.org/85171
2014-04-03T20:46:25  <meera> clarkb: THe username match
2014-04-03T20:46:34  *** dcramer_ has quit IRC
2014-04-03T20:46:45  <clarkb> meera: can you give me your account number? it is shown on that settings page I linked you
2014-04-03T20:46:54  <clarkb> I will poke at the DB and see what may be going on
2014-04-03T20:47:16  <meera> clarkb: 2846
2014-04-03T20:49:13  *** chadlung has quit IRC
2014-04-03T20:50:42  <clarkb> meera: the db shows you haven't filed contact info. can you update your info at https://review.openstack.org/#/settings/contact and see if that helps
2014-04-03T20:51:11  <meera> clarkb: I have updated the contact info couple of times. I can give it another try
2014-04-03T20:51:13  *** bhuvan_ has joined #openstack-infra
2014-04-03T20:51:44  *** dkehn has quit IRC
2014-04-03T20:52:34  <clarkb> meera: it isn't showing as having been done. are the changes being saved?
2014-04-03T20:53:51  *** dkehn has joined #openstack-infra
2014-04-03T20:53:58  *** bhuvan has quit IRC
2014-04-03T20:54:04  <jeblair> lastlog mordred
2014-04-03T20:54:09  *** bhuvan_ is now known as bhuvan
2014-04-03T20:54:25  <mordred> lastlog jeblair
2014-04-03T20:54:28  <jeblair> oops; that was my way of looking up the board number again :)
2014-04-03T20:54:31  <mordred> :)
2014-04-03T20:54:47  <meera> clarkb: The updates I made to the Contact information did not include Fax Number. This time around I did put in Fax as well and it went through
2014-04-03T20:55:11  *** amcrn has joined #openstack-infra
2014-04-03T20:55:12  <clarkb> meera: I see the DB updated with a timestamps saying they were filed
2014-04-03T20:55:22  <clarkb> meera: try pushing changes now
2014-04-03T20:55:25  <jeblair> but it had the side benefit of showing me: 05:03  * mordred throws wet cats into the air
2014-04-03T20:55:29  <meera> clarkb: it worked
2014-04-03T20:55:40  <meera> clarkb: thanks a lot
2014-04-03T20:55:50  <mtreinish> mordred: could I get added to the cookiecutter-core group after: https://review.openstack.org/#/c/83192/ goes through?
2014-04-03T20:56:08  <mordred> jeblair: you shold never miss such things
2014-04-03T20:56:11  <mordred> mtreinish: sure
2014-04-03T20:56:19  <mtreinish> cool
2014-04-03T20:56:38  <mordred> I beleive I'm one of the only person who ever reviews cookiecutter patches :)
2014-04-03T20:56:58  *** pfallenop has quit IRC
2014-04-03T20:57:31  *** CaptTofu has quit IRC
2014-04-03T20:57:37  <mtreinish> mordred: well I'll start doing that too then
2014-04-03T20:57:54  <mtreinish> I actually have been meaning to push a couple of updates to the cookiecutter repo that I found making the specs repo
2014-04-03T20:58:00  <mtreinish> I'll try to do that tomorrow
2014-04-03T20:58:06  *** CaptTofu has joined #openstack-infra
2014-04-03T20:58:23  <fungi> okay, back...
2014-04-03T20:58:36  *** chadlung has joined #openstack-infra
2014-04-03T20:58:48  <mtreinish> clarkb: jenkins likes the latestst revision without the typo :)
2014-04-03T20:59:12  *** gokrokve_ has joined #openstack-infra
2014-04-03T21:01:38  *** lcostantino has quit IRC
2014-04-03T21:01:54  *** yolanda has quit IRC
2014-04-03T21:02:18  *** CaptTofu has quit IRC
2014-04-03T21:02:25  *** pdmars has quit IRC
2014-04-03T21:02:34  *** gokrokve has quit IRC
2014-04-03T21:03:27  <chadlung> Barbican was incubated last month, do we need to add ourselves to openstack/requirements/projects.txt   Or...?
2014-04-03T21:03:45  *** rfolco has quit IRC
2014-04-03T21:04:02  <fungi> meera: clarkb: just for clarification, https://wiki.openstack.org/wiki/CLA-FAQ#Why_am_I_getting_an_error_message_about_the_ICLA_requiring_contact_information_when_trying_to_submit_patches_for_review.3F
2014-04-03T21:04:07  <clarkb> chadlung: eventually you will need to, first step is getting your reqs to make the global reqs
2014-04-03T21:04:22  *** aysyd has quit IRC
2014-04-03T21:04:31  *** markmc has quit IRC
2014-04-03T21:04:49  <chadlung> clarkb: cool, thanks
2014-04-03T21:04:57  <clarkb> mtreinish: roger, will rereviews shortly. I need food now that board meeting is over
2014-04-03T21:10:32  *** dkranz has quit IRC
2014-04-03T21:11:34  <adam_g> 'OpenStack 2013.2.3 released' needs moderator approval if anyone here has access to approve mail to openstack-announce
2014-04-03T21:13:41  <openstackgerrit> Alex Conrad proposed a change to openstack-infra/jenkins-job-builder: add ability to parse from a file object  https://review.openstack.org/85177
2014-04-03T21:14:28  <fungi> adam_g: i'll check
2014-04-03T21:15:13  *** ameade has quit IRC
2014-04-03T21:15:47  <fungi> adam_g: you want ttx, reed or markmc
2014-04-03T21:16:42  *** dkehn has quit IRC
2014-04-03T21:16:43  <adam_g> fungi, ah, thanks anyway!
2014-04-03T21:16:50  <fungi> adam_g: you might also want to ask ttx to set you to automatically approved bypassing moderation on that list since you need to send release announcements regularly
2014-04-03T21:17:16  <adam_g> fungi, i think i had that for my old email
2014-04-03T21:17:58  *** dizquierdo has joined #openstack-infra
2014-04-03T21:18:02  <fungi> adam_g: right, maybe you just need to update your old subscription? i can't remember if the whitelists follow subscription changes
2014-04-03T21:18:27  *** dkehn has joined #openstack-infra
2014-04-03T21:19:02  *** weshay has quit IRC
2014-04-03T21:22:08  *** rwsu has quit IRC
2014-04-03T21:23:22  <fungi> jeblair: not sure if you did anything, but...
2014-04-03T21:23:25  <fungi> | 3428217 | rax-dfw            | bare-precise           | jenkins01 | bare-precise-rax-dfw-3428217.slave.openstack.org               | bare-precise-rax-dfw-3428217               | 9503f200-3fa4-4cfd-a5b9-733e62cec8f8 | 67.192.246.115  | ready    | 0.16        |
2014-04-03T21:23:36  <fungi> jeblair: oh, nevermind
2014-04-03T21:23:50  <lifeless> ok theres something wrong again
2014-04-03T21:24:00  <lifeless> we're seeing jobs try and requeue
2014-04-03T21:24:13  <fungi> i should look closer when i search for three valid hex digits in lists which contain long hex strings
2014-04-03T21:24:42  <fungi> lifeless: i'll take a look in the log
2014-04-03T21:25:03  *** yassine has joined #openstack-infra
2014-04-03T21:25:20  *** dkehn has quit IRC
2014-04-03T21:25:38  *** pfallenop has joined #openstack-infra
2014-04-03T21:25:51  <zaro> nibalizer: yeah, i get it.  fungi help me understand that.  i'm still hacking on review-dev will run the agent when i'm done with it.
2014-04-03T21:26:42  <fungi> lifeless: nodepool's getting a lot of "Exception: Timeout waiting for ssh access" trying to build new nodes, so i suspect you may have something also killing network connectivity between jenkins and the slave agents as well. looking for stronger evidence
2014-04-03T21:26:45  *** dkehn has joined #openstack-infra
2014-04-03T21:27:13  *** yassine has quit IRC
2014-04-03T21:27:44  <fungi> also nodepool build errors like "Exception: Timeout waiting for server 856ad456-7e20-4a8c-9c73-49a8799f7955 deletion in tripleo-test-cloud"
2014-04-03T21:27:44  *** yassine has joined #openstack-infra
2014-04-03T21:27:57  <lifeless> nova floating-ip-list
2014-04-03T21:27:58  <lifeless> ERROR: HTTPSConnectionPool(host='ci-overcloud.tripleo.org', port=13000): Max retries exceeded with url: /v2.0/tokens (Caused by <class 'socket.error'>: [Errno 110] Connection timed out)
2014-04-03T21:28:01  <lifeless> control plane is looking bad
2014-04-03T21:28:02  <fungi> er, delete errors, not build errors
2014-04-03T21:28:35  <mattoliverau> Momring
2014-04-03T21:28:43  <anteaya> hey mattoliverau
2014-04-03T21:28:44  <clarkb> mattoliverau: good momring
2014-04-03T21:28:46  <sdague> wow, fedora mirrors are kind of terribad on availability
2014-04-03T21:28:46  <lifeless> SpamapS: so
2014-04-03T21:28:52  <nibalizer> zaro: cool
2014-04-03T21:29:13  <sdague> I managed to race crash every other devstack change with a fedora mirror timeout on that iso
2014-04-03T21:29:15  <adam_g> is removing a -2 with a 0 expected to re-trigger gate checks?
2014-04-03T21:29:25  <fungi> sdague: no joke. if someone fails to download a cd image, they'll just retry. no biggie right?
2014-04-03T21:29:26  <mattoliverau> anteaya: Tent on a barge huh, sure why not :)
2014-04-03T21:29:27  <sdague> adam_g: if it's old enough, yes
2014-04-03T21:29:35  <anteaya> mattoliverau: wfm
2014-04-03T21:29:41  <anteaya> actually I really like the idea
2014-04-03T21:29:46  <clarkb> sdague: nice
2014-04-03T21:29:51  <sdague> fungi: so that's probably at minimum a 5% fail rate by fedora mirrors
2014-04-03T21:30:02  <sdague> howmuch retry logic is in nodepool?
2014-04-03T21:30:17  <fungi> sdague: i believe none. maybe less
2014-04-03T21:30:27  <sdague> heh
2014-04-03T21:30:37  <fungi> sdague: unless you could trying again the next day as retry logic
2014-04-03T21:30:37  *** yassine has quit IRC
2014-04-03T21:30:43  <fungi> s/could/count/
2014-04-03T21:30:46  <adam_g> sdague, hmph okay. ive got  ~70 -2's to remove. :|
2014-04-03T21:30:50  *** malini is now known as malini_afk
2014-04-03T21:31:05  * adam_g thinks we need a better way to handle freezing stable branches in preparation for release
2014-04-03T21:31:12  <fungi> adam_g: you could script that--gerrit has an api
2014-04-03T21:31:13  *** yassine has joined #openstack-infra
2014-04-03T21:31:13  *** yassine has quit IRC
2014-04-03T21:31:36  *** zns has quit IRC
2014-04-03T21:31:39  <sdague> adam_g: so why not take the time to do actual review on those patches in the process?
2014-04-03T21:31:39  <adam_g> fungi, yeah, i have a script to do it.. but was worried about flooding
2014-04-03T21:32:01  <fungi> adam_g: we'll send agents to your house if the flood gets too bad--that's all
2014-04-03T21:32:16  <sdague> the freshness checks are there for a reason, stable was especially vulnerable to having out of date test results
2014-04-03T21:32:24  <sdague> and wrecking the gate
2014-04-03T21:32:31  <lifeless> [117125.821389] hpsa 0000:06:00.0: cmd_alloc returned NULL!
2014-04-03T21:32:31  <lifeless> [118130.535271] hpsa 0000:06:00.0: cmd_alloc returned NULL!
2014-04-03T21:32:37  <lifeless> rebooting the undercloud
2014-04-03T21:32:39  <adam_g> sdague, many of them are already reviewed. the -2 is just there to prevent htem from merging during the 1 week freeze
2014-04-03T21:32:41  <fungi> adam_g: i wouldn't sweat changing votes on 70 changes in one shot through the api
2014-04-03T21:32:48  <lifeless> erm
2014-04-03T21:32:50  <lifeless> control node
2014-04-03T21:32:52  <sdague> adam_g: sure
2014-04-03T21:32:54  <adam_g> fungi, ack
2014-04-03T21:32:57  <sdague> but they need good test results
2014-04-03T21:33:10  <mordred> clarkb: what's the deal with the new zuul noop stuff?
2014-04-03T21:33:26  <sdague> because if they sat for a week, they might be failing due to a client or library update
2014-04-03T21:33:26  <lifeless> SpamapS: help me rhonda....
2014-04-03T21:33:28  <clarkb> mordred: noop is a built in job that zuul succeed immedaitely without queueing to gearman
2014-04-03T21:33:31  <adam_g> sdague, i'm not arguing against the re-checks
2014-04-03T21:33:36  <clarkb> mordred: so you can save resources running noop jobs
2014-04-03T21:33:37  <mordred> clarkb: I was just telling cody-somerville about it - but I realized I didn't know that much
2014-04-03T21:33:43  <sdague> so it will just take time
2014-04-03T21:33:47  *** ociuhandu has joined #openstack-infra
2014-04-03T21:33:54  *** dkehn has quit IRC
2014-04-03T21:33:55  <sdague> but it is actually time well spent
2014-04-03T21:33:58  <mordred> clarkb: so one just s/gate-noop/noop/ in layout.yaml ?
2014-04-03T21:34:01  <adam_g> sdague, thats fine. was just covering my ass in case someone asked 'wtf?' :)
2014-04-03T21:34:10  <fungi> mordred: yep
2014-04-03T21:34:15  <clarkb> mordred: yes, but you need to have a version of zuul new enough to do that
2014-04-03T21:34:20  <mordred> clarkb: kk
2014-04-03T21:34:23  <mordred> cody-somerville: ^^
2014-04-03T21:34:25  <clarkb> mordred: also my remote fetch change is getting close to being mergable I think
2014-04-03T21:34:32  <mordred> woot
2014-04-03T21:34:36  <clarkb> mordred: so hopefully cody can go to using upstream master soon
2014-04-03T21:34:45  <sdague> and zuul is basically empty
2014-04-03T21:34:47  <mordred> I support such things
2014-04-03T21:35:58  *** mfer has quit IRC
2014-04-03T21:36:02  *** dkehn has joined #openstack-infra
2014-04-03T21:36:11  <sdague> so a flood will flush in a couple hours
2014-04-03T21:36:11  <sdague> so like fungi said, just bring it on :)
2014-04-03T21:36:22  <sdague> heh
2014-04-03T21:36:44  <openstackgerrit> Clark Boylan proposed a change to openstack-infra/zuul: Add a remote url override location  https://review.openstack.org/76057
2014-04-03T21:36:51  <clarkb> mordred: ^
2014-04-03T21:37:05  *** weshay has joined #openstack-infra
2014-04-03T21:37:14  <clarkb> jeblair: ok now I think that is really ready for proper review. jhesketh has done a good job pushing me along and I think I have addressed his concerns now
2014-04-03T21:37:30  <sdague> adam_g: zuul was getting bored with the light load anyway, time to make him work
2014-04-03T21:38:55  <NobodyCam> any one seen this before? hudson.util.IOException2: remote file operation failed: /tmp/hudson5356793296994292431.sh at hudson.remoting.Channel@179cda28:tripleo-precise-tripleo-test-cloud-3427617
2014-04-03T21:39:04  *** zns has joined #openstack-infra
2014-04-03T21:39:32  *** HenryG has joined #openstack-infra
2014-04-03T21:39:34  *** zehicle has joined #openstack-infra
2014-04-03T21:39:52  <jeblair> fungi: okay, i am just now starting to look into the allocator
2014-04-03T21:40:08  *** eharney has quit IRC
2014-04-03T21:40:29  *** jhesketh_ has joined #openstack-infra
2014-04-03T21:41:18  *** jhesketh_ is now known as jhesketh
2014-04-03T21:41:26  <fungi> jeblair: yeah, i'm not spotting what's holding the demand down to 0 there
2014-04-03T21:41:40  <jhesketh> Morning
2014-04-03T21:41:43  <fungi> jeblair: the logic in that part of the source looks sound to me
2014-04-03T21:42:04  <clarkb> jhesketh: hi there, thank you for the review on 76057, I think I have it cleaned up now
2014-04-03T21:42:14  *** jeckersb is now known as jeckersb_gone
2014-04-03T21:42:30  <jhesketh> cool, I'll take a look
2014-04-03T21:42:33  <clarkb> fungi: derekh was theorizing that the nodes may not be building due to provider manager queueing
2014-04-03T21:42:47  *** dcramer_ has joined #openstack-infra
2014-04-03T21:42:51  <clarkb> fungi: bascically they got stuck behind the mass of tripleo-precise stuff (but that doesn't seem super likely0
2014-04-03T21:43:05  <jeblair> 2014-04-03 21:41:13,126 DEBUG nodepool.NodePool:     <AllocationRequest for 1.0 of tripleo-f20>
2014-04-03T21:43:05  <jeblair> 2014-04-03 21:41:13,126 DEBUG nodepool.NodePool:       <AllocationSubRequest for 0.0 (out of 1.0) of tripleo-f20 from tripleo-test-cloud>
2014-04-03T21:43:22  <jeblair> clarkb: i think that doesn't support that idea ^
2014-04-03T21:43:38  <clarkb> jeblair: ya
2014-04-03T21:43:43  <fungi> agreed
2014-04-03T21:44:05  <jeblair> jhesketh: i reviewed up to https://review.openstack.org/#/c/84314/ and ran into a problem
2014-04-03T21:44:21  <jeblair> jhesketh: take a look and let me know what you think.
2014-04-03T21:44:23  <clarkb> jhesketh: one of my inline comment responses about config being rewritten to disk is wrong. If you think my config changes should go in the file and not in the test I can update that too. I personally find it a bit more clear that this new test is doing this additional scenario when it is in the test class
2014-04-03T21:45:23  *** mbacchi has quit IRC
2014-04-03T21:45:25  <jhesketh> jeblair: thanks will do
2014-04-03T21:46:32  <jeblair> jhesketh: for what it's worth, and in case it helps your thinking on the subject, i would seriously entertain removing bootstrap.
2014-04-03T21:47:44  <NobodyCam> -infra question? check-tripleo-ironic-undercloud-precise #180 from https://jenkins04.openstack.org/job/check-tripleo-ironic-undercloud-precise/180/ failed with the hudson error above and ended up with a NONE state. is there a way to get the /var/log directory from the vm in this state?
2014-04-03T21:47:53  <jeblair> jhesketh: also, i hope when you say "Morning" what you really mean is "everybody start telling me what they've been doing for the past few hours all at once!"  :)
2014-04-03T21:48:04  <clarkb> NobodyCam: see scrollback, the test cloud went sideways
2014-04-03T21:48:11  <clarkb> NobodyCam: I think it is just a side effect of that
2014-04-03T21:48:21  <fungi> NobodyCam: ENOCLOUD
2014-04-03T21:48:29  <jhesketh> jeblair: heh, yep! sure beats scrollback
2014-04-03T21:48:45  <jhesketh> clarkb: sure, I think your fixes are good
2014-04-03T21:48:49  *** nkinder has quit IRC
2014-04-03T21:48:57  <NobodyCam> ahhh so recheck it is.. but I'll give it a bit
2014-04-03T21:48:58  * jeblair goes back to figuring out why 1==0
2014-04-03T21:48:59  *** fbo is now known as fbo_away
2014-04-03T21:49:15  <openstackgerrit> Michael Krotscheck proposed a change to openstack-infra/storyboard-webclient: Added global CSS class to allow style targeting.  https://review.openstack.org/85185
2014-04-03T21:49:16  <jhesketh> clarkb: I don't mind if the change isn't in the CONFIG file but I'm not sure if it has any purpose otherwise
2014-04-03T21:49:24  <jhesketh> I'll do a review later
2014-04-03T21:49:25  <fungi> jeblair: next you'll go on to prove that black is white and get yourself run over at the next zebra crossing
2014-04-03T21:49:38  *** alexpilotti has quit IRC
2014-04-03T21:49:44  <NobodyCam> fungi: http://www.math.hmc.edu/funfacts/ffiles/10001.1-8.shtml
2014-04-03T21:49:49  <jhesketh> jeblair: So I'm not very keen on spending massive amounts of time on the zuul status stuff (eg removing bootstrap)
2014-04-03T21:50:03  <clarkb> jhesketh: ya, I think I was trying to demo too much of what I was thinking of in the general case
2014-04-03T21:50:13  <jeblair> jhesketh: heh, that's the same reason i mentioned removing bootstrap.  :)
2014-04-03T21:50:15  <clarkb> jhesketh: different base config, different knobs tweaked and so on
2014-04-03T21:50:18  <fungi> NobodyCam: nice! i'd never seen that one
2014-04-03T21:50:32  <NobodyCam> :-p
2014-04-03T21:51:11  <clarkb> jhesketh: http://git.openstack.org/cgit/openstack-infra/zuul/tree/tests/test_scheduler.py#n826 is the line that originally made me think I needed a different file but now I see it is writing to memory and not disk
2014-04-03T21:51:40  <jhesketh> jeblair: heh
2014-04-03T21:51:49  <jhesketh> jeblair: Thanks for the improvements to it though! :-)
2014-04-03T21:52:10  <clarkb> fungi: maybe we can convince jeblair to solve P=NP
2014-04-03T21:52:18  <jhesketh> clarkb: righto, did you want to tidy that up before I re-review?
2014-04-03T21:52:28  <cody-somerville> clarkb: How do you guys deal with nodepool being rate limited?
2014-04-03T21:52:31  <fungi> clarkb: i suspect he already has and is just waiting for the right time to make it public
2014-04-03T21:52:51  <jeblair> fungi: as soon as i'm done with reviews
2014-04-03T21:52:55  <fungi> hah
2014-04-03T21:53:06  <clarkb> jhesketh: sure, do you have a preference between only setting it in memory or setting poll=True on disk and the fetch_url in memory
2014-04-03T21:53:26  <clarkb> cody-somerville: you can set a query rate in the nodepool yaml file
2014-04-03T21:53:46  *** masayukig has joined #openstack-infra
2014-04-03T21:53:51  <clarkb> is it in hertz? I would have to reread docs/code to know for sure
2014-04-03T21:54:38  <mordred> clarkb: it should be in hertz if it's not
2014-04-03T21:54:38  <jhesketh> clarkb: Not particularly... I think I'd lean towards config since you have the code there for it, but I do agree with your point about making it slightly clearer what the test is doing differently
2014-04-03T21:54:44  <jeblair> clarkb: i think it ended up being something like 1/hertz
2014-04-03T21:54:51  <jeblair> which should probably be changed
2014-04-03T21:55:06  <mordred> jeblair: perhaps we could start describing nodepool musically
2014-04-03T21:55:08  <clarkb> jhesketh: I am leaning towards removing the on disk file and doing it all in memeory
2014-04-03T21:55:20  <jhesketh> sure
2014-04-03T21:55:43  *** thuc__ has quit IRC
2014-04-03T21:56:18  *** thuc has joined #openstack-infra
2014-04-03T21:57:08  *** slagle has quit IRC
2014-04-03T21:57:18  <jeblair> fungi: has the tripleo backlog ever cleared?
2014-04-03T21:57:46  <fungi> jeblair: no, it made up a lot of ground, but now has begun to grow again due to the latest outage
2014-04-03T21:58:17  <jeblair> i'm wondering if the problem is that nodpool needs 161 servers from tripleo, which can only provide 140
2014-04-03T21:58:19  <fungi> at one point it was down to ~3 hours behind
2014-04-03T21:58:20  <jeblair> er 40
2014-04-03T21:58:53  *** slagle has joined #openstack-infra
2014-04-03T21:59:10  <jeblair> the f20 demand is 0.6% of the total demand
2014-04-03T21:59:17  <fungi> oh! so basically the demand on the tripleo-precise nodes is flooding out the min-ready on the tripleo-f20 node?
2014-04-03T21:59:41  <jeblair> that's what i'm thinking... will try to confirm
2014-04-03T21:59:46  <pleia2> there's a patch up to bump min ready to 2 to try to help this
2014-04-03T21:59:50  <fungi> right, if we bumped it to be 4 or 5 i bet that would be enough to tip the scales
2014-04-03T22:00:09  <pleia2> https://review.openstack.org/#/c/85160/
2014-04-03T22:00:13  <fungi> since right now the demand is just over 4x the max-servers
2014-04-03T22:00:25  *** thuc has quit IRC
2014-04-03T22:00:41  *** dkranz has joined #openstack-infra
2014-04-03T22:01:00  <fungi> and 5 nodes min-ready would be enough to get it to garner 1:40 of the max-servers ratio
2014-04-03T22:01:04  <clarkb> jhesketh: gah, as I start doing this I see other potential problems :)
2014-04-03T22:01:20  <clarkb> jhesketh: CONFIG is global so all these sets potentially get shared across tests...
2014-04-03T22:01:23  <fungi> suggesting that maybe we're not rounding up somewhere we ought to
2014-04-03T22:01:25  <jhesketh> heh :-)
2014-04-03T22:01:27  <clarkb> jhesketh: I need to fix this more problem
2014-04-03T22:01:30  <clarkb> s/problem/properly/
2014-04-03T22:01:59  <fungi> moar problem
2014-04-03T22:02:39  <clarkb> jhesketh: I think it is safe within each test class, but I need a module level global for each of them
2014-04-03T22:03:25  *** rcleere has quit IRC
2014-04-03T22:03:27  *** marun is now known as marun_afk
2014-04-03T22:04:35  *** thuc has joined #openstack-infra
2014-04-03T22:05:50  *** thomasem has quit IRC
2014-04-03T22:08:57  *** zhiyan is now known as zhiyan_
2014-04-03T22:09:48  <openstackgerrit> Clark Boylan proposed a change to openstack-infra/zuul: Add a remote url override location  https://review.openstack.org/76057
2014-04-03T22:10:05  <clarkb> jhesketh: ^ that is sort of an acceptable state. I don't really feel like refactoring the fixtures in this particular change
2014-04-03T22:10:36  <clarkb> jhesketh: but it presents a safe config to each test without cross contamination between classes
2014-04-03T22:11:44  *** reed has joined #openstack-infra
2014-04-03T22:12:09  <jhesketh> clarkb: so if you're setting the config as you need in setUp, why do you need the config there at all?
2014-04-03T22:12:33  <jhesketh> oh, it's not a new file
2014-04-03T22:12:43  <clarkb> jhesketh: to isolate that TEST_CONFIG from the TEST_CONFIG used in other tests
2014-04-03T22:13:13  <clarkb> jhesketh: basically we need two sets in memory and that is a cheap way to do it. Should probably be reworked to haev a configFixture that sets things properly for each test but that is a different change
2014-04-03T22:13:30  *** reed has quit IRC
2014-04-03T22:13:38  <openstackgerrit> Jeremy Stanley proposed a change to openstack-infra/config: Stop using Jenkins SCM plug-in  https://review.openstack.org/81302
2014-04-03T22:14:36  *** HenryG_ has joined #openstack-infra
2014-04-03T22:14:57  <jhesketh> clarkb: why not just move the ConfigParser into SetUp?
2014-04-03T22:15:01  <jhesketh> (ie move CONFIG)
2014-04-03T22:15:17  *** HenryG has quit IRC
2014-04-03T22:15:32  <clarkb> jhesketh: we could, it would make the inheritance a bit more ugly though as I need to preset config in the new class
2014-04-03T22:15:41  <clarkb> jhesketh: so it would need to be ifdef'd like make_dirs
2014-04-03T22:15:41  *** HenryG_ has quit IRC
2014-04-03T22:15:59  <clarkb> jhesketh: I am beginning to think that I should rip out a third class and haev a common base one that doesn't do much
2014-04-03T22:16:05  <clarkb> jhesketh: let me give that whirl
2014-04-03T22:16:10  *** HenryG has joined #openstack-infra
2014-04-03T22:16:34  <clarkb> jhesketh: actually ugh, so much refactoring would need to be done to do that too
2014-04-03T22:16:37  <jhesketh> ah I see
2014-04-03T22:16:52  <jhesketh> yeah, I don't think a base class would be trivial
2014-04-03T22:17:51  <jhesketh> I don't mind how it is, I'm just not a fan of class variables
2014-04-03T22:17:58  <jhesketh> anyway, I'll review it properly soon :-)
2014-04-03T22:19:05  <clarkb> jhesketh: great thank you
2014-04-03T22:19:30  <clarkb> jhesketh: when I have more time I think refactoring it to do what I described and have a proper base with test classes that look like my new test class would be best
2014-04-03T22:19:39  <clarkb> jhesketh: but that is going to be a much larger change
2014-04-03T22:22:04  *** krtaylor has quit IRC
2014-04-03T22:23:16  *** chadlung has quit IRC
2014-04-03T22:23:54  *** changbl has quit IRC
2014-04-03T22:26:19  *** rwsu has joined #openstack-infra
2014-04-03T22:26:44  *** weshay has quit IRC
2014-04-03T22:26:49  *** dstanek has quit IRC
2014-04-03T22:27:08  *** UtahDave has joined #openstack-infra
2014-04-03T22:27:19  *** chuck_ has joined #openstack-infra
2014-04-03T22:28:49  <openstackgerrit> David Caro proposed a change to openstack-infra/jenkins-job-builder: Added parallelization options  https://review.openstack.org/75514
2014-04-03T22:30:40  <mikal> anteaya: what do you think of this? Its a new prototype of the third party CI report: http://dev2.ingenious.com.au/nova-cireport_templated.html
2014-04-03T22:32:00  *** sandywalsh is now known as sw_away
2014-04-03T22:32:18  *** prad has quit IRC
2014-04-03T22:32:23  *** thuc has quit IRC
2014-04-03T22:32:55  *** thuc has joined #openstack-infra
2014-04-03T22:33:35  *** esker has quit IRC
2014-04-03T22:34:09  *** esker has joined #openstack-infra
2014-04-03T22:34:36  <msabramo> https://review.openstack.org/84950
2014-04-03T22:35:14  *** dkehn has quit IRC
2014-04-03T22:35:41  *** melwitt has quit IRC
2014-04-03T22:36:25  *** thomasem has joined #openstack-infra
2014-04-03T22:37:13  *** thuc has quit IRC
2014-04-03T22:37:24  <jhesketh> clarkb: yep, agreed
2014-04-03T22:38:25  *** esker has quit IRC
2014-04-03T22:38:48  <jeblair> fungi, pleia2: so the sub requests are a function of demand and capacity.  and i think we're just seeing it at the edge of the constraints here
2014-04-03T22:38:58  <jeblair> the formula at work is:
2014-04-03T22:39:36  <jeblair> (demand_for_precise / total_tripleo_demand) * available_tripleo_nodes
2014-04-03T22:39:58  <jeblair> currently available_tripleo_nodes is 0, so actually that's why the subrequest shows up as 0; that's not as alarming as i thought it was earlier
2014-04-03T22:40:19  <pleia2> ah, I see
2014-04-03T22:40:33  *** jlk has joined #openstack-infra
2014-04-03T22:40:38  *** jlk has left #openstack-infra
2014-04-03T22:40:39  <msabramo> http://logs.openstack.org/50/84950/2/gate/gate-jenkins-job-builder-pep8/4a9b71e/console.html - Couldn't find index page for 'pbr' (maybe misspelled?) - WTF
2014-04-03T22:40:42  <jeblair> but even if we had one node available, it would be, under current conditions: 160/161*1
2014-04-03T22:40:47  <jhesketh> fungi: Howdy
2014-04-03T22:41:08  *** alex-gone is now known as Alexandra
2014-04-03T22:41:25  <jeblair> pleia2: so basically if you take the output of that, and it ever rounds to a value that is < the available nodes, we'll get an f20 node.
2014-04-03T22:41:43  <fungi> jeblair: got it, so we probably just need to special case values between 0 and 1 node to round up to 1?
2014-04-03T22:41:57  <fungi> from a principle of least surprise standpoint
2014-04-03T22:41:59  <jeblair> fungi: not necessarily; i'm not sure the current behavior is wrong...
2014-04-03T22:42:03  *** denis_makogon has quit IRC
2014-04-03T22:42:06  <fungi> fair enough
2014-04-03T22:42:19  *** zehicle_at_dell has joined #openstack-infra
2014-04-03T22:42:22  <jeblair> i mean, it feels wrong because we haven't had an f20 node all day.  but the cloud has been down all day.  :)
2014-04-03T22:42:43  <fungi> jeblair: well, the main issue is coupling it with jenkins gearman behavior
2014-04-03T22:42:46  *** gokrokve_ has quit IRC
2014-04-03T22:43:18  <fungi> jeblair: since the masters have never seen a tripleo-f20 node they're not registering the label, and this have no appreciable demand beyond the min-ready count
2014-04-03T22:43:22  *** e0ne has quit IRC
2014-04-03T22:43:23  <jeblair> true, it's not actually seeing the demand
2014-04-03T22:43:43  <clarkb> right, I think we may need to special case 1 just to get a slave to register and record demand
2014-04-03T22:44:17  <jeblair> or we could make the job non-voting
2014-04-03T22:44:43  <pleia2> we agreed last night that we could make the f20 ones non-voting for now
2014-04-03T22:44:45  <jeblair> we could also add an option to zuul to assume all jobs exist
2014-04-03T22:44:54  *** yamahata has quit IRC
2014-04-03T22:44:55  <pleia2> since it's new and scary anyway
2014-04-03T22:45:06  <pleia2> I can do that patch now if we want
2014-04-03T22:45:09  *** zehicle has quit IRC
2014-04-03T22:45:12  <fungi> how about let zuul treat nonexistent jobs automatically as non-voting?
2014-04-03T22:45:13  <jeblair> i added the registration check as protection against typos, but we have a gate job that blocks those so we don't actually need the check
2014-04-03T22:45:26  <fungi> good point
2014-04-03T22:45:47  *** jaypipes has joined #openstack-infra
2014-04-03T22:46:08  <jeblair> pleia2: sounds good.  increasing the min_ready a bit is probably a good idea as well
2014-04-03T22:46:16  <jeblair> (it'll mean we come out of the corner case faster)
2014-04-03T22:46:35  <pleia2> jeblair: is this enough, or should we do more? https://review.openstack.org/#/c/85160/
2014-04-03T22:47:27  <fungi> pleia2: not yet, until the demand for tripleo-precise nodes falls to half what it is now
2014-04-03T22:47:41  <fungi> i suspect you need it up around 4 or 5 to beat the odds
2014-04-03T22:47:56  <fungi> unless it's rounding to the nearest integer instead of rounding down
2014-04-03T22:48:04  <fungi> in which case that might be close
2014-04-03T22:48:10  <jeblair> pleia2: i think that's a good value
2014-04-03T22:48:14  <jeblair> fungi: it rounds to nearest
2014-04-03T22:48:27  <fungi> oh, then yeah, soonish min-ready 2 should bring it around
2014-04-03T22:48:32  *** mattymo has quit IRC
2014-04-03T22:49:02  <jeblair> pleia2: a demand ratio of 5:1 means that you will get at least one f20 node as long as there are 3 nodes available
2014-04-03T22:49:10  *** mattymo has joined #openstack-infra
2014-04-03T22:49:12  <fungi> also https://review.openstack.org/83057 might fix this faster
2014-04-03T22:49:31  <jeblair> fungi: indeed, is it up?
2014-04-03T22:49:38  <fungi> my tests say yes
2014-04-03T22:50:03  <jeblair> fungi: that lgtm, should i aprv?
2014-04-03T22:50:11  <fungi> though i haven't tried to nova boot in it yet, or checked the quotas. lemme do that first
2014-04-03T22:50:19  <fungi> just a sec
2014-04-03T22:50:42  <fungi> i mainly just looked to see that it was responding and the images and flavors were suitable
2014-04-03T22:50:52  <fungi> i should probably boot an instance and ssh into it
2014-04-03T22:52:10  <jeblair> clarkb: you didn't respond to my comment on https://review.openstack.org/#/c/76057/4..7/tests/test_scheduler.py ?
2014-04-03T22:52:52  *** marun_afk is now known as marun
2014-04-03T22:53:18  <clarkb> jeblair: no, beacuse I stopped doing location overrides for all tests
2014-04-03T22:53:20  <openstackgerrit> A change was merged to openstack-infra/config: Increase min-ready for tripleo-f20 nodes  https://review.openstack.org/85160
2014-04-03T22:53:22  <clarkb> jeblair: which made that code valid
2014-04-03T22:53:44  <jeblair> clarkb: i think getting rid of a faked component is a wonderful thing.  why wouldn't we want to do it?
2014-04-03T22:54:28  *** atiwari has quit IRC
2014-04-03T22:54:39  <clarkb> jeblair: so, the latest patchset runs tests as we always have for zuul, then it runs them again with some different options set. I think that makes it necessary to have that faked component
2014-04-03T22:54:45  <openstackgerrit> Elizabeth Krumbach Joseph proposed a change to openstack-infra/config: Make check-tripleo-overcloud-f20 non-voting  https://review.openstack.org/85194
2014-04-03T22:54:54  *** dstanek has joined #openstack-infra
2014-04-03T22:54:59  <clarkb> jeblair: the reason for that is to test the poll and remote fetch path as well as the other paths
2014-04-03T22:55:25  <jeblair> clarkb: i don't believe that the fetch/non-fetch paths are any different as far as the tests go
2014-04-03T22:55:35  <jeblair> clarkb: the only thing that changes is this https://review.openstack.org/#/c/76057/7/zuul/trigger/gerrit.py
2014-04-03T22:55:47  <jeblair> clarkb: and that entire function is the thing that's faked out
2014-04-03T22:55:54  <jeblair> so there is no difference for fetch
2014-04-03T22:56:14  <clarkb> jeblair: there is when fetch_url isn't used
2014-04-03T22:56:22  <clarkb> jeblair: I can set fetch_url in all tests if you want
2014-04-03T22:56:35  * ttx lurks in the night
2014-04-03T22:56:43  <jeblair> clarkb: no wait let's not jump to doing anything...
2014-04-03T22:56:45  <jeblair> 22:59 < clarkb> jeblair: there is when fetch_url isn't used
2014-04-03T22:57:07  <jeblair> clarkb: can you show me where there's more than one code path through zuul on whether fetch_url is or isn't used?
2014-04-03T22:57:33  *** jlk has joined #openstack-infra
2014-04-03T22:57:47  <pleia2> ttx: I'd appreciate your feedback on the horrible things I'm doing to your bugdaystats ;) https://review.openstack.org/#/q/status:open+project:openstack-infra/bugdaystats,n,z
2014-04-03T22:57:49  <clarkb> jeblair: in you pointed the big one out. The other is in the tests themselves. EG if we don't fake the path you pointed out we won't get the right path without the fake
2014-04-03T22:57:54  *** zehicle_at_dell has quit IRC
2014-04-03T22:57:59  <clarkb> s/in//
2014-04-03T22:58:07  <pleia2> ttx: (it's actually not much, just style cleanup once we get it fully moved to infra, another pending review)
2014-04-03T22:58:22  <ttx> pleia2: could you fire me an email about it ? Otherwise I won't remember tomorrow
2014-04-03T22:58:30  <pleia2> ttx: will do!
2014-04-03T22:58:35  <jeblair> clarkb: right, but we're not testing the tests.  we're only testing zuul.  so the only code paths we need to make sure we're covering are in zuul
2014-04-03T22:58:38  <clarkb> jeblair: we can get the correct path in teh tests without the fake if we set fetch_url for all tests
2014-04-03T22:58:52  <fungi> ttx: did you see adam_g's -announce ml moderation request (his new address apparently isn't whitelisted)
2014-04-03T22:58:54  <jeblair> clarkb: and the only code path in zuul affected by that is opaque to the tests because that whole method is faked
2014-04-03T22:59:02  *** signed8bit has quit IRC
2014-04-03T22:59:05  <ttx> fungi: looking
2014-04-03T22:59:20  <clarkb> jeblair: let us rewind
2014-04-03T22:59:25  *** dstanek has quit IRC
2014-04-03T22:59:42  <jeblair> clarkb: ok
2014-04-03T22:59:50  <ttx> fungi: accepted
2014-04-03T23:00:06  <fungi> ttx: adam_g will be pleased
2014-04-03T23:00:07  *** saschpe has quit IRC
2014-04-03T23:00:28  <clarkb> jeblair: patchset 4 assumed one config for testing. latest patchset assumes more than one and only adds new tests, it does not change existing tests. You are making an argument for removing that but I think doing so is orthogonal to this change
2014-04-03T23:00:42  <clarkb> *removing that fake
2014-04-03T23:01:16  <clarkb> if we decide to remove it (because it does seem like a reasonable idea) we will need to add fetch_url to all of the configs used in testing
2014-04-03T23:01:18  *** david-lyle has quit IRC
2014-04-03T23:01:51  *** dcramer_ has quit IRC
2014-04-03T23:02:13  *** khyati has quit IRC
2014-04-03T23:02:14  *** CaptTofu has joined #openstack-infra
2014-04-03T23:02:28  *** dizquierdo has quit IRC
2014-04-03T23:03:18  <clarkb> jeblair: if you would like a follow up change that removes the fake I can do that, or if you prefer I can squash it together
2014-04-03T23:04:06  <jeblair> clarkb: yes.  in patchset 4 my suggestion was an optimization because you were setting it everywhere; in patchset 7 the question changes slightly because it's part of the second pass of tests; i think removing it eliminates the need for half of that.  i haven't thought about poll yet.
2014-04-03T23:04:22  *** yamahata has joined #openstack-infra
2014-04-03T23:04:43  <jeblair> clarkb: so let's move to that, if you don't mind; why do you think poll needs all of the tests run again?
2014-04-03T23:05:06  <clarkb> jeblair: because I couldn't come up with a good way of running a specific test under different configuration
2014-04-03T23:05:13  <clarkb> jeblair: since so much of the config stuff is prebaked
2014-04-03T23:05:42  <adam_g> ttx, thanks!
2014-04-03T23:05:50  *** matsuhashi has joined #openstack-infra
2014-04-03T23:06:11  <jeblair> clarkb: oh, because you need to launch a merger with the poll option set, and that happens in setUp?
2014-04-03T23:06:17  <clarkb> jeblair: yup
2014-04-03T23:06:43  <clarkb> jeblair: all solutions I came up with required a new class and the existing one does 99% of the setup that si required already
2014-04-03T23:06:47  <clarkb> so I am piggy backing off of that
2014-04-03T23:07:26  *** khyati has joined #openstack-infra
2014-04-03T23:07:55  <clarkb> jeblair: this comes back to the end of my discussion with jhesketh. The best way to do this would be to completely refactor the "base" test class. It can do all of the fake setups and config things. Then other classes can mix that in and define particular tests
2014-04-03T23:08:05  <jeblair> clarkb: ok, so i like the idea of refactoring that setup method into something more reusable, so you could have a class for one of several different scenarios
2014-04-03T23:08:12  <jeblair> clarkb: ++ that ^
2014-04-03T23:08:32  <jeblair> clarkb: i wonder though if in the mean time, we could avoid running all the tests twice
2014-04-03T23:08:55  *** zehicle_at_dell has joined #openstack-infra
2014-04-03T23:09:04  <jeblair> clarkb: one possibility might be to stop and start the merger in the poll test
2014-04-03T23:09:25  *** dkehn has joined #openstack-infra
2014-04-03T23:10:07  <clarkb> jeblair: the other issue is CONFIG is global in TestScheduler so all tests run after a config update will get that modified config (this can be worked around more simply I think)
2014-04-03T23:11:24  <clarkb> jeblair: why don't I give the end state a shot since I think it will be simple to do
2014-04-03T23:11:30  <clarkb> jeblair: then we don't have to worry about the intermediate state
2014-04-03T23:11:41  <clarkb> jeblair: simple to do, but harder to review
2014-04-03T23:11:47  <jeblair> clarkb: ok; i like that idea too, but was hesitant to suggest it
2014-04-03T23:11:49  <clarkb> because I expect the diff to be ugly
2014-04-03T23:12:08  <jeblair> clarkb: will you do the refactor as one patch, then rebase 76057 on it?
2014-04-03T23:12:17  *** thedodd has quit IRC
2014-04-03T23:12:33  <clarkb> rebase 76057 on it
2014-04-03T23:12:33  <Steap> Hey! python-heatclient just got Python 3 compatibility; could someone merge https://review.openstack.org/#/c/85170/ so that the py3 becomes  voting before Python3-incompatible patches are merged?
2014-04-03T23:12:35  *** UtahDave has quit IRC
2014-04-03T23:12:44  *** whoops has quit IRC
2014-04-03T23:13:54  <jeblair> clarkb: okay, thanks; i'll finish reviewing 76057 now
2014-04-03T23:14:07  <jhesketh> jeblair: added a couple of inline comments to 84873,2
2014-04-03T23:14:42  <clarkb> Steap: done
2014-04-03T23:14:52  <jeblair> jhesketh: thx
2014-04-03T23:15:59  *** nkinder has joined #openstack-infra
2014-04-03T23:15:59  *** e0ne_ has joined #openstack-infra
2014-04-03T23:18:21  <openstackgerrit> A change was merged to openstack-infra/config: heatclient: make the py33 gate voting  https://review.openstack.org/85170
2014-04-03T23:18:34  <jeblair> clarkb: lgtm otherwise, i only had comments we discussed here.
2014-04-03T23:18:49  *** jgrimm has quit IRC
2014-04-03T23:19:15  <fungi> jeblair: i've successfully booted an instance, created and added a floating ip, confirmed i could reach the ssh port on it and got a host key back, and deleted the instance and floating ip all without a hitch... i wish the tripleo hp region were up though so i could compare quotas, but regardless they're way too low. i'll -1 and leave comments
2014-04-03T23:19:35  <jeblair> fungi: :( thanks
2014-04-03T23:19:39  *** saschpe has joined #openstack-infra
2014-04-03T23:19:40  <fungi> otherwise, aside from capacity, it looks good! :/
2014-04-03T23:20:18  *** e0ne_ has quit IRC
2014-04-03T23:20:45  <clarkb> jeblair: thanks
2014-04-03T23:21:42  *** dstanek has joined #openstack-infra
2014-04-03T23:23:39  <Steap> clarkb: thx
2014-04-03T23:27:47  <fungi> got my hopes up... *sigh*
2014-04-03T23:28:45  <fungi> the summary is that the instances, floating ips, vcpus and ram all are way below the 20 max-servers in that change
2014-04-03T23:29:21  <fungi> the worst is vcpus... we have enough to be able to boot two of the flavor specified in the nodepool.yaml, and those will be needed just to build their two images each day
2014-04-03T23:29:34  *** markwash has quit IRC
2014-04-03T23:29:44  <pleia2> fungi: oops, thanks for looking into that
2014-04-03T23:30:24  *** german_ has quit IRC
2014-04-03T23:30:26  <fungi> pleia2: no problem--it's something we should always check when making capacity changes like that, or bringing new providers on line. sorry i didn't think to do so sooner
2014-04-03T23:30:29  *** HenryG_ has joined #openstack-infra
2014-04-03T23:30:34  *** german_ has joined #openstack-infra
2014-04-03T23:30:46  * pleia2 nods
2014-04-03T23:30:59  <pleia2> all I did was check basic stuff with my user account to make sure it was responsive
2014-04-03T23:31:11  *** markmcclain has quit IRC
2014-04-03T23:31:17  <fungi> pleia2: future tip... nova absolute-limits
2014-04-03T23:31:34  <pleia2> thanks
2014-04-03T23:31:45  <fungi> (plus a little math matching up to the nova flavor-list entry you're planning to use)
2014-04-03T23:32:01  *** zehicle_at_dell has quit IRC
2014-04-03T23:32:14  *** HenryG has quit IRC
2014-04-03T23:32:16  *** zehicle_at_dell has joined #openstack-infra
2014-04-03T23:32:43  <fungi> divide cores into max cores, ram into max ram, make sure you have high enough max floating-ips for the max instances, et cetera
2014-04-03T23:32:49  * pleia2 nods
2014-04-03T23:33:50  <fungi> whichever is lowest, that's your effective max node count (barring hidden limits like the number of precreated tripleo work environments)
2014-04-03T23:34:09  *** Sukhdev has joined #openstack-infra
2014-04-03T23:35:02  <openstackgerrit> James E. Blair proposed a change to openstack-infra/gear: Add access control  https://review.openstack.org/84873
2014-04-03T23:35:29  <jeblair> jhesketh: okay, that addresses exceptions
2014-04-03T23:36:00  <jeblair> jhesketh: i have not addressed or replied to 'subject regex' and 'disconnect certificates with a cn of self'
2014-04-03T23:36:23  <jeblair> jhesketh: i think irc may be better for that
2014-04-03T23:36:47  <clarkb> jeblair: running into trouble with test_statsd() is that meant to use the fake statsd eg self.statsd or should it actually do the extras import there?
2014-04-03T23:36:54  <jeblair> jhesketh: i think the subject thing is really a use-case vs efficiency thing
2014-04-03T23:37:15  <jhesketh> jeblair: sure, I'm not set on either of those features
2014-04-03T23:37:17  <asselin> Hi, I found the source of the dns issues I'm running into: in the puppet "unbound" class. What's the simplest way to avoid the changes made there?
2014-04-03T23:37:41  <clarkb> jeblair: nevermind, pep8 was being obtuse
2014-04-03T23:37:49  *** thuc has joined #openstack-infra
2014-04-03T23:38:10  *** HenryG has joined #openstack-infra
2014-04-03T23:38:14  <jhesketh> jeblair: I hadn't considered efficiency, that might be a good point... although if we keep the regex compiled in the ACL entry the overhead might not be too bad
2014-04-03T23:38:20  <jeblair> clarkb: i _think_ that's meant to actually test statsd itself, since we usally fake it
2014-04-03T23:38:20  *** thuc has quit IRC
2014-04-03T23:38:26  *** zns has quit IRC
2014-04-03T23:38:58  *** yamahata has quit IRC
2014-04-03T23:39:01  <jhesketh> asselin: Why avoid the changes and not fix them?
2014-04-03T23:39:02  <jeblair> clarkb: except we don't fake it do we?
2014-04-03T23:39:09  <jeblair> clarkb: honestly, that's starting to seem a little weird
2014-04-03T23:39:13  *** thuc has joined #openstack-infra
2014-04-03T23:39:32  *** thuc has quit IRC
2014-04-03T23:39:43  <jeblair> clarkb: (we have a fake server, but we use the real api; zuul itself uses those calls... maybe there was a point where we weren't exercising all of them?  maybe we still aren't?)
2014-04-03T23:39:46  <clarkb> jeblair: ya, some stuff uses fakes other stuff uses the fake server
2014-04-03T23:39:57  <clarkb> jeblair: I think they are both used in different ways :)
2014-04-03T23:40:15  <clarkb> asselin: does 8.8.8.8 not resolve dns for you?
2014-04-03T23:40:18  <asselin> jhesketh, good question. I don't know how to 'fix'. The comments int he file suggest rackspace needs those.
2014-04-03T23:40:18  *** thuc has joined #openstack-infra
2014-04-03T23:40:46  <clarkb> asselin: the idea with unbound is that we get better DNS reliability if we add a DNS cache to each slave
2014-04-03T23:40:53  <asselin> # Rackspace uses static config files     file { '/etc/resolv.conf':       content => "nameserver 127.0.0.1\n",
2014-04-03T23:41:13  *** HenryG_ has quit IRC
2014-04-03T23:41:28  <jeblair> jhesketh: yeah, my thought was to try to keep acl lookups as fast as possible; i know we'll need regex for names, but i'm not expecting to apply matching to subject names, so i tried to keep it simple
2014-04-03T23:41:46  <jeblair> jhesketh: i agree it could be useful; maybe we can defer until we have a solid use case?
2014-04-03T23:42:14  <asselin> clarkb, jhesketh the rackspace settings applied break dns on my slave node
2014-04-03T23:42:24  <jeblair> asselin: the module attempts to configure the host to use the nameserver it's installing regardless of the varying configurations we have found on provider images
2014-04-03T23:42:36  <jeblair> asselin: what's broken about it?
2014-04-03T23:42:42  *** HenryG has quit IRC
2014-04-03T23:42:50  *** zehicle_at_dell has quit IRC
2014-04-03T23:43:05  *** zehicle_at_dell has joined #openstack-infra
2014-04-03T23:43:12  <asselin> jeblair, as soon as those settings are applied to /etc/resolv.conf, dns stops working
2014-04-03T23:43:40  <jeblair> asselin: what os are you using?
2014-04-03T23:43:45  <asselin> jeblair, ubuntu
2014-04-03T23:43:50  <jeblair> asselin: precise?
2014-04-03T23:44:05  <asselin> jeblair, yes 12.04 dns works perfectly up until this part of the script
2014-04-03T23:44:13  <jhesketh> jeblair: sure, happy for it to come in later if we find we want it :-)
2014-04-03T23:45:26  <jeblair> asselin: after it fails, is the 'unbound' process running?
2014-04-03T23:45:50  *** unicell has joined #openstack-infra
2014-04-03T23:45:55  *** dcramer_ has joined #openstack-infra
2014-04-03T23:45:58  *** esker has joined #openstack-infra
2014-04-03T23:46:31  <jeblair> asselin: and if so, what is the output of "dig +dnssec -t soa com. @127.0.0.1"
2014-04-03T23:46:48  *** homeless has quit IRC
2014-04-03T23:46:57  <asselin> jeblair, I will try now and get back to you.
2014-04-03T23:47:04  <jeblair> jhesketh: so the other thing; connections from a cert named 'self'...
2014-04-03T23:47:44  <jhesketh> jeblair: yes, so my thought there is more from a usability point of view than security
2014-04-03T23:48:10  <jeblair> jhesketh: i agree it seems like we could do something there.  should we reject those on connect, or just error out if you try to run acl commands in such a context?
2014-04-03T23:48:16  *** mriedem has quit IRC
2014-04-03T23:48:27  <jhesketh> jeblair: reject on connect
2014-04-03T23:48:40  <jeblair> jhesketh: if we do that, we can't provide feedback to the user, but we can log it for the admin
2014-04-03T23:48:45  <jhesketh> because the problem comes when somebody else tries to grant permissions for the person with the cert named "self"
2014-04-03T23:48:49  <jeblair> presumably the admin is signing the certs anyway, so that's probably ok
2014-04-03T23:48:55  <jhesketh> they think they're granting for "self" but they are actually only modifying their own
2014-04-03T23:49:17  *** CaptTofu has quit IRC
2014-04-03T23:49:19  <jhesketh> jeblair: well we could allow the connection, send back a message, then disconnect
2014-04-03T23:49:24  <jhesketh> but that's probably not within the protocol spec
2014-04-03T23:49:29  <jhesketh> (actually is ACL in the spec?)
2014-04-03T23:49:31  <jeblair> jhesketh: not so much
2014-04-03T23:49:53  <jeblair> jhesketh: nope.  i'm making it up as i go along.  but i did talk to brian aker about it and he's on board with the general idea.
2014-04-03T23:50:01  <jhesketh> okay
2014-04-03T23:50:08  <jeblair> jhesketh: the admin protocol is much looser than the binary protocol anyway
2014-04-03T23:50:14  <jhesketh> I'm fine with just disconnecting them and documenting it so that when somebody is confused hopefully they consult the manual
2014-04-03T23:51:21  *** wenlock has quit IRC
2014-04-03T23:51:45  *** mrodden has quit IRC
2014-04-03T23:51:49  <jhesketh> jeblair: either that or we change the command
2014-04-03T23:51:55  <jhesketh> eg: "grant-self"
2014-04-03T23:56:50  <fungi> jeblair: so are acls part of the gearman protocol, or a gear-only extension?
2014-04-03T23:57:38  <openstackgerrit> Michael Krotscheck proposed a change to openstack-infra/storyboard-webclient: Tasks are now editable  https://review.openstack.org/84888
2014-04-03T23:59:08  *** mdenny has quit IRC
